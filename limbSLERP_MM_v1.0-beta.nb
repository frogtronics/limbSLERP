(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    549085,      13192]
NotebookOptionsPosition[    544581,      13046]
NotebookOutlinePosition[    544939,      13062]
CellTagsIndexPosition[    544896,      13059]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "To", " ", "Do", "\[IndentingNewLine]", "1.", " ", "Upload", " ", 
   "quatRotation", " ", "package", " ", "source", " ", "code", 
   "\[IndentingNewLine]", "2.", " ", "Include", " ", "sample", " ", "trial", 
   " ", "data", "\[IndentingNewLine]", "3.", " ", "Add", " ", "more", " ", 
   "comments", "\[IndentingNewLine]", "4.", " ", "Split", " ", "this", " ", 
   "code", " ", "into", " ", "standalone", " ", "limbSLERP", " ", "versus", 
   " ", "code", " ", "to", " ", "replicate", " ", "simulations", " ", "in", 
   " ", "the", " ", "JTB", " ", "paper"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7385544992698383`*^9, 3.7385545521220827`*^9}, {
  3.738554604732428*^9, 3.738554677908082*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<quatRotation`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Biomechanics`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AJ", "[", 
    RowBox[{"POINTS_", ",", "AXES_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Z", ",", "P", ",", "n", ",", "JiT", ",", "JiR", ",", "AJ"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "=", "AXES"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Z", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", "POINTS"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AJ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"JiT", "=", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "-", 
             RowBox[{"P", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{"translational", " ", "components"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"JiR", "=", 
          RowBox[{"Z", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"rotational", " ", "component"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AJ", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "6"}], ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{"JiT", ",", "JiR"}], "]"}]}], ";"}], "\[IndentingNewLine]",
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "AJ"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"limbQUAT", "[", 
    RowBox[{"points_", ",", "vreference_", ",", 
     RowBox[{"qRotation_:", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"npoints", ",", "vsegment", ",", "vref", ",", "qOut"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"npoints", "=", 
       RowBox[{"Length", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vref", "=", "vreference"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vsegment", "=", 
          RowBox[{"qRot", "[", 
           RowBox[{"qRotation", ",", 
            RowBox[{
             RowBox[{"points", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
             RowBox[{"points", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"qOut", "=", 
          RowBox[{"qqVec", "[", 
           RowBox[{"vref", ",", "vsegment"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vref", "=", "vsegment"}], ";", "\[IndentingNewLine]", 
         "qOut"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"npoints", "-", "1"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quatFK", "[", 
    RowBox[{"quats_", ",", "lengths_", ",", 
     RowBox[{"vreference_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
     RowBox[{"origin_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vref", ",", "vec", ",", "joint", ",", "points"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vref", "=", 
       RowBox[{"Normalize", "[", "vreference", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"joint", "=", "origin"}], ";", "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"vec", "=", 
           RowBox[{"Normalize", "[", 
            RowBox[{"qRot", "[", 
             RowBox[{
              RowBox[{"quats", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "vref"}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"vref", "=", "vec"}], ";", "\[IndentingNewLine]", 
          RowBox[{"joint", "=", 
           RowBox[{"joint", "+", 
            RowBox[{"vec", "*", 
             RowBox[{"lengths", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "quats", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "origin", "}"}], ",", "points"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qAtoqB", "[", 
    RowBox[{"quatA_", ",", "quatB_"}], "]"}], ":=", 
   RowBox[{"qMult", "[", 
    RowBox[{
     RowBox[{"qCon", "[", 
      RowBox[{"Normalize", "[", "quatA", "]"}], "]"}], ",", 
     RowBox[{"Normalize", "[", "quatB", "]"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "finds", " ", "quatC", " ", "which", " ", "rotates", " ", "quatA", " ", 
    "onto", " ", "quatB"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aaToq", "[", 
    RowBox[{"axis_", ",", "angle_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"angle", "/", "2"}], "]"}], ",", 
      RowBox[{"axis", "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"angle", "/", "2"}], "]"}]}]}], "}"}], "//", "Flatten"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qSlerp", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "omega", "}"}], ",", 
     RowBox[{
      RowBox[{"omega", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"Normalize", "@", "q1"}], ",", 
          RowBox[{"Normalize", "@", "q2"}]}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PossibleZeroQ", "[", "omega", "]"}], ",", "q1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "f"}], ")"}], " ", "omega"}], "]"}], " ", 
            "q1"}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"f", " ", "omega"}], "]"}], " ", "q2"}]}], ")"}], "/", 
         RowBox[{"Sin", "[", "omega", "]"}]}]}], "]"}]}]}], "\n", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"limbSlerp", "[", 
    RowBox[{"limbQuats1_", ",", "limbQuats2_", ",", "f_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"qSlerp", "[", 
      RowBox[{
       RowBox[{"limbQuats1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"limbQuats2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "f"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "limbQuats1", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"limbSlerp2", "[", 
    RowBox[{"limbQuats1_", ",", "limbQuats2_", ",", "flist_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"qSlerp", "[", 
      RowBox[{
       RowBox[{"limbQuats1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"limbQuats2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"flist", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "limbQuats1", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drawFrame", "[", 
    RowBox[{"refFrame3x3_", ",", 
     RowBox[{"origin_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Frame", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Frame", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"refFrame3x3", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", "origin"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Riffle", "[", 
       RowBox[{"Frame", ",", 
        RowBox[{"{", "origin", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qRotframe", "[", 
   RowBox[{"quat_", ",", 
    RowBox[{"frame_:", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "F", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"qRot", "[", 
       RowBox[{"quat", ",", 
        RowBox[{"frame", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineFrame", "[", 
    RowBox[{"frame_", ",", 
     RowBox[{"origin_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"color_:", "Black"}], ",", 
     RowBox[{"thickness_:", "0.01"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"color", ",", "Dashed", ",", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"drawFrame", "[", 
           RowBox[{"frame", ",", "origin"}], "]"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
     "color", ",", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"drawFrame", "[", 
         RowBox[{"frame", ",", "origin"}], "]"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", "4"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"color", ",", 
       RowBox[{"Thickness", "\[Rule]", "thickness"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"drawFrame", "[", 
           RowBox[{"frame", ",", "origin"}], "]"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qAtoqB", "[", 
    RowBox[{"quatA_", ",", "quatB_"}], "]"}], ":=", 
   RowBox[{"qMult", "[", 
    RowBox[{
     RowBox[{"qCon", "[", 
      RowBox[{"Normalize", "[", "quatA", "]"}], "]"}], ",", 
     RowBox[{"Normalize", "[", "quatB", "]"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "finds", " ", "quatC", " ", "which", " ", "rotates", " ", "quatA", " ", 
    "onto", " ", "quatB"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writePoly", "[", 
    RowBox[{"variableSymbol_", ",", "coefficientSymbols_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nterms", ",", "termList"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"nterms", "=", 
       RowBox[{"Length", "[", "coefficientSymbols", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"termList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coefficientSymbols", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          SuperscriptBox["variableSymbol", "i"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "nterms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"termList", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"coefficientSymbols", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "termList"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "termList", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polyFit", "[", 
    RowBox[{"dataXY_", ",", "order_", ",", 
     RowBox[{"var_:", "t"}], ",", 
     RowBox[{"parameter_:", "\"\<a\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coefs", ",", "rhs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coefs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"parameter", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "order"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhs", "=", 
       RowBox[{"writePoly", "[", 
        RowBox[{"var", ",", "coefs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhs", "/.", 
       RowBox[{"FindFit", "[", 
        RowBox[{"dataXY", ",", "rhs", ",", "coefs", ",", "var"}], "]"}]}]}]}],
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reflectionM", "[", 
    RowBox[{"normalV_", ",", 
     RowBox[{"origin_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Calculates", " ", "reflection", " ", "matrix", " ", "about", " ", 
      "arbitrary", " ", "plane", " ", "of", " ", 
      RowBox[{"symmetry", ".", "  ", "normalV"}], " ", "is", " ", "the", " ", 
      "normal", " ", "to", " ", "the", " ", 
      RowBox[{"plane", ".", "  ", "From"}], " ", "Rotation", " ", "about", 
      " ", "an", " ", "arbitrary", " ", "axis", " ", "and", " ", "reflection",
       " ", "through", " ", "an", " ", "arbitrary", " ", "plane"}], ",", " ", 
     
     RowBox[{"Emod", " ", "Kovacs"}], ",", " ", 
     RowBox[{
     "Annales", " ", "Mathematicae", " ", "et", " ", "Informaticae", " ", 
      "40"}], ",", " ", "2012", ",", " ", 
     RowBox[{
      RowBox[{"pp", " ", "175"}], "-", "186"}]}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tfwd", ",", "Tbwd", ",", "Rflect", ",", "cx", ",", "cy", ",", "cz"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tfwd", "=", 
       RowBox[{"Tbwd", "=", 
        RowBox[{"Rflect", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cx", ",", "cy", ",", "cz"}], "}"}], "=", 
       RowBox[{"Normalize", "[", "normalV", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rflect", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           SuperscriptBox["cx", "2"]}]}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cx"}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cz", "*", "cx"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rflect", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cx"}], ",", " ", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           SuperscriptBox["cy", "2"]}]}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cz"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rflect", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", " ", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "cz", "*", "cx"}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cz"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           SuperscriptBox["cz", "2"]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tfwd", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "=", "origin"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tbwd", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "=", 
       RowBox[{"-", "origin"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tfwd", ".", "Rflect", ".", "Tbwd"}]}]}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reflectionMsymbolic", "[", 
    RowBox[{"normalVUnitVector_", ",", 
     RowBox[{"origin_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Calculates", " ", "reflection", " ", "matrix", " ", "about", " ", 
      "arbitrary", " ", "plane", " ", "of", " ", 
      RowBox[{"symmetry", ".", "  ", "normalV"}], " ", "is", " ", "the", " ", 
      "normal", " ", "to", " ", "the", " ", 
      RowBox[{"plane", ".", "  ", "From"}], " ", "Rotation", " ", "about", 
      " ", "an", " ", "arbitrary", " ", "axis", " ", "and", " ", "reflection",
       " ", "through", " ", "an", " ", "arbitrary", " ", "plane"}], ",", " ", 
     
     RowBox[{"Emod", " ", "Kovacs"}], ",", " ", 
     RowBox[{
     "Annales", " ", "Mathematicae", " ", "et", " ", "Informaticae", " ", 
      "40"}], ",", " ", "2012", ",", " ", 
     RowBox[{
      RowBox[{"pp", " ", "175"}], "-", "186"}]}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tfwd", ",", "Tbwd", ",", "Rflect", ",", "cx", ",", "cy", ",", "cz"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tfwd", "=", 
       RowBox[{"Tbwd", "=", 
        RowBox[{"Rflect", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cx", ",", "cy", ",", "cz"}], "}"}], "=", 
       "normalVUnitVector"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rflect", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           SuperscriptBox["cx", "2"]}]}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cx"}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cz", "*", "cx"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rflect", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cx"}], ",", " ", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           SuperscriptBox["cy", "2"]}]}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cz"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rflect", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", " ", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "cz", "*", "cx"}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "cy", "*", "cz"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           SuperscriptBox["cz", "2"]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tfwd", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "=", "origin"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tbwd", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "=", 
       RowBox[{"-", "origin"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tfwd", ".", "Rflect", ".", "Tbwd"}]}]}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"for", " ", "publication"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reflectionMsymbolic", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["n", "1"], ",", 
        SubscriptBox["n", "2"], ",", 
        SubscriptBox["n", "3"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["o", "1"], ",", 
        SubscriptBox["o", "2"], ",", 
        SubscriptBox["o", "3"]}], "}"}]}], "]"}], "//", "MatrixForm"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"limbMirror", "[", 
    RowBox[{"limb_", ",", "axis_", ",", 
     RowBox[{"vref_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"origin_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "normal", ",", "Rmirror", ",", "base", ",", "limbM", ",", "pnt4"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"normal", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"axis", ",", "vref"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmirror", "=", 
       RowBox[{"reflectionM", "[", 
        RowBox[{"normal", ",", "origin"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbM", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pnt4", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"limb", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rmirror", ".", "pnt4"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limb", "]"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "UnwrapPhase"}], " ", "follows"}], 
   "*************)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"this", " ", "code", " ", "fixes", " ", "0"}], "-", 
    RowBox[{
    "2", "Pi", " ", "discontinuities", " ", "in", " ", "angle", " ", "data", 
     " ", 
     RowBox[{"(", 
      RowBox[{"in", " ", 
       RowBox[{"radians", "!"}]}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"code", " ", "from", " ", "forum", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"forums", ".", "wolfram", ".", "com"}], "/", "mathgroup"}], 
        "/", "archive"}], "/", "2007"}], "/", "Mar"}], "/", 
     RowBox[{"msg00806", ".", "html"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unwrapPhase", "[", 
    RowBox[{
     RowBox[{"data_", "?", "VectorQ"}], ",", 
     RowBox[{"tol_:", "Pi"}], ",", 
     RowBox[{"inc_:", "2", " ", "Pi"}]}], "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "+", 
       RowBox[{"inc", "*", 
        RowBox[{"FoldList", "[", 
         RowBox[{"Plus", ",", "0.", ",", 
          RowBox[{"Sign", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{"ListCorrelate", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", "#"}], "]"}], ",", "tol"}],
             "]"}], "   ", 
           RowBox[{"(*", 
            RowBox[{"close", " ", "Chop"}], "*)"}], "]"}]}], "    ", 
         RowBox[{"(*", 
          RowBox[{"close", " ", "Sign"}], "*)"}], "]"}]}]}], "&"}], ",", 
     RowBox[{"(*", 
      RowBox[{"close", " ", "FoldList"}], "*)"}], "data"}], "]"}]}], "   ", 
  RowBox[{"(*", 
   RowBox[{
   "close", " ", "FixedPoint", " ", "and", " ", "overall", " ", "function"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unwrapPhase", "[", 
    RowBox[{"list", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"list", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"unwrapPhase", "[", 
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "UnwrapPhase"}], " ", "above"}], 
   "*************)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "some", " ", "reason", " ", "this", " ", "is", " ", "much", 
    " ", "faster", " ", "than", " ", "CoordinateTransform"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toSpherical", "[", "xyzpoint_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"Norm", "[", "xyzpoint", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"xyzpoint", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "/", "r"}], "]"}], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"xyzpoint", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"xyzpoint", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listSplit", "[", 
     RowBox[{"x_List", ",", "lengths_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "##", "}"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Most", "[", "#", "]"}], ",", 
          RowBox[{
           RowBox[{"Rest", "[", "#", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
      "&"}], "@", 
     RowBox[{"Accumulate", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"lengths", ",", "1"}], "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ref", "  ", 
     RowBox[{"https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"groups", ".", "google", ".", "com"}], "/", "forum"}], "/", 
       RowBox[{"#", "!"}]}], 
      RowBox[{"topic", "/", 
       RowBox[{"comp", ".", "soft"}]}]}], "-", 
     RowBox[{
      RowBox[{"sys", ".", "math", ".", "mathematica"}], "/", 
      "IRd7HVCx4ic"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", "SET"}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DIRECTORIES", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DETERMINE", " ", "THE", " ", 
    RowBox[{"AUTHOR", "'"}], "s", " ", "operating", " ", "system", " ", "and",
     " ", "parce", " ", "accordingly"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"os", "=", "$OperatingSystem"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "frogworkpath", "=", 
     "\"\<C:\\\\Users\\\\HSVideo\\\\Documents\\\\FrogWork\\\\\>\""}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"for", " ", "Laura"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "frogworkpath", "=", 
     "\"\<\\\\Volumes\\\\FrogDrive01\\\\FrogWork\\\\\>\""}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"for", " ", 
     RowBox[{"Chris", "'"}], " ", "mac"}], "*)"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"frogworkpath", "=", "\"\<\\\\Volumes\\\\FrogWork\\\\\>\""}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", 
      RowBox[{"Chris", "'"}], " ", "mac"}], ",", " ", "NETWORK"}], "*)"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "frogworkpath", "=", 
    "\"\<\\\\Users\\\\chrisrichards\\\\Desktop\\\\FrogWork\\\\\>\""}], ";"}], 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", 
     RowBox[{"Chris", "'"}], " ", "mac"}], ",", " ", "LOCAL"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"frogworkpath", "=", "\"\<Z:\\\\\>\""}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "network", " ", "drive"}], ",", " ", "PC"}], "*)"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"frogworkpath", "=", "\"\<I:\\\\FrogWork\\\\\>\""}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"for", " ", 
     RowBox[{"Chris", "'"}], " ", "PC"}], "*)"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msDirectory", "=", "\"\<\\\\FrogPubs\\\\frogSlerp\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setpathDataWin", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"frogworkpath", ",", "msDirectory"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "windows", " ", "formatted", " ", "path", " ", "as", " ", "string"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splitpath", "=", 
   RowBox[{"FileNameSplit", "[", 
    RowBox[{"setpathDataWin", ",", 
     RowBox[{"OperatingSystem", "\[Rule]", "\"\<Windows\>\""}]}], 
    RowBox[{"(*", 
     RowBox[{
     "change", " ", "to", " ", "MacOSX", " ", "if", " ", "necessary"}], 
     "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setpathms", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"splitpath", ",", 
     RowBox[{"OperatingSystem", "\[Rule]", "os"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", "setpathms", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleData", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<frogSlerp_styleSheet.txt\>\"", ",", "\"\<Table\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "figpanelDirectory", "=", 
   "\"\<\\\\FrogPubs\\\\frogSlerp\\\\figs\\\\panels\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setpathDataWin", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"frogworkpath", ",", "figpanelDirectory"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "windows", " ", "formatted", " ", "path", " ", "as", " ", "string"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splitpath", "=", 
   RowBox[{"FileNameSplit", "[", 
    RowBox[{"setpathDataWin", ",", 
     RowBox[{"OperatingSystem", "\[Rule]", "\"\<Windows\>\""}]}], 
    RowBox[{"(*", 
     RowBox[{
     "change", " ", "to", " ", "MacOSX", " ", "if", " ", "necessary"}], 
     "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setpathfigpanel", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"splitpath", ",", 
      RowBox[{"OperatingSystem", "\[Rule]", "os"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", "set"}]}], " ", "style", " ", "for", " ", "plot", " ", 
     "ticks"}], ",", " ", 
    RowBox[{"axes", " ", "and", " ", 
     RowBox[{
      RowBox[{"fonts", "--"}], "--"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"font", "=", 
   RowBox[{"styleData", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontsizeLegend", "=", 
   RowBox[{"styleData", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fontsizePanel", "=", 
    RowBox[{"styleData", "[", 
     RowBox[{"[", 
      RowBox[{"6", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontsizePlot", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisThickness", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"style", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
     RowBox[{"FontSize", "\[Rule]", "fontsizePlot"}], ",", 
     RowBox[{"FontColor", "\[Rule]", "Black"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axStyle", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "axisThickness", "]"}]}], "]"}], 
      ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "axisThickness", "]"}]}], "]"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"properties", " ", "for", " ", "graphs"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rangeTheta", "=", 
   RowBox[{"{", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"1.", "/", "Degree"}], "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.3"}], ",", "3.65"}], "}"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rangePhi", "=", 
   RowBox[{"{", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"1.", "/", "Degree"}], "  ", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1.7"}]}], "}"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Setting", "[", 
      ColorSetterBox[RGBColor[0., 0., 0.], "Swatch"], "]"}], ",", 
     RowBox[{"Setting", "[", 
      ColorSetterBox[RGBColor[
       0.9981994354161898, 0.3931486991683833, 0.3889829861905852], "Swatch"],
       "]"}], ",", 
     RowBox[{"Setting", "[", 
      ColorSetterBox[RGBColor[
       0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
       "Swatch"], "]"}], ",", 
     RowBox[{"Setting", "[", 
      ColorSetterBox[RGBColor[
       0.6215762569619288, 0.8791485465781643, 0.39208056763561455`], 
       "Swatch"], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.708850570689234*^9, 3.708850577299921*^9}, {
   3.708850804031027*^9, 3.708850804320982*^9}, {3.708850842776145*^9, 
   3.708850863777046*^9}, {3.708919327852592*^9, 3.7089193369644423`*^9}, {
   3.7089221394011583`*^9, 3.70892213977847*^9}, {3.708922288742977*^9, 
   3.708922317448085*^9}, {3.708940060400403*^9, 3.708940060798443*^9}, {
   3.709106080793857*^9, 3.709106081170966*^9}, {3.709126225444819*^9, 
   3.709126247194322*^9}, {3.709705846633484*^9, 3.709705847782317*^9}, {
   3.709960654675055*^9, 3.709960695797378*^9}, {3.7099668134698763`*^9, 
   3.709966818326096*^9}, {3.7099805071082582`*^9, 3.709980507445073*^9}, {
   3.710155323789688*^9, 3.710155336778537*^9}, {3.711428630491881*^9, 
   3.711428653185754*^9}, {3.714726688687209*^9, 3.71472669012988*^9}, {
   3.7147271383248377`*^9, 3.714727139884844*^9}, {3.714727264188663*^9, 
   3.7147272650674753`*^9}, {3.714908371313394*^9, 3.7149083852268047`*^9}, 
   3.715423837368691*^9}],

Cell[BoxData["\<\"Code written by Chris Richards, \\nRoyal Veterinary \
College, 2014\\n-- Package last Modified February 25, 2015, C. \
Richards\\n\\nFOR HELP:\\nType ?Function name\\n\\nFOR SAMPLE CODE:\\nType \
sampleBFilter[]\\nOR sampleDifferentiator[]\\n\\nThe functions in this \
package include:\\nBFilterR - forward-reverse (i.e. zero phase-shift) \
butterworth filter for smoothing 1d time series data\\nBFilter - butterworth \
filter for smoothing 1d time series data. \\nDifferentiator1D - Numerically \
differentiate 1d time series data\\nIntegrator1D - Numerically integrate 1d \
time series data\\n\"\>"], "Print",
 CellChangeTimes->{3.716088991481228*^9, 3.7161976634367113`*^9, 
  3.716222246793442*^9, 3.7162634600966063`*^9, 3.716525694398706*^9, 
  3.716612030372217*^9, 3.7166399500948143`*^9, 3.718517900722386*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7088505882995377`*^9, 3.7088506507758703`*^9}, {
   3.7088533642220087`*^9, 3.708853370699932*^9}, {3.7088595870542088`*^9, 
   3.708859587660377*^9}, {3.708859886397756*^9, 3.708859892730195*^9}, {
   3.708859939428039*^9, 3.708859939578534*^9}, 3.708859993073641*^9, {
   3.708860053169211*^9, 3.708860053246049*^9}, {3.708928049375338*^9, 
   3.708928050853603*^9}, {3.70892808175321*^9, 3.7089280818714123`*^9}, 
   3.708928512281526*^9, {3.708928589796526*^9, 3.708928590091213*^9}, {
   3.708941279555409*^9, 3.708941332693829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.715510371748557*^9, 3.715510396672996*^9}}],

Cell[BoxData[
 RowBox[{"FontSize", "\[Rule]", "16"}]], "Output",
 CellChangeTimes->{{3.71551037285122*^9, 3.7155103815111628`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
1. Trial selection and quaternionization of init and final poses\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879061144047*^9, 3.709879089347031*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"select", " ", "trial"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"trial", "=", 
     RowBox[{"midJumps", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PNTSraw", "=", 
     RowBox[{"pooledPOINTS", "[", 
      RowBox[{"[", "trial", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nframesRaw", "=", 
     RowBox[{"Length", "[", "PNTSraw", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Make", " ", "the", " ", "limb", " ", "flat", " ", "footed"}], 
     " ", "-", " ", 
     RowBox[{
     "assumes", " ", "foot", " ", "is", " ", "stuck", " ", "on", " ", "the", 
      " ", "ground"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PNTSraw1", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"lmb", "=", 
         RowBox[{"PNTSraw", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lmb", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"lmb", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.1", ",", "0"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "lmb"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PNTSraw", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", 
          RowBox[{"-", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"removes", " ", "the", " ", "body", " ", "yaw", " ", "angle"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PNTS", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"limb", "=", 
         RowBox[{"Reverse", "@", 
          RowBox[{"PNTSraw1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"angle", "=", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"limb", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"limb", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RM", "=", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{
           RowBox[{"-", "angle"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RM2", "=", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"limbRot", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Transpose", "[", 
           RowBox[{"RM", ".", 
            RowBox[{"Transpose", "[", "limb", "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pitchedBody", "=", 
         RowBox[{"RM2", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"limbRot", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "-", 
            RowBox[{"limbRot", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"this", " ", "calculation", " ", "is", " ", "unused"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"limbRot", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"limbRot", "[", 
           RowBox[{"[", 
            RowBox[{"-", "2"}], "]"}], "]"}], "+", "pitchedBody"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Reverse", "@", "limbRot"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PNTSraw1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "truncate", " ", "the", " ", "jump", " ", "so", " ", "it", " ", "ends", 
      " ", "at", " ", "peak", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"vel", "--"}], "--"}], "--"}]}], "-"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"comindex", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dcom", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"limbreal", "=", 
         RowBox[{"PNTS", "[", 
          RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"limbreal", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"limbreal", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"limbreal", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "limbreal", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"comInit", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fr", "\[Equal]", "1"}], ",", 
           RowBox[{"limbreal", "[", 
            RowBox[{"[", "comindex", "]"}], "]"}], ",", "comInit"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"com", "=", 
         RowBox[{"limbreal", "[", 
          RowBox[{"[", "comindex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"comInit", ",", "com"}], "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"fr", ",", "1", ",", "nframesRaw"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vcom", "=", 
     RowBox[{"Differentiator1D", "[", 
      RowBox[{"dcom", ",", "videodt", ",", "20"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nframes", "=", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Ordering", "[", 
        RowBox[{"vcom", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nframes", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nframes", ">", "nframesRaw"}], ",", "nframesRaw", ",", 
       "nframes"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lengths", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"EuclideanDistance", "[", 
        RowBox[{
         RowBox[{"PNTS", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"PNTS", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"PNTS", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", "mirror"}]}]}]}], " ", "the", " ", "left", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"leg", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
      "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb", "=", 
     RowBox[{"PNTS", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbm", "=", 
     RowBox[{"limbMirror", "[", 
      RowBox[{"limb", ",", 
       RowBox[{
        RowBox[{"limb", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"limb", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"limb", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", "quats"}]}], " ", "for", " ", "initial", " ", "and", " ", 
     "final", " ", 
     RowBox[{
      RowBox[{"poses", "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qref", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quatsi", "=", 
     RowBox[{"limbQUAT", "[", 
      RowBox[{
       RowBox[{"PNTS", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "qref"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quatsf", "=", 
     RowBox[{"limbQUAT", "[", 
      RowBox[{
       RowBox[{"PNTS", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", "qref"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quatsim", "=", 
     RowBox[{"limbQUAT", "[", 
      RowBox[{"limbm", ",", "qref"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"for", " ", "right", " ", "leg"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb1", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quatsi", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb1m", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quatsim", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb2", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quatsf", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limb1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limb1", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limb1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb1m", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limb1m", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limb1m", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limb1m", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limb2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limb2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limb2", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limb2", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
     "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.708850657897356*^9, 3.708850716589285*^9}, {
   3.708850767815824*^9, 3.708850769470475*^9}, {3.7088514225219383`*^9, 
   3.708851425785956*^9}, {3.708852440997035*^9, 3.708852467721745*^9}, {
   3.708852569848712*^9, 3.7088525771615543`*^9}, 3.708853378554306*^9, {
   3.7088600683787394`*^9, 3.708860107322949*^9}, {3.7089271259806643`*^9, 
   3.708927276009807*^9}, {3.7089274648159103`*^9, 3.708927466708687*^9}, {
   3.7089278267522163`*^9, 3.7089278530633907`*^9}, {3.708928561615014*^9, 
   3.7089285649516172`*^9}, {3.708928600148933*^9, 3.708928600476625*^9}, {
   3.708929462721456*^9, 3.708929465398013*^9}, {3.708941334190576*^9, 
   3.708941335375105*^9}, {3.708941491604752*^9, 3.708941504726457*^9}, 
   3.7089415639918127`*^9, {3.708941606927511*^9, 3.7089416078125153`*^9}, {
   3.708941656016465*^9, 3.708941657218852*^9}, {3.7089416965314207`*^9, 
   3.708941696874421*^9}, {3.708941731673945*^9, 3.708941731905365*^9}, 
   3.708941806471977*^9, {3.708941905426034*^9, 3.708941908314089*^9}, 
   3.7089434195851803`*^9, 3.708943476422449*^9, {3.708943527675905*^9, 
   3.708943529178862*^9}, 3.708943566883872*^9, {3.7089436200257597`*^9, 
   3.708943620176176*^9}, 3.7089444723863773`*^9, {3.708945580605874*^9, 
   3.708945582617577*^9}, {3.708945743297634*^9, 3.70894576809732*^9}, 
   3.7090145027829857`*^9, {3.709016887518839*^9, 3.7090169220712023`*^9}, {
   3.709017029601656*^9, 3.709017050543849*^9}, {3.709017123679421*^9, 
   3.709017126848328*^9}, {3.709024382826601*^9, 3.709024398376923*^9}, {
   3.709024445361014*^9, 3.709024491982031*^9}, {3.7090245838767548`*^9, 
   3.7090245847231503`*^9}, {3.709024629652195*^9, 3.709024631505889*^9}, {
   3.709028777175716*^9, 3.709028780607319*^9}, {3.709106783849474*^9, 
   3.709106813070331*^9}, {3.709714571244054*^9, 3.70971459218605*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2. Initial SLERP to find final time based on desired COM displacement. Also, \
compute interpolated time function based on COM displ curve.  Final time only \
used for comparison to real data.  For purely theoretical models, final time \
is based on when hip vector angle reaches 130 degrees (see Kinematics paper \
fig 3B)\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879096223153*^9, 3.709879147056716*^9}, {3.7113493258637543`*^9, 
  3.711349442771179*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"-", "perform"}], " ", "initial", " ", "slerp", 
    "\[IndentingNewLine]", " ", "to", " ", "find", " ", "when", " ", 
    "interpolated", " ", "\[IndentingNewLine]", "kinematics", " ", "reaches", 
    " ", "target", " ", "com"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"COMr", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"COMi", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats1", "=", "quatsi"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats2", "=", "quatsf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"qpitch", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "0"}], "]"}]}], ";", 
      
      RowBox[{"(*", 
       RowBox[{"to", " ", "pitch", " ", "the", " ", "body", " ", "axis"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"quats2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "quatsi", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"quats2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"quatsf", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"quats2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"qMult", "[", 
        RowBox[{
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "qpitch"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"quatsI", "=", 
       RowBox[{"limbSlerp", "[", 
        RowBox[{"quats1", ",", "quats2", ",", "t"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbI", "=", 
       RowBox[{"quatFK", "[", 
        RowBox[{"quatsI", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbI", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"limbI", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbI", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"angle4d", "=", 
       RowBox[{"VectorAngle", "[", 
        RowBox[{
         RowBox[{"quatsI", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"quatsf", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"frameI", "=", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nframes", "-", "1"}], ")"}], "t"}], "+", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"limbreal", "=", 
       RowBox[{"PNTS", "[", 
        RowBox[{"[", "frameI", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limbreal", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbreal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"limbreal", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbreal", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quatsReal", "=", 
       RowBox[{"limbQUAT", "[", 
        RowBox[{"limbreal", ",", "qref"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"COMr", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"COMr", ",", 
         RowBox[{"{", 
          RowBox[{"limbreal", "[", 
           RowBox[{"[", 
            RowBox[{"comindex", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"y", " ", "and", " ", "z", " ", "components"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"COMi", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"COMi", ",", 
         RowBox[{"{", 
          RowBox[{"limbI", "[", 
           RowBox[{"[", 
            RowBox[{"comindex", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "}"}]}], 
        "]"}]}], ";"}], 
     RowBox[{"(*", 
      RowBox[{"y", " ", "and", " ", "z", " ", "components"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"error", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"COMr", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "-", 
         RowBox[{"COMi", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "COMi", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "end", " ", "time", " ", "for", " ", "interpolation", " ", "is", " ", 
     "at", " ", "minimum", " ", "for", " ", "error"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"endTime", "=", 
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Ordering", "[", 
          RowBox[{"error", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "COMi", "]"}], "-", "1"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "initialize"}]}]}]}]}]}]}]}], " ", "target", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"quats", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
       "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quatsI", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "quatsi", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"for", " ", "interpolation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "quatsi", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"for", " ", "targeting"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats1", "=", "quatsi"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nominalPitch", "=", "0.785"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qpitch", "=", 
     RowBox[{"aaToq", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"nominalPitch", "+", 
        RowBox[{
         RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qyaw", "=", 
     RowBox[{"aaToq", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qtarget", "=", 
     RowBox[{"qMult", "[", 
      RowBox[{"qyaw", ",", "qpitch"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"quats2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", "qtarget"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "set", " ", "nominal", " ", "final", " ", "pose", " ", "at", " ", "jump",
       " ", "angle", " ", "45"}], ",", " ", 
     RowBox[{"no", " ", "turn"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quatsfNominal", "=", 
     RowBox[{"limbSlerp", "[", 
      RowBox[{"quats1", ",", "quats2", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "use", " ", "the", " ", "com", " ", "displacement", " ", "fun", " ", 
      "as", " ", "a", " ", "non"}], "-", 
     RowBox[{"linear", " ", "time", " ", "curve"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dcomXY", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nframes", "-", "1"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"dcom", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", 
          RowBox[{"Max", "[", 
           RowBox[{"dcom", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "nframes"}], "]"}], "]"}], "]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nframes"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "fit", " ", "with", " ", "a", " ", "4", "th", " ", "order", " ", 
     "polynomial"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dcomFun", "=", 
     RowBox[{"polyFit", "[", 
      RowBox[{"dcomXY", ",", "4", ",", "time"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timefun", "=", "dcomFun"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nsamples", "=", "20"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "number", " ", "of", " ", "time", " ", "samples", " ", "for", " ", 
     "eventual", " ", "slerping"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "[", "plot", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.708927855859455*^9, 3.708927892504703*^9}, {
   3.7089279645388947`*^9, 3.708928000330944*^9}, 3.7089280786594687`*^9, {
   3.708929483670434*^9, 3.708929584153902*^9}, {3.708929615457446*^9, 
   3.708929776352401*^9}, {3.709016937190839*^9, 3.709016943780498*^9}, {
   3.709024425407325*^9, 3.709024440773662*^9}, {3.709106844020905*^9, 
   3.7091069192488737`*^9}, 3.7093541121187973`*^9, {3.709354533908052*^9, 
   3.709354549330181*^9}, {3.709371458643587*^9, 3.7093714602101593`*^9}, {
   3.70944565149289*^9, 3.709445651780366*^9}, 3.709531707381057*^9, 
   3.709566264008933*^9, {3.709878890058648*^9, 3.70987889049997*^9}, {
   3.709879180314724*^9, 3.7098791807083597`*^9}, 3.710243104184854*^9, {
   3.711428165705764*^9, 3.711428193837803*^9}, {3.711428259200582*^9, 
   3.711428286989401*^9}, 3.711428332266981*^9, {3.7114285663324327`*^9, 
   3.711428577610629*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`plot, StandardForm],
  ImageSizeCache->{31., {3., 9.}}]], "Output",
 CellChangeTimes->{
  3.709825007579309*^9, 3.709825311200458*^9, 3.70987844315102*^9, 
   3.709878626194118*^9, 3.709878675573317*^9, 3.709879016444031*^9, 
   3.7098851679690247`*^9, 3.709919068059483*^9, 3.709966848552866*^9, 
   3.70998512884512*^9, 3.710044030789963*^9, 3.7101696287188463`*^9, {
   3.710243101818844*^9, 3.710243104845112*^9}, 3.710243305832204*^9, 
   3.7113484103161592`*^9, 3.711367185898382*^9, 3.711379691885405*^9, 
   3.7114283025861*^9, 3.7114285783888683`*^9, 3.714718651798506*^9, 
   3.714799676390959*^9, 3.71488014434271*^9, 3.714965090180841*^9, 
   3.714969603337327*^9, 3.714969760921051*^9, 3.715056489512495*^9, 
   3.715403349573915*^9, 3.715484232981798*^9, 3.715503922272094*^9, 
   3.715510336468261*^9, 3.716088997972024*^9, 3.71619766997676*^9, 
   3.716222256643655*^9, 3.716263473749442*^9, 3.716525700469863*^9, 
   3.71661205864264*^9, 3.716639960541321*^9, 3.718517905640193*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["endTime"], "Input",
 CellChangeTimes->{{3.710243066565689*^9, 3.71024306765304*^9}}],

Cell[BoxData["0.39`"], "Output",
 CellChangeTimes->{3.710243067950006*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
3.  Interactively test kinematics to see if it looks OK.  Play with target \
angles to choose which ones to use for IK.  Note, the right leg is just a \
mirror image and won\[CloseCurlyQuote]t line up, esp. for turns\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879189055435*^9, 3.709879263504459*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "-", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
, "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "perform", " ", "final", " ", "slerp", " ", "with", " ", "proper", " ", 
    "linear", " ", "time"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"comindex", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"range", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refframecol", "=", "Transparent"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats1", "=", "quatsi"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quatsi", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limbIinit", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"quats2", "=", "quatsfNominal"}], ";", "\[IndentingNewLine]", 
      RowBox[{"qpitch", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"pitchangle", "+", 
          RowBox[{"0", "*", 
           RowBox[{
            RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qyaw", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "yawangle"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qtarget", "=", 
       RowBox[{"qMult", "[", 
        RowBox[{"qyaw", ",", "qpitch"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"quats2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"qMult", "[", 
        RowBox[{"qtarget", ",", 
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "qtarget"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"quatsI", "=", 
       RowBox[{"limbSlerp", "[", 
        RowBox[{"quats1", ",", "quats2", ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"timefun", "/.", 
             RowBox[{"time", "\[Rule]", "t"}]}], ")"}], "*", "1"}], "*)"}], 
         "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limbI1", "=", 
       RowBox[{"quatFK", "[", 
        RowBox[{"quatsI", ",", "lengths", ",", "qref"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"limbI", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbI1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"limbI1", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbI1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"limbIm", "=", 
       RowBox[{"limbMirror", "[", 
        RowBox[{"limbI", ",", 
         RowBox[{
          RowBox[{"limbI", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"limbI", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"0", "*", 
          RowBox[{"limbIinit", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbIm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbIm", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"2", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
           RowBox[{"limbIinit", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbIm", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"frameI", "=", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nframes", "-", "1"}], ")"}], "t"}], "+", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"limbreal", "=", 
       RowBox[{"PNTS", "[", 
        RowBox[{"[", "frameI", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limbreal", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbreal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"limbreal", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbreal", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"angles", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"VectorAngle", "[", 
          RowBox[{
           RowBox[{"limbI", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"limbI", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "limbI", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"absoluteQuats", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"qqVec", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"limbI", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "0.01"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "limbI", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"draw", " ", "reference", " ", "frames"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"F0", "=", 
       RowBox[{"0.2", "*", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fbod", "=", 
       RowBox[{"qRotframe", "[", 
        RowBox[{
         RowBox[{"absoluteQuats", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "F0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"origbod", "=", 
       RowBox[{"limbI", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ffem", "=", 
       RowBox[{"qRotframe", "[", 
        RowBox[{
         RowBox[{"absoluteQuats", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "F0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"origfem", "=", 
       RowBox[{"limbI", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ftib", "=", 
       RowBox[{"qRotframe", "[", 
        RowBox[{
         RowBox[{"absoluteQuats", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "F0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"origtib", "=", 
       RowBox[{"limbI", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ftar", "=", 
       RowBox[{"qRotframe", "[", 
        RowBox[{
         RowBox[{"absoluteQuats", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "F0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"origtar", "=", 
       RowBox[{"limbI", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bodyaxis", "=", 
       RowBox[{
        RowBox[{"limbI", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"limbI", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bodyyaw", "=", 
       RowBox[{"VectorAngle", "[", 
        RowBox[{
         RowBox[{"bodyaxis", "*", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bodypitch", "=", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "-", 
        RowBox[{"VectorAngle", "[", 
         RowBox[{"bodyaxis", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"angHip3d", "=", 
       RowBox[{
        RowBox[{"N", "@", "Pi"}], "-", 
        RowBox[{"VectorAngle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"limbI", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"limbI", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"limbI", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"limbI", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"run", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPointPlot3D", "[", 
         RowBox[{"limb1", ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"(*", 
            RowBox[{"{", 
             RowBox[{"bodypitch", ",", "bodyyaw"}], "}"}], "*)"}], 
           "angHip3d"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
            "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"Line", "[", "limb1", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", "Thick", ",", 
           RowBox[{"Line", "[", "limbI", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", "Thick", ",", 
           RowBox[{"Line", "[", "limbIm", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Dashed", ",", "Thick", ",", 
             RowBox[{"Line", "[", "limbIm", "]"}]}], "}"}], "]"}], ","}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Thick", ",", "Dashed", ",", 
           RowBox[{"Line", "[", "limbreal", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPointPlot3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"limb1", "[", 
            RowBox[{"[", "comindex", "]"}], "]"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Large", ",", "Red"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"LineFrame", "[", 
          RowBox[{"Fbod", ",", "origbod", ",", "refframecol", ",", "0.001"}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"LineFrame", "[", 
          RowBox[{"Ffem", ",", "origfem", ",", "refframecol", ",", "0.001"}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"LineFrame", "[", 
          RowBox[{"Ftib", ",", "origtib", ",", "refframecol", ",", "0.001"}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"LineFrame", "[", 
          RowBox[{"Ftar", ",", "origtar", ",", "refframecol", ",", "0.001"}], 
          "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pitchangle", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"yawangle", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"TrackedSymbols", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "pitchangle", ",", "yawangle"}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.708851157254918*^9, 3.7088513803611727`*^9}, {
   3.708851441978751*^9, 3.708851581810505*^9}, {3.7088516270106497`*^9, 
   3.708851834799293*^9}, {3.708851869840769*^9, 3.708851885798669*^9}, {
   3.708852499695415*^9, 3.708852511459087*^9}, {3.7088525916583033`*^9, 
   3.7088526067135363`*^9}, {3.708852714652093*^9, 3.708852716656711*^9}, {
   3.708852748956443*^9, 3.7088528191710587`*^9}, {3.708853080272348*^9, 
   3.708853136454912*^9}, {3.708853202708185*^9, 3.708853234483055*^9}, {
   3.7088536020686274`*^9, 3.7088536760094137`*^9}, {3.708853790386092*^9, 
   3.708853792553454*^9}, {3.708853939369102*^9, 3.708853949888254*^9}, {
   3.708854105596787*^9, 3.7088541487266083`*^9}, {3.7088577398079357`*^9, 
   3.708857741424664*^9}, {3.7088579267905407`*^9, 3.708857932237504*^9}, 
   3.7088579974804163`*^9, 3.708858514888412*^9, 3.708858547580944*^9, {
   3.708858578846603*^9, 3.7088585804453278`*^9}, {3.708859623101853*^9, 
   3.708859652771962*^9}, {3.708859781633165*^9, 3.708859791177511*^9}, {
   3.708917859390259*^9, 3.7089178601030703`*^9}, {3.708919066068099*^9, 
   3.708919119798122*^9}, 3.708919500952319*^9, {3.70892049622108*^9, 
   3.708920505067025*^9}, {3.708920577561499*^9, 3.708920637439041*^9}, {
   3.7089207101800528`*^9, 3.708920815488531*^9}, 3.708921424189351*^9, {
   3.708921762154365*^9, 3.708921794321826*^9}, {3.708921887210855*^9, 
   3.708921982949478*^9}, 3.708922108932502*^9, {3.708922158545826*^9, 
   3.708922230555204*^9}, {3.708922343574925*^9, 3.708922409259698*^9}, {
   3.7089226247140493`*^9, 3.708922625168454*^9}, {3.708922659921678*^9, 
   3.708922809724197*^9}, {3.70892288325124*^9, 3.708922907905512*^9}, {
   3.7089273232580976`*^9, 3.708927413286813*^9}, 3.7089274475751953`*^9, {
   3.7089297888529663`*^9, 3.7089297903384657`*^9}, {3.708933712461359*^9, 
   3.7089337133475933`*^9}, {3.708933755475507*^9, 3.7089337566744003`*^9}, {
   3.708939188811327*^9, 3.708939215224424*^9}, {3.708939245478499*^9, 
   3.7089392458888197`*^9}, {3.7089396687347097`*^9, 3.708939683692177*^9}, {
   3.708940110615323*^9, 3.708940120141646*^9}, {3.708940549567545*^9, 
   3.708940567632497*^9}, {3.708940694631072*^9, 3.7089407510897207`*^9}, {
   3.7089411906674633`*^9, 3.70894126773622*^9}, 3.708944500866994*^9, {
   3.708944546625647*^9, 3.7089446506529293`*^9}, {3.709014392534863*^9, 
   3.709014465983178*^9}, {3.709014594032815*^9, 3.709014599062125*^9}, {
   3.709014668508906*^9, 3.70901468127978*^9}, {3.709015040985598*^9, 
   3.709015046425734*^9}, {3.7090150780246572`*^9, 3.709015093007039*^9}, {
   3.709015185584875*^9, 3.709015221978526*^9}, {3.70901525346312*^9, 
   3.70901527418009*^9}, {3.70901534643508*^9, 3.709015394400443*^9}, {
   3.70901585168876*^9, 3.709015889776528*^9}, {3.709015939232682*^9, 
   3.709015981494108*^9}, {3.709016022118526*^9, 3.709016026924708*^9}, {
   3.709016095818692*^9, 3.709016101249753*^9}, {3.7090161824848137`*^9, 
   3.709016187643017*^9}, {3.7090164102760677`*^9, 3.7090164330334377`*^9}, {
   3.709016537336699*^9, 3.709016600302245*^9}, {3.709016651617519*^9, 
   3.709016674688017*^9}, {3.709016975253227*^9, 3.7090169758929663`*^9}, {
   3.709017167226768*^9, 3.709017170807578*^9}, 3.709017222416709*^9, {
   3.709017298488484*^9, 3.709017353588266*^9}, {3.709017400372794*^9, 
   3.7090174580833387`*^9}, {3.7090174995073853`*^9, 3.709017500530095*^9}, {
   3.7090175452730722`*^9, 3.709017547312202*^9}, {3.70901758405585*^9, 
   3.709017618989512*^9}, {3.7090176783634043`*^9, 3.709017719890141*^9}, {
   3.709017888462101*^9, 3.709018010419208*^9}, {3.709018184172037*^9, 
   3.70901822885679*^9}, {3.709018290128942*^9, 3.709018294008471*^9}, {
   3.709018433860355*^9, 3.709018508887393*^9}, {3.7090185488990107`*^9, 
   3.7090185509616613`*^9}, 3.7090186077882967`*^9, {3.7090186412907333`*^9, 
   3.709018676839867*^9}, {3.709018719432917*^9, 3.709018745453967*^9}, {
   3.709023893432954*^9, 3.709023905831129*^9}, {3.7090239459942417`*^9, 
   3.709024044537035*^9}, 3.7090240748623867`*^9, {3.7090241246597652`*^9, 
   3.7090241933495693`*^9}, 3.709024321900914*^9, 3.709024529317177*^9, 
   3.7090247101501713`*^9, {3.709024751019334*^9, 3.709024752512871*^9}, 
   3.7090248914651737`*^9, {3.709024929024284*^9, 3.7090249292938557`*^9}, {
   3.7090250575647297`*^9, 3.7090251857687197`*^9}, {3.709025229307054*^9, 
   3.709025260344822*^9}, {3.7090253031828947`*^9, 3.70902531768478*^9}, {
   3.709026650143449*^9, 3.709026652378903*^9}, {3.709026695218533*^9, 
   3.709026766933025*^9}, {3.709026933392949*^9, 3.709026934391925*^9}, {
   3.7090271378513117`*^9, 3.70902723440949*^9}, 3.709027277414646*^9, 
   3.709027339741712*^9, {3.709027581458641*^9, 3.709027599739699*^9}, {
   3.709027647037505*^9, 3.709027676214696*^9}, {3.709027734996773*^9, 
   3.709027777838532*^9}, {3.709027834252459*^9, 3.709027889397416*^9}, 
   3.709027921518689*^9, {3.7090279675255527`*^9, 3.70902797134726*^9}, {
   3.709028741601664*^9, 3.709028765440461*^9}, {3.709028797156118*^9, 
   3.70902881745431*^9}, {3.70902885162257*^9, 3.7090288536603527`*^9}, {
   3.709029002052815*^9, 3.70902900359508*^9}, {3.709106993380239*^9, 
   3.7091071218635483`*^9}, {3.709107157286138*^9, 3.709107168117159*^9}, {
   3.70910736400172*^9, 3.709107367592367*^9}, {3.7091073982247133`*^9, 
   3.7091074664389*^9}, {3.709107518658969*^9, 3.7091075620043373`*^9}, {
   3.709107607847333*^9, 3.709107642685628*^9}, {3.7091077359150467`*^9, 
   3.709107892717863*^9}, {3.709107930292841*^9, 3.709107953092001*^9}, {
   3.709107997943693*^9, 3.709108026926433*^9}, {3.70910806284242*^9, 
   3.709108148279118*^9}, {3.709108214597307*^9, 3.709108227510488*^9}, {
   3.709108328234548*^9, 3.709108417518773*^9}, {3.70910846465427*^9, 
   3.709108472957575*^9}, {3.709108627032056*^9, 3.709108682215637*^9}, {
   3.709108718054277*^9, 3.709108941522934*^9}, {3.709108997800539*^9, 
   3.709109049134893*^9}, {3.709109120167498*^9, 3.709109126428789*^9}, {
   3.709109169401391*^9, 3.709109169945016*^9}, 3.7091092423557*^9, {
   3.7091092758341103`*^9, 3.709109379138186*^9}, {3.709109416392335*^9, 
   3.709109418218049*^9}, {3.709109450370854*^9, 3.709109571998674*^9}, {
   3.709109608007547*^9, 3.7091096098080873`*^9}, {3.709109641079582*^9, 
   3.709109682636964*^9}, {3.709109720136629*^9, 3.709109720691444*^9}, {
   3.7091097529090433`*^9, 3.7091097552486258`*^9}, {3.7091097876727333`*^9, 
   3.709109797604123*^9}, {3.709109829175787*^9, 3.709109829493023*^9}, 
   3.7091099763733273`*^9, {3.709110016655403*^9, 3.709110036397389*^9}, {
   3.709110069710691*^9, 3.70911008172577*^9}, {3.709110121253066*^9, 
   3.709110152214387*^9}, {3.709110198064183*^9, 3.7091101996946383`*^9}, {
   3.709110324058242*^9, 3.70911046553071*^9}, {3.709110500811738*^9, 
   3.7091105319748573`*^9}, {3.709110653811721*^9, 3.7091107287368803`*^9}, {
   3.70911078075324*^9, 3.7091107856665087`*^9}, {3.709111005709223*^9, 
   3.7091111886619463`*^9}, {3.7091262718179827`*^9, 3.709126304817993*^9}, {
   3.709126340819545*^9, 3.709126644666456*^9}, {3.7091266975056887`*^9, 
   3.709126729479334*^9}, {3.70912714934486*^9, 3.709127150710281*^9}, 
   3.709127197734085*^9, {3.709127268386157*^9, 3.709127344627741*^9}, {
   3.709127433584353*^9, 3.7091274779369926`*^9}, {3.709127517926959*^9, 
   3.70912753213251*^9}, 3.709127587560073*^9, 3.7091276181886473`*^9, {
   3.709127650986188*^9, 3.70912766078664*^9}, 3.709127729443468*^9, {
   3.709127782843087*^9, 3.7091278147611322`*^9}, 3.709132408594202*^9, 
   3.7091324529493027`*^9, {3.7091325444934587`*^9, 3.709132546901373*^9}, 
   3.709132611426531*^9, {3.709132737474131*^9, 3.7091327648054857`*^9}, {
   3.709132797979005*^9, 3.709132803431535*^9}, 3.70913287310754*^9, 
   3.709133001972289*^9, {3.709133039365199*^9, 3.7091331139533663`*^9}, 
   3.709133349295133*^9, {3.709133443205174*^9, 3.7091334691598*^9}, {
   3.7091335038397427`*^9, 3.7091335159275417`*^9}, {3.709133546581127*^9, 
   3.709133549620163*^9}, {3.7091335854869328`*^9, 3.7091336617501163`*^9}, 
   3.709133764138484*^9, 3.709133796464026*^9, 3.709133834189631*^9, {
   3.709219252789876*^9, 3.709219275341544*^9}, {3.709219359200768*^9, 
   3.709219365302414*^9}, {3.70922330332766*^9, 3.709223310263685*^9}, {
   3.7092234104524307`*^9, 3.709223415099709*^9}, {3.709223458883706*^9, 
   3.7092236195724373`*^9}, {3.709223664825912*^9, 3.7092238155450373`*^9}, 
   3.709223923058517*^9, 3.709223954799796*^9, {3.709224010421028*^9, 
   3.709224082378623*^9}, 3.709224149570552*^9, {3.7092241920465384`*^9, 
   3.709224278784377*^9}, {3.709224317103331*^9, 3.709224318292675*^9}, {
   3.709224376760737*^9, 3.709224429063719*^9}, {3.7092244973756113`*^9, 
   3.70922450057404*^9}, {3.709224533274846*^9, 3.7092247546886263`*^9}, {
   3.7092247888552303`*^9, 3.709224814398181*^9}, {3.709224854606339*^9, 
   3.709224917337307*^9}, {3.709224978364456*^9, 3.709224995674573*^9}, {
   3.709225078919982*^9, 3.709225167276896*^9}, {3.709225200282586*^9, 
   3.709225237183611*^9}, {3.709353916828641*^9, 3.709353919428879*^9}, 
   3.7093541279902*^9, {3.709354565390772*^9, 3.7093546832583714`*^9}, {
   3.7093550291321487`*^9, 3.709355044287222*^9}, {3.70935545167695*^9, 
   3.709355454207222*^9}, {3.709355762645049*^9, 3.709355799070991*^9}, {
   3.7093559168365803`*^9, 3.709355939827532*^9}, {3.7093559702826633`*^9, 
   3.709355992336358*^9}, {3.7093560243851223`*^9, 3.709356183621608*^9}, {
   3.7093563082199907`*^9, 3.7093563091408567`*^9}, {3.7093711690515757`*^9, 
   3.709371253425583*^9}, {3.709371294687599*^9, 3.70937130218312*^9}, {
   3.709371373279484*^9, 3.709371398852169*^9}, {3.709371544424715*^9, 
   3.709371546501321*^9}, {3.7093715850745153`*^9, 3.7093716172027273`*^9}, 
   3.7093796276198063`*^9, {3.70937966652085*^9, 3.709379685138687*^9}, {
   3.7093797317642527`*^9, 3.709379735038159*^9}, {3.7093799372374573`*^9, 
   3.70937997919519*^9}, {3.709380033105229*^9, 3.7093801734433126`*^9}, {
   3.709380205662795*^9, 3.709380233758154*^9}, 3.709380283152334*^9, {
   3.709380354288382*^9, 3.7093803686061993`*^9}, {3.7093804258849773`*^9, 
   3.709380426505381*^9}, 3.709380459610964*^9, {3.70938058598636*^9, 
   3.709380597713744*^9}, 3.70938068153743*^9, 3.709380749407671*^9, {
   3.709380782977716*^9, 3.709380893966835*^9}, 3.709380935451549*^9, {
   3.709381055612885*^9, 3.709381067941639*^9}, 3.7093811072009706`*^9, {
   3.709381137963072*^9, 3.709381143750483*^9}, {3.7093811925937223`*^9, 
   3.709381257224679*^9}, {3.7093812904185867`*^9, 3.7093813133015633`*^9}, {
   3.709381367431459*^9, 3.709381433727047*^9}, {3.7093814687186317`*^9, 
   3.70938147040035*^9}, 3.70939565510616*^9, {3.7093956931033297`*^9, 
   3.709395794736538*^9}, {3.709395858256104*^9, 3.709395918593597*^9}, {
   3.709395956450159*^9, 3.709396017945085*^9}, {3.7093960482718678`*^9, 
   3.70939606116473*^9}, {3.709396126549646*^9, 3.7093961512758083`*^9}, {
   3.709396200219105*^9, 3.7093962734329243`*^9}, {3.709396303672037*^9, 
   3.709396322909182*^9}, 3.7093963602006493`*^9, {3.709396424230556*^9, 
   3.7093964307420263`*^9}, {3.709396479901175*^9, 3.709396543943369*^9}, {
   3.709396578449213*^9, 3.709396630812746*^9}, {3.709396887116406*^9, 
   3.709396892425321*^9}, {3.7093969391936073`*^9, 3.709397036213386*^9}, {
   3.7093970820633917`*^9, 3.7093971029395943`*^9}, 3.70939732919597*^9, 
   3.709397404472784*^9, {3.7093975593137197`*^9, 3.7093977277500687`*^9}, {
   3.709397809340699*^9, 3.709397833003809*^9}, {3.709439637929995*^9, 
   3.709439661020564*^9}, {3.709439697754983*^9, 3.709439740251363*^9}, {
   3.709439872735557*^9, 3.709439877613929*^9}, {3.709439916493029*^9, 
   3.709439927478084*^9}, {3.709443798986274*^9, 3.7094438004137383`*^9}, {
   3.7094439605754213`*^9, 3.709443964076573*^9}, 3.709445208215621*^9, {
   3.709445349824437*^9, 3.7094453799703093`*^9}, {3.7094454952615833`*^9, 
   3.7094455458018627`*^9}, {3.709523902445784*^9, 3.709523916549268*^9}, {
   3.709523966406893*^9, 3.7095239682372828`*^9}, {3.7095240008405523`*^9, 
   3.709524068364633*^9}, {3.709524107782696*^9, 3.709524112915208*^9}, {
   3.7095241646139193`*^9, 3.7095242026967087`*^9}, {3.709526463042074*^9, 
   3.709526472386614*^9}, {3.7095269928499126`*^9, 3.709527009242477*^9}, {
   3.70952776281765*^9, 3.709527781806638*^9}, 3.7096568581777*^9, {
   3.709714614069083*^9, 3.7097146195414867`*^9}, {3.709714782596534*^9, 
   3.7097148016346827`*^9}, {3.7097149512774353`*^9, 3.709715043554469*^9}, {
   3.709715171458373*^9, 3.709715171728704*^9}, {3.7097152118015957`*^9, 
   3.709715292563356*^9}, {3.709715331717157*^9, 3.7097153777549267`*^9}, 
   3.7098788440709553`*^9, {3.709879177371961*^9, 3.709879186693102*^9}, {
   3.709879422158072*^9, 3.7098795746406183`*^9}, {3.710156066246142*^9, 
   3.7101560779937277`*^9}, {3.7113487188330393`*^9, 3.711348799018262*^9}, {
   3.71134885417271*^9, 3.71134885554001*^9}, {3.7113488900122232`*^9, 
   3.711348897299679*^9}, {3.711349214707512*^9, 3.711349242922903*^9}, 
   3.711379771707217*^9, 3.711428363275897*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
4.  Use IK to solve Right leg kinematics - i.e. mirror first then correct \
with IK. Do for each condition and export\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.71004075680896*^9, 
  3.71004076644074*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/simData\>\"\
", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "NOW", " ", "do", " ", "interpolation", " ", "and", " ", "use", " ", "IK",
      " ", "to", " ", "correct", " ", "mirrored", " ", "limb", " ", "for", 
     " ", "several", " ", "time", " ", "steps"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportQ", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{"(*", 
     RowBox[{"change", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PNTSi", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PNTSim", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"QUATSL", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"QUATSR", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionIndex", "=", "itr2"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{"change", " ", "time", " ", "value"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"pitch", " ", "angles", " ", "for", " ", 
          RowBox[{"body", ":", " ", "0"}]}], ",", " ", "22.5", ",", " ", "45",
          ",", " ", 
         RowBox[{
          RowBox[{"67.5", " ", "--"}], ">", " ", "0"}], ",", " ", "0.3927", 
         ",", " ", "0.785", ",", " ", "1.178"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"yaw", " ", 
          RowBox[{"angles", ":", " ", "0"}]}], ",", " ", "22.5", ",", " ", 
         "45"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"-", "variable"}]}], " ", 
          RowBox[{"conditions", ".", "  ", "Nominal"}], " ", "condition", " ", 
          RowBox[{"first", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pitch", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.52"}], ",", 
                RowBox[{"-", "0.023"}], ",", "0.478", ",", "0.978"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.52"}], ",", 
                RowBox[{"-", "0.023"}], ",", "0.475"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.457"}], ",", 
                RowBox[{"-", "0.025"}]}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"[", "conditionIndex", "]"}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"-", "0.55"}], " ", "for", " ", "roughly", " ", 
           "horizontal"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"yaw", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.4998", ",", "0.4998", ",", "0.537"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.998", ",", "1.01"}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"[", "conditionIndex", "]"}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{"0.39", " ", "is", " ", "22.5", " ", "degrees"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"timegain", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "0.9", ",", "0.9", ",", "0.9"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "0.9", ",", "0.9"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "0.9"}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"[", "conditionIndex", "]"}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"on", " ", "turns"}], ",", " ", 
           RowBox[{"right", " ", "leg", " ", 
            RowBox[{"can", "'"}], "t", " ", "reach"}], ",", " ", 
           RowBox[{"so", " ", "takeoff", " ", 
            RowBox[{"sooner", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", "set"}]}], " ", "target", " ", "for", " ", "left", 
           " ", 
           RowBox[{
            RowBox[{"leg", " ", "--"}], "--"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"timevalue", "=", 
            RowBox[{"timefun", "/.", 
             RowBox[{"time", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"timegain", "*", 
                RowBox[{"itime", "/", "nsamples"}]}], ")"}]}]}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"quats2", "=", "quatsfNominal"}], ";", "\[IndentingNewLine]", 
         RowBox[{"qpitch", "=", 
          RowBox[{"aaToq", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"pitch", "+", 
             RowBox[{"0", "*", 
              RowBox[{
               RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"qyaw", "=", 
          RowBox[{"aaToq", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "yaw"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"qtarget", "=", 
          RowBox[{"qMult", "[", 
           RowBox[{"qyaw", ",", "qpitch"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"quats2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"qMult", "[", 
           RowBox[{"qtarget", ",", 
            RowBox[{"quats2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", "constrain"}]}]}], " ", "end", " ", "of", " ", 
            "jump", " ", "based", " ", "on", " ", "hip", " ", "3", "d", " ", 
            RowBox[{"angle", "--"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"itime", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"angHip3d", "=", "0"}], ";", 
            RowBox[{"(*", 
             RowBox[{"hip", " ", "3", "d", " ", "angle"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"tt", "=", "0"}], ";", 
            RowBox[{"(*", 
             RowBox[{"time", " ", "value", " ", "to", " ", "use"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"dt", "=", "0.01"}], ";", 
            RowBox[{"(*", 
             RowBox[{"increment", " ", "for", " ", "time"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"angHip3d", "<", 
               RowBox[{"130", "*", 
                RowBox[{"Pi", "/", "180.0"}]}]}], 
              RowBox[{"(*", 
               RowBox[{"hip", " ", "3", "d", " ", "angle", " ", "threshold"}],
                "*)"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"quatsItest", "=", 
                RowBox[{"limbSlerp", "[", 
                 RowBox[{"quats1", ",", "quats2", ",", "tt"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"limbItest", "=", 
                RowBox[{"quatFK", "[", 
                 RowBox[{"quatsItest", ",", "lengths", ",", "qref"}], "]"}]}],
                ";", " ", "\[IndentingNewLine]", 
               RowBox[{"limbItest", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"limbItest", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"limbItest", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "limbItest", "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"angHip3d", "=", 
                RowBox[{
                 RowBox[{"N", "@", "Pi"}], "-", 
                 RowBox[{"VectorAngle", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"limbItest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"limbItest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"limbItest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"limbItest", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tt", "=", 
                RowBox[{"tt", "+", "dt"}]}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "scale", " ", "the", " ", "timefun", " ", "according", " ", "to", 
           " ", "tt", " ", "to", " ", "try", " ", "to", " ", "have", " ", 
           "the", " ", "same", " ", "velocity", " ", "profile"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"timeTable", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"time", "*", "tt"}], ",", 
              RowBox[{"tt", "*", "timefun"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"time", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"nsamples", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"timefunScaled", "=", 
          RowBox[{"Interpolation", "[", "timeTable", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
           " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"timevalue", "=", 
          RowBox[{"timefunScaled", "[", 
           RowBox[{"(", 
            RowBox[{"tt", "*", 
             RowBox[{"itime", "/", "nsamples"}]}], ")"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"quatsIL", "=", 
          RowBox[{"limbSlerp", "[", 
           RowBox[{"quats1", ",", "quats2", ",", "timevalue"}], "]"}]}], ";", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"left", " ", "leg"}], ",", " ", "slerped"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"limbI1", "=", 
          RowBox[{"quatFK", "[", 
           RowBox[{"quatsIL", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"limbIL", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"limbI1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"limbI1", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "limbI1", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"angHip3d", "=", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "-", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"limbIL", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"limbIL", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"limbIL", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"limbIL", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"--", 
             RowBox[{"-", "get"}]}], " ", "left", " ", "leg", " ", "at", " ", 
            "time", " ", "0", " ", "to", " ", "be", " ", "mirrored", " ", 
            "for", " ", "right", " ", "initial", " ", 
            RowBox[{"config", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"alternative", " ", "1"}], " ", "-", " ", 
           RowBox[{
           "solve", " ", "right", " ", "leg", " ", "by", " ", "slerping", " ",
             "from", " ", "initial", " ", "pose", " ", 
            RowBox[{"(", "mirrored", ")"}], " ", "then", " ", "IK", " ", "to",
             " ", "correct"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"quatsIL0", "=", "quats1"}], ";", 
         RowBox[{"(*", 
          RowBox[{"left", " ", "leg", " ", "at", " ", "time", " ", "0"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"limbIL0", "=", 
          RowBox[{"quatFK", "[", 
           RowBox[{"quatsIL0", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limbIL0", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"limbIL0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"limbIL0", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "limbIL0", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"limbIR0", "=", 
          RowBox[{"limbMirror", "[", 
           RowBox[{"limbIL0", ",", 
            RowBox[{
             RowBox[{"limbIL0", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"limbIL0", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"0", "*", 
             RowBox[{"limbIinit", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limbIR0", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"limbIR0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"2", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
              RowBox[{"limbIinit", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "limbIR0", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"quatsIR0", "=", 
          RowBox[{"limbQUAT", "[", 
           RowBox[{"limbIR0", ",", "qref"}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "R", " ", "leg", " ", "at", " ", "time", " ", "0", " ", "mirrored", 
           " ", "from", " ", "left"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"--", 
             RowBox[{"--", "right"}]}], " ", "leg", " ", "target"}], " ", "-",
            " ", 
           RowBox[{
           "substitute", " ", "body", " ", "axis", " ", "of", " ", "slerped", 
            " ", "left", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"leg", "--"}], "--"}], "--"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"quats2R", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "quatsi", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"quats2R", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{"quatsIL", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"quatsIR", "=", 
            RowBox[{"limbSlerp", "[", 
             RowBox[{"quatsIR0", ",", "quats2R", ",", "timevalue"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"limbIR", "=", 
            RowBox[{"quatFK", "[", 
             RowBox[{"quatsIR", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"limbIR", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"limbIR", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"limbIR", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "limbIR", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"limbIR", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"limbIR", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"2", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
                RowBox[{"limbIinit", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "limbIR", "]"}]}], "}"}]}], "]"}]}], 
           ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"alternative", " ", "2"}], " ", "-", " ", 
           RowBox[{
           "solve", " ", "right", " ", "leg", " ", "by", " ", "mirroring", 
            " ", "left", " ", "then", " ", "IK"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"limbIR", "=", 
          RowBox[{"limbMirror", "[", 
           RowBox[{"limbIL", ",", 
            RowBox[{
             RowBox[{"limbIL", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"limbIL", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"0", "*", 
             RowBox[{"limbIinit", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limbIR", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"limbIR", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"2", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
              RowBox[{"limbIinit", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "limbIR", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "*******)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "use", " ", "Inverse", " ", "kinematics", " ", "to", " ", "correct",
            " ", "displacement", " ", "from", " ", "midline"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**", "**", "**"}], "*******)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "find", " ", "position", " ", "of", " ", "X", " ", "component", " ",
            "of", " ", "body"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"initX", "=", 
          RowBox[{"limbIL", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "initialize", " ", "the", " ", "quaternion", " ", "lists", " ", 
           "for", " ", "IK"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"limbInit", "=", "limbIR"}], ";", "\[IndentingNewLine]", 
         RowBox[{"PhipTarg", "=", 
          RowBox[{"limbIL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Phip", "=", 
          RowBox[{"limbInit", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "calculate", " ", "error", " ", "due", " ", "to", " ", "X", " ", 
           "position", " ", "drift"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"Phip", "-", "PhipTarg"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"quatsIKR", "=", 
          RowBox[{"limbQUAT", "[", 
           RowBox[{"limbIR", ",", "qref"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limbIKR", "=", 
          RowBox[{"quatFK", "[", 
           RowBox[{"quatsIKR", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"itr", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"errorXData", "=", 
          RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"inc", "=", "0.1"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"start", " ", "inverse", " ", "kinematics"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"EE", "=", 
          RowBox[{"Norm", "[", "error", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Norm", "[", "error", "]"}], ">", "0.001"}], ")"}], "&&", 
            RowBox[{"itr", "<", "1000"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"limbIKR", "=", 
             RowBox[{"quatFK", "[", 
              RowBox[{"quatsIKR", ",", "lengths", ",", "qref"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"limbIKR", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"limbIKR", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"limbIKR", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "limbIKR", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"limbIKR", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"limbIKR", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", 
                RowBox[{"2", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
                 RowBox[{"limbIinit", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "limbIKR", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Phip", "=", 
             RowBox[{"limbIKR", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"error", "=", 
             RowBox[{"Phip", "-", "PhipTarg"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"EE", "=", 
             RowBox[{"Norm", "[", "error", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "get", " ", "axes", " ", "and", " ", "angles", " ", "of", " ", 
              "limb", " ", "from", " ", "quaternions"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"axes", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"qAxis", "[", 
                RowBox[{"quatsIKR", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "quatsIKR", "]"}]}], "}"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"angles", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"qAngle", "[", 
                RowBox[{"quatsIKR", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "quatsIKR", "]"}]}], "}"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "jacobian", " ", "for", " ", "limb", " ", "in", " ", "axis", " ",
               "angle", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AAT", "=", 
             RowBox[{
              RowBox[{"AJ", "[", 
               RowBox[{"limbIKR", ",", "axes"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AApinv", "=", 
             RowBox[{"PseudoInverse", "[", "AAT", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dq", "=", 
             RowBox[{"inc", "*", 
              RowBox[{"AApinv", ".", "error"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "rebuild", " ", "quaternions", " ", "from", " ", "axes", " ", 
              "and", " ", "angles"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"quatsCorr", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"aaToq", "[", 
                RowBox[{
                 RowBox[{"axes", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"angles", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"dq", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "axes", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"quatsIKR", "=", "quatsCorr"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"plot1", "=", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ListPointPlot3D", "[", 
                RowBox[{"limbIL", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
                 
                 RowBox[{"BoxRatios", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
                 
                 RowBox[{"PlotLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"EE", ",", "status"}], "}"}]}], ",", 
                 RowBox[{"AxesLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
                   "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Graphics3D", "[", 
                RowBox[{"Line", "[", "limbIL", "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Graphics3D", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Line", "[", "limbIKR", "]"}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Graphics3D", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Dashed", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"itr", "=", 
             RowBox[{"itr", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"status", "=", 
             RowBox[{"{", 
              RowBox[{
              "itr", ",", "conditionIndex", ",", "angHip3d", ",", "timevalue",
                ",", "itime"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"PNTSi", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"PNTSi", ",", 
            RowBox[{"{", "limbIL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PNTSim", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"PNTSim", ",", 
            RowBox[{"{", 
             RowBox[{"limbIKR", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"QUATSL", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"QUATSL", ",", 
            RowBox[{"{", 
             RowBox[{"limbQUAT", "[", 
              RowBox[{"limbIL", ",", "qref"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"QUATSR", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"QUATSR", ",", 
            RowBox[{"{", 
             RowBox[{"limbQUAT", "[", 
              RowBox[{"limbIKR", ",", "qref"}], "]"}], "}"}]}], "]"}]}], 
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"itime", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PNTSiFlat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"PNTSi", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSimFlat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"PNTSim", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"filenameL", "=", 
       RowBox[{"\"\<slerpPNTSL_\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"conditionIndex", ",", "10", ",", "2"}], "]"}], "<>", 
        "\"\<.dat\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"filenameR", "=", 
       RowBox[{"\"\<slerpPNTSR_\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{"conditionIndex", ",", "10", ",", "2"}], "]"}], "<>", 
        "\"\<.dat\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"exportQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{"filenameL", ",", "PNTSiFlat"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{"filenameR", ",", "PNTSimFlat"}], "]"}], ";"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"itr2", ",", "1", ",", "10"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResetDirectory", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.709445665053932*^9, 3.709445680098406*^9}, {
   3.7095275547491007`*^9, 3.70952759675386*^9}, {3.709527653747697*^9, 
   3.709527653904962*^9}, {3.709527962411482*^9, 3.709527963080003*^9}, {
   3.709528179203121*^9, 3.709528195472632*^9}, {3.70952824840073*^9, 
   3.7095282603266973`*^9}, 3.709566204864376*^9, {3.709566270280307*^9, 
   3.709566271680757*^9}, {3.709566497999732*^9, 3.709566498165351*^9}, {
   3.709566569785941*^9, 3.7095665699207687`*^9}, 3.709566625553795*^9, {
   3.709655750776238*^9, 3.7096557628897877`*^9}, {3.709655830483509*^9, 
   3.709655855463091*^9}, {3.709655935100415*^9, 3.709655942386264*^9}, {
   3.709656186355452*^9, 3.7096561995962753`*^9}, {3.709656238034121*^9, 
   3.709656243160462*^9}, {3.709656299829761*^9, 3.709656338714237*^9}, 
   3.709656419769657*^9, {3.709706888016814*^9, 3.709707042043046*^9}, {
   3.709707078092299*^9, 3.7097070787627573`*^9}, {3.709707135035431*^9, 
   3.709707161832457*^9}, {3.7097072225129337`*^9, 3.709707226215733*^9}, {
   3.709707842251586*^9, 3.709707879003109*^9}, {3.7097079135527077`*^9, 
   3.709707966076598*^9}, {3.709708016393303*^9, 3.7097080231117887`*^9}, {
   3.709708111579096*^9, 3.709708114200843*^9}, {3.709708195619302*^9, 
   3.709708204866119*^9}, {3.709714056436915*^9, 3.709714067753395*^9}, {
   3.7097143389141483`*^9, 3.709714351593952*^9}, {3.7097154510271*^9, 
   3.709715487271901*^9}, 3.7097155956342897`*^9, {3.709715648507959*^9, 
   3.709715692414905*^9}, {3.709715770605063*^9, 3.7097158070740633`*^9}, {
   3.709715883307231*^9, 3.709715883624699*^9}, {3.70971605799851*^9, 
   3.709716107910001*^9}, {3.709716147635795*^9, 3.709716199177311*^9}, {
   3.7097163196977377`*^9, 3.709716332010647*^9}, {3.709716392970211*^9, 
   3.709716442945284*^9}, {3.709716476175723*^9, 3.7097164822703*^9}, {
   3.7097165265825167`*^9, 3.709716583050791*^9}, {3.7097166187036057`*^9, 
   3.7097166259469347`*^9}, 3.70971671121471*^9, {3.709716764163398*^9, 
   3.709716771070561*^9}, {3.709716809376561*^9, 3.709716840740374*^9}, 
   3.7097168728270683`*^9, {3.709716904893118*^9, 3.7097169923297567`*^9}, 
   3.709717041113143*^9, 3.709717078183434*^9, {3.709717182362761*^9, 
   3.7097171946373663`*^9}, {3.709717229026078*^9, 3.709717375878954*^9}, {
   3.709731395960129*^9, 3.709731403307914*^9}, {3.709731452303651*^9, 
   3.709731636750927*^9}, {3.7097316935759706`*^9, 3.709731695138811*^9}, {
   3.7097318799751177`*^9, 3.709731924196115*^9}, {3.709732097180161*^9, 
   3.709732097296829*^9}, 3.709732189672111*^9, {3.709732296814897*^9, 
   3.709732315859028*^9}, {3.709732686508013*^9, 3.709732692634369*^9}, {
   3.709738068425126*^9, 3.709738097725978*^9}, {3.7097381727850733`*^9, 
   3.709738174038629*^9}, {3.709738390010049*^9, 3.709738394985332*^9}, {
   3.709738427364962*^9, 3.7097384664390783`*^9}, {3.7097388390637627`*^9, 
   3.709738854478448*^9}, {3.709738949753256*^9, 3.709738974248621*^9}, {
   3.709739004746916*^9, 3.7097390973152246`*^9}, {3.709739150077632*^9, 
   3.709739238865958*^9}, {3.709739276317142*^9, 3.709739282205367*^9}, {
   3.709739315466473*^9, 3.709739496515979*^9}, {3.7097395568616343`*^9, 
   3.709739577145527*^9}, {3.709740757570841*^9, 3.709740769278722*^9}, {
   3.7097408069967117`*^9, 3.7097409934246807`*^9}, {3.709741097161615*^9, 
   3.709741148955002*^9}, {3.709741193827286*^9, 3.709741299962038*^9}, {
   3.709741424172201*^9, 3.709741461779563*^9}, 3.709741541289413*^9, {
   3.709742188413759*^9, 3.7097421892186937`*^9}, {3.709742510664818*^9, 
   3.709742564188219*^9}, {3.709742700335331*^9, 3.709742725684771*^9}, {
   3.709743052781962*^9, 3.709743147391921*^9}, {3.709743207262804*^9, 
   3.709743245144064*^9}, 3.709743336941119*^9, {3.7097433987275457`*^9, 
   3.7097434223018217`*^9}, {3.7097434525657053`*^9, 3.709743457137816*^9}, 
   3.7097441356903763`*^9, {3.709744417399109*^9, 3.709744651433734*^9}, {
   3.70982513038552*^9, 3.70982513361584*^9}, {3.709825184434964*^9, 
   3.709825189909459*^9}, 3.709825229362895*^9, 3.709825399743491*^9, {
   3.709825478026709*^9, 3.709825478808598*^9}, {3.709825531584609*^9, 
   3.7098255320067472`*^9}, 3.709825590158931*^9, {3.709825706656414*^9, 
   3.709825821442809*^9}, {3.7098793158561363`*^9, 3.709879321324973*^9}, {
   3.709879365327039*^9, 3.709879377074367*^9}, {3.7098796539867973`*^9, 
   3.709879685896612*^9}, {3.7098799845937223`*^9, 3.709879995901794*^9}, {
   3.709880042527073*^9, 3.709880060756343*^9}, {3.709885375305378*^9, 
   3.709885409088719*^9}, {3.709885611926399*^9, 3.7098856624425793`*^9}, {
   3.70988590989216*^9, 3.709885921712862*^9}, {3.709886173517812*^9, 
   3.709886195913216*^9}, {3.709886315146678*^9, 3.7098863227084837`*^9}, {
   3.709886509381309*^9, 3.70988650949826*^9}, {3.7098865787851*^9, 
   3.709886586614284*^9}, {3.709887638877925*^9, 3.709887694774926*^9}, {
   3.7098884409234133`*^9, 3.709888467264439*^9}, {3.709888510570408*^9, 
   3.7098885163128157`*^9}, {3.7098886354611063`*^9, 3.709888635538417*^9}, 
   3.709919228715908*^9, {3.709919351961958*^9, 3.709919366065995*^9}, 
   3.7099194215319242`*^9, {3.709919591966008*^9, 3.709919592378487*^9}, {
   3.709919635209024*^9, 3.709919666128211*^9}, {3.709919779867794*^9, 
   3.709919792896585*^9}, {3.709919984557088*^9, 3.709920001457019*^9}, {
   3.7099200778862257`*^9, 3.709920077948715*^9}, {3.709966940867841*^9, 
   3.709966959763316*^9}, {3.709967176594293*^9, 3.709967217957635*^9}, {
   3.709967693854751*^9, 3.709967713251278*^9}, 3.7099824491311398`*^9, {
   3.7099852678122387`*^9, 3.70998560677807*^9}, {3.7099857097096863`*^9, 
   3.709985714037017*^9}, {3.710040772446478*^9, 3.710040811101006*^9}, {
   3.710044044612076*^9, 3.7100440451373672`*^9}, 3.7100441470383043`*^9, 
   3.710044185884996*^9, 3.710044242668679*^9, {3.710044416215108*^9, 
   3.71004442817947*^9}, {3.7100446609929943`*^9, 3.7100446623126163`*^9}, {
   3.710044747070013*^9, 3.710044775055835*^9}, {3.710044867465797*^9, 
   3.710044867597584*^9}, {3.710045813987159*^9, 3.710045817030039*^9}, {
   3.711350083789989*^9, 3.711350109996047*^9}, {3.7113507695337543`*^9, 
   3.711350844336186*^9}, 3.711350875730649*^9, {3.711350908719396*^9, 
   3.711350947036386*^9}, {3.71135098382086*^9, 3.711350983955439*^9}, {
   3.711351096720414*^9, 3.711351097879508*^9}, {3.711351142786591*^9, 
   3.711351149690009*^9}, {3.71135165012432*^9, 3.7113517618246613`*^9}, {
   3.711351807638751*^9, 3.711351807997736*^9}, {3.711351924888888*^9, 
   3.7113519252556667`*^9}, {3.7113520302707577`*^9, 
   3.7113520307623262`*^9}, {3.711356773817848*^9, 3.711356774243415*^9}, 
   3.711428363289537*^9, 3.7114285527900543`*^9}],

Cell[BoxData["3"], "Input",
 CellChangeTimes->{3.709732705384677*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["5.  Check the kinematics of Left and Right legs", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
  3.710040593968562*^9}, {3.7100407192719173`*^9, 3.71004074444101*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"limbL", "=", 
     RowBox[{"PNTSi", "[", 
      RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"limbR", "=", 
     RowBox[{"PNTSim", "[", 
      RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"bodyaxis", "=", 
     RowBox[{
      RowBox[{"limbL", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", 
      RowBox[{"limbL", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"bodyyaw", "=", 
     RowBox[{"VectorAngle", "[", 
      RowBox[{
       RowBox[{"bodyaxis", "*", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bodypitch", "=", 
     RowBox[{
      RowBox[{"Pi", "/", "2"}], "-", 
      RowBox[{"VectorAngle", "[", 
       RowBox[{"bodyaxis", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListPointPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"limbL", ",", "limbR"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Large", "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"bodypitch", ",", "bodyyaw"}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Line", "[", "limbL", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"Line", "[", "limbR", "]"}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Dashed", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
        "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
    ",", 
   RowBox[{"{", 
    RowBox[{"fr", ",", "1", ",", "nsamples", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.70973170643396*^9, 3.7097317754060087`*^9}, {
   3.709731813150983*^9, 3.709731814596349*^9}, {3.709739539545582*^9, 
   3.709739540425173*^9}, {3.709741254476334*^9, 3.709741267964609*^9}, 
   3.709741501507394*^9, {3.709880010392693*^9, 3.709880033358514*^9}, {
   3.70996907969254*^9, 3.709969109002698*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
6.  Load sim data for conditions.  Select runs to gather, then load for L and \
R legs\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
  3.710040593968562*^9}, {3.7100407522967653`*^9, 3.710040752832938*^9}, {
  3.710040822594124*^9, 3.7100408276873493`*^9}, {3.710042782021922*^9, 
  3.7100428102999687`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getFiles", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<00\>\"", ",", "\"\<40\>\"", ",", "\"\<11\>\""}], "}"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "now"}], ",", " ", 
    RowBox[{
    "only", " ", "pick", " ", "two", " ", "conditions", " ", "to", " ", 
     "compare", " ", "for", " ", "graphs", " ", "below"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"00", " ", "is", " ", "nominal"}], ",", " ", 
    RowBox[{"no", " ", 
     RowBox[{"turning", ".", " ", "10"}], " ", "is", " ", "pitch", " ", 
     "level", " ", "1", " ", 
     RowBox[{"(", "horizontal", ")"}], " ", "no", " ", "turn"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"COND", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<00\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<10\>\"", ",", "\"\<20\>\"", ",", "\"\<30\>\"", ",", 
        "\"\<40\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<11\>\"", ",", "\"\<21\>\"", ",", "\"\<31\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<12\>\"", ",", "\"\<22\>\""}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "SetDirectory", "[", 
    "\"\</Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/simData\>\"\
", "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pitchCond", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.52"}], ",", 
       RowBox[{"-", "0.023"}], ",", "0.478", ",", "0.978"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.52"}], ",", 
       RowBox[{"-", "0.023"}], ",", "0.475"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.457"}], ",", 
       RowBox[{"-", "0.025"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yawCond", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.4998", ",", "0.4998", ",", "0.537"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.998", ",", "1.01"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conditionIndices", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "COND", "]"}], ",", 
         RowBox[{"getFiles", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "getFiles", "]"}]}], "}"}]}], "]"}], "//", 
     "Flatten"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loadFilesL", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"filePrefixL", "=", "\"\<slerpPNTSL_\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"number", "=", 
       RowBox[{"IntegerString", "[", 
        RowBox[{
         RowBox[{"conditionIndices", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "10", ",", "2"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"suffix", "=", "\"\<.dat\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"filenameL", "=", 
       RowBox[{"filePrefixL", "<>", "number", "<>", "suffix"}]}], ";", 
      "\[IndentingNewLine]", "filenameL"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "conditionIndices", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"loadFilesR", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"filePrefixR", "=", "\"\<slerpPNTSR_\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"number", "=", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"conditionIndices", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "10", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"suffix", "=", "\"\<.dat\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameR", "=", 
      RowBox[{"filePrefixR", "<>", "number", "<>", "suffix"}]}], ";", 
     "\[IndentingNewLine]", "filenameR"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "conditionIndices", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.710040939600769*^9, 3.7100410102780046`*^9}, {
   3.7100417682015038`*^9, 3.710041916213284*^9}, {3.7100419463901577`*^9, 
   3.710041991621825*^9}, {3.7100427367854013`*^9, 3.7100427798726807`*^9}, 
   3.710043450229808*^9, 3.710043646351865*^9, 3.710043704198268*^9, {
   3.7100456161188917`*^9, 3.710045617668429*^9}, {3.7100460826111603`*^9, 
   3.7100460843136168`*^9}, {3.710046254120596*^9, 3.710046256462078*^9}, 
   3.710046912600462*^9, {3.710141380528899*^9, 3.710141383144928*^9}, {
   3.710146585544903*^9, 3.710146585614895*^9}, 3.710154299908823*^9, 
   3.7102359698467283`*^9, {3.710236092317573*^9, 3.710236112328209*^9}, {
   3.71135711906072*^9, 3.711357124826778*^9}, {3.711428882090145*^9, 
   3.7114288945927973`*^9}, {3.71542429346268*^9, 3.715424316332242*^9}, {
   3.715485363333908*^9, 3.7154853933469563`*^9}, {3.715485429060131*^9, 
   3.715485450553906*^9}, {3.715488293699017*^9, 3.7154882976401978`*^9}, {
   3.7154884731451197`*^9, 3.715488473317214*^9}, {3.715488515702242*^9, 
   3.715488515764024*^9}, 3.715488571332625*^9, {3.7154886766519623`*^9, 
   3.71548868167163*^9}, 3.7161020877248363`*^9, 3.716202727743391*^9, 
   3.716203062474534*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"slerpPNTSL_01.dat\"\>", ",", "\<\"slerpPNTSL_05.dat\"\>", 
   ",", "\<\"slerpPNTSL_06.dat\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.710041836461567*^9, 3.7100419290785646`*^9, 3.7100419924968653`*^9, 
   3.710042798142174*^9, 3.7100434591012278`*^9, 3.710043648530182*^9, 
   3.710043706145638*^9, 3.710044364434209*^9, 3.710045622440703*^9, {
   3.7100460850529118`*^9, 3.710046086581643*^9}, 3.710046257299919*^9, 
   3.710046913150661*^9, 3.710141383695936*^9, 3.710146585964377*^9, 
   3.710154301119289*^9, {3.7102359593540173`*^9, 3.710235977181156*^9}, 
   3.710236114764698*^9, 3.7113484646335907`*^9, {3.711356803849114*^9, 
   3.711356805513973*^9}, 3.711357125982903*^9, 3.7113672057054653`*^9, 
   3.711379709038534*^9, 3.7114287795542803`*^9, 3.714718674950438*^9, 
   3.714799688168412*^9, 3.71488015712171*^9, 3.7149651117117977`*^9, 
   3.714969615295064*^9, 3.7149697683620043`*^9, 3.715056504894321*^9, 
   3.715403644704811*^9, 3.715424317545866*^9, 3.715484239312806*^9, {
   3.715485453457961*^9, 3.715485455251896*^9}, 3.715488299137164*^9, 
   3.715488401247525*^9, 3.715488473790204*^9, {3.715488516653384*^9, 
   3.7154885185645723`*^9}, 3.715488571608437*^9, 3.7154886823079157`*^9, 
   3.715503883281135*^9, 3.715503926684742*^9, 3.71550463382053*^9, 
   3.715504781590763*^9, 3.715504888994562*^9, 3.7155086108654413`*^9, 
   3.7155103420940037`*^9, 3.715513124614583*^9, 3.716089010672394*^9, {
   3.716102087895626*^9, 3.716102090078422*^9}, 3.716102602130557*^9, 
   3.71617672435226*^9, 3.7161976742945213`*^9, 3.716202728321949*^9, 
   3.71620306258195*^9, 3.716222262018387*^9, 3.716263478357663*^9, 
   3.7165257058016*^9, 3.716612064173175*^9, 3.716639967917223*^9, 
   3.718517913149206*^9, 3.718539092423427*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"slerpPNTSR_01.dat\"\>", ",", "\<\"slerpPNTSR_05.dat\"\>", 
   ",", "\<\"slerpPNTSR_06.dat\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.710041836461567*^9, 3.7100419290785646`*^9, 3.7100419924968653`*^9, 
   3.710042798142174*^9, 3.7100434591012278`*^9, 3.710043648530182*^9, 
   3.710043706145638*^9, 3.710044364434209*^9, 3.710045622440703*^9, {
   3.7100460850529118`*^9, 3.710046086581643*^9}, 3.710046257299919*^9, 
   3.710046913150661*^9, 3.710141383695936*^9, 3.710146585964377*^9, 
   3.710154301119289*^9, {3.7102359593540173`*^9, 3.710235977181156*^9}, 
   3.710236114764698*^9, 3.7113484646335907`*^9, {3.711356803849114*^9, 
   3.711356805513973*^9}, 3.711357125982903*^9, 3.7113672057054653`*^9, 
   3.711379709038534*^9, 3.7114287795542803`*^9, 3.714718674950438*^9, 
   3.714799688168412*^9, 3.71488015712171*^9, 3.7149651117117977`*^9, 
   3.714969615295064*^9, 3.7149697683620043`*^9, 3.715056504894321*^9, 
   3.715403644704811*^9, 3.715424317545866*^9, 3.715484239312806*^9, {
   3.715485453457961*^9, 3.715485455251896*^9}, 3.715488299137164*^9, 
   3.715488401247525*^9, 3.715488473790204*^9, {3.715488516653384*^9, 
   3.7154885185645723`*^9}, 3.715488571608437*^9, 3.7154886823079157`*^9, 
   3.715503883281135*^9, 3.715503926684742*^9, 3.71550463382053*^9, 
   3.715504781590763*^9, 3.715504888994562*^9, 3.7155086108654413`*^9, 
   3.7155103420940037`*^9, 3.715513124614583*^9, 3.716089010672394*^9, {
   3.716102087895626*^9, 3.716102090078422*^9}, 3.716102602130557*^9, 
   3.71617672435226*^9, 3.7161976742945213`*^9, 3.716202728321949*^9, 
   3.71620306258195*^9, 3.716222262018387*^9, 3.716263478357663*^9, 
   3.7165257058016*^9, 3.716612064173175*^9, 3.716639967917223*^9, 
   3.718517913149206*^9, 3.7185390924293747`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
7.  Make plots using theta and phi polar angles for limb segments for each of \
the conditions selected above.  Note: currently only 2 conditions are \
supported by graphs, can be modified later\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
  3.710040593968562*^9}, {3.7100407522967653`*^9, 3.710040752832938*^9}, {
  3.710040822594124*^9, 3.7100408276873493`*^9}, {3.710042782021922*^9, 
  3.7100428102999687`*^9}, {3.711428813014496*^9, 3.711428871895347*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"theDATAL", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiDATAL", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"theDATAR", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiDATAR", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quatsi", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limbIinit", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"run", "=", "itr2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fileL", "=", 
       RowBox[{"loadFilesL", "[", 
        RowBox[{"[", "run", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fileR", "=", 
       RowBox[{"loadFilesR", "[", 
        RowBox[{"[", "run", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSiLraw", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"fileL", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSiRraw", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"fileR", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nsamples", "=", 
       RowBox[{"Length", "[", "PNTSiLraw", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PNTSiL", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"PNTSiLraw", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSiR", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"PNTSiRraw", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phifemLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thefemRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phifemRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"thetibLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitibLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thetibRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitibRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"thetarLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitarLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thetarRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitarRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phipftLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thepftRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phipftRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"timeReldata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"nsamples", "-", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fr", "=", "itr"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"limbL", "=", 
          RowBox[{"PNTSiL", "[", 
           RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"limbR", "=", 
          RowBox[{"PNTSiR", "[", 
           RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"limbR", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "limbR"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"vbodL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vfemL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtibL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtarL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vpftL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"limbRm", "=", "limbR"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"stickPlot", "=", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPointPlot3D", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"BoxRatios", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"limbL", ",", "limbRm"}], "}"}], "]"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"vbodR", "=", 
          RowBox[{
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"vfemR", "=", 
          RowBox[{
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtibR", "=", 
          RowBox[{
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtarR", "=", 
          RowBox[{
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "-", 
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vpftR", "=", 
          RowBox[{
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "-", 
           RowBox[{"limbRm", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"t1L", "=", "0"}], ";", 
         RowBox[{"t2L", "=", "1.0"}], ";", 
         RowBox[{"t3L", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"theta", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"p1L", "=", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "/", "2"}]}], ";", 
         RowBox[{"p2L", "=", 
          RowBox[{"-", "1."}]}], ";", 
         RowBox[{"p3L", "=", "0"}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"phi", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"order", " ", "is", " ", "r"}], ",", " ", "phi", ",", " ", 
           "theta"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thefemL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thefemR", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemR", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemR", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemR", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"<", 
           RowBox[{
            RowBox[{"--", "note"}], " ", "negatives", " ", "for", " ", 
            "knee"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"thetibL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibL", "=", 
          RowBox[{
           RowBox[{"-", "p1L"}], "-", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thetibR", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibR", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibR", "=", 
          RowBox[{
           RowBox[{"-", "p1L"}], "-", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibR", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetarL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thetarR", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarR", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarR", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarR", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thepftL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thepftR", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftR", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftR", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftR", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thefemLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thefemLdata", ",", 
            RowBox[{"{", "thefemL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phifemLdata", ",", 
            RowBox[{"{", "phifemL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thefemRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thefemRdata", ",", 
            RowBox[{"{", 
             RowBox[{"-", "thefemR"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phifemRdata", ",", 
            RowBox[{"{", "phifemR", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetibLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetibLdata", ",", 
            RowBox[{"{", "thetibL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitibLdata", ",", 
            RowBox[{"{", "phitibL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thetibRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetibRdata", ",", 
            RowBox[{"{", "thetibR", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitibRdata", ",", 
            RowBox[{"{", "phitibR", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetarLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetarLdata", ",", 
            RowBox[{"{", "thetarL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitarLdata", ",", 
            RowBox[{"{", "phitarL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thetarRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetarRdata", ",", 
            RowBox[{"{", 
             RowBox[{"-", "thetarR"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitarRdata", ",", 
            RowBox[{"{", "phitarR", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thepftLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thepftLdata", ",", 
            RowBox[{"{", "thepftL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phipftLdata", ",", 
            RowBox[{"{", "phipftL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"thepftRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thepftRdata", ",", 
            RowBox[{"{", "thepftR", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftRdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phipftRdata", ",", 
            RowBox[{"{", "phipftR", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"status", "=", 
          RowBox[{"{", 
           RowBox[{"fileL", ",", "fileR", ",", "itr2", ",", "itr"}], "}"}]}], 
         ";"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"PrintTemporary", "[", "stickPlot", "]"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"itr", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thefemLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phifemLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phifemLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thefemRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thefemRdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phifemRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phifemRdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetibLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thetibLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phitibLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetibRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thetibRdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phitibRdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetarLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thetarLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phitarLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetarRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thetarRdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phitarRdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thepftLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phipftLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thepftRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "thepftRdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftRdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"unwrapPhase", "@", "phipftRdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thefemLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetibLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thetibLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetarLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thetarLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thepftLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thepftLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"phifemLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phifemLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phitibLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phitarLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phipftLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thefemRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetibRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thetibRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetarRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thetarRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thepftRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "thepftRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"phifemRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phifemRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phitibRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phitarRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftRdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"timeReldata", ",", "phipftRdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"theDATAL", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"theDATAL", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
           "thefemLdataXY", ",", "thetibLdataXY", ",", "thetarLdataXY", ",", 
            "thepftLdataXY"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phiDATAL", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"phiDATAL", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
           "phifemLdataXY", ",", "phitibLdataXY", ",", "phitarLdataXY", ",", 
            "phipftLdataXY"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"theDATAR", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"theDATAR", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
           "thefemRdataXY", ",", "thetibRdataXY", ",", "thetarRdataXY", ",", 
            "thepftRdataXY"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phiDATAR", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"phiDATAR", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
           "phifemRdataXY", ",", "phitibRdataXY", ",", "phitarRdataXY", ",", 
            "phipftRdataXY"}], "}"}], "}"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"itr2", ",", "1", ",", 
       RowBox[{"Length", "[", "conditionIndices", "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colorsmod", "=", "colors"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorsmod", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "=", "Transparent"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stylemod", "=", "style"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stylemod", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "=", 
     RowBox[{"FontSize", "\[Rule]", "40"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"size", "=", "800"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dashthickness", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles1", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.007", "]"}], ",", "colorsmod"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles2", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", "0.02", "]"}], ",", 
        RowBox[{"Thickness", "[", "dashthickness", "]"}], ",", "colorsmod"}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles3", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.001", ",", "0.02", ",", "0.02"}], "}"}], "]"}], ",", 
        RowBox[{"Thickness", "[", "dashthickness", "]"}], ",", "colorsmod"}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles5", "=", 
     RowBox[{"{", 
      RowBox[{"Black", ",", "Dashed"}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pA", "=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"theDATAL", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles1"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "rangeTheta"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "stylemod"}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"theDATAL", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"theDATAL", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles3"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "180"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "180"}], "}"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles5"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pC", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"phiDATAL", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles1"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "rangePhi"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "stylemod"}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"phiDATAL", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "rangePhi"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"phiDATAL", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles3"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pB", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"theDATAR", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles1"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "rangeTheta"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "stylemod"}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"theDATAR", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"theDATAR", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles3"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "180"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "180"}], "}"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles5"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pD", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"phiDATAR", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles1"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "rangePhi"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "stylemod"}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"phiDATAR", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "rangePhi"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"phiDATAR", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles3"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<left column: left leg; top row: retraction; bottom: adduction; \
solid: cond 1; dashed:cond2; dot-dashed:cond3\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pA", ",", "pB"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pC", ",", "pD"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.709974703009994*^9, 3.709974846491468*^9}, {
   3.7099749343710546`*^9, 3.70997500254033*^9}, {3.709975322715515*^9, 
   3.709975384345084*^9}, {3.7099754725197887`*^9, 3.7099754783989077`*^9}, {
   3.709975524867689*^9, 3.709975525980247*^9}, {3.709977871928288*^9, 
   3.709977972091627*^9}, {3.709978052929699*^9, 3.709978082810339*^9}, 
   3.709978114774563*^9, {3.709979027948262*^9, 3.709979144407653*^9}, {
   3.709979177595983*^9, 3.709979250773287*^9}, {3.70997934449542*^9, 
   3.709979372102192*^9}, 3.7099794022068863`*^9, {3.709979594436015*^9, 
   3.709979729516824*^9}, {3.709979995067721*^9, 3.7099800365774*^9}, {
   3.709980073803444*^9, 3.709980222004298*^9}, {3.709980254599595*^9, 
   3.7099802913007507`*^9}, {3.709980540806302*^9, 3.70998056042968*^9}, {
   3.7099806056578093`*^9, 3.709980689269796*^9}, {3.7099807565572853`*^9, 
   3.709980759388626*^9}, {3.709981034934717*^9, 3.709981075242939*^9}, {
   3.709981491099619*^9, 3.709981498777947*^9}, {3.7100405767500963`*^9, 
   3.710040577670363*^9}, {3.71004086366254*^9, 3.710040896563327*^9}, {
   3.710042027485038*^9, 3.710042127328912*^9}, {3.710042167442222*^9, 
   3.7100422621370687`*^9}, {3.710042394640555*^9, 3.710042605653406*^9}, {
   3.710042651435513*^9, 3.7100426691488457`*^9}, 3.7100427025469437`*^9, {
   3.710042820881171*^9, 3.7100428386969023`*^9}, {3.710043038239313*^9, 
   3.710043179659463*^9}, {3.710043228843726*^9, 3.7100432455142508`*^9}, {
   3.710043793178011*^9, 3.710043795727901*^9}, 3.710045624400876*^9, {
   3.710046394041415*^9, 3.710046491382465*^9}, {3.7100465214750757`*^9, 
   3.710046698260365*^9}, {3.710046742641439*^9, 3.710046844216007*^9}, {
   3.710047064777679*^9, 3.71004710111974*^9}, {3.710047214726898*^9, 
   3.710047252045917*^9}, 3.710047317797131*^9, {3.7100479568903513`*^9, 
   3.710047959124342*^9}, {3.7100480881253138`*^9, 3.710048090914966*^9}, {
   3.710048198706153*^9, 3.710048227268169*^9}, {3.710048364332364*^9, 
   3.710048388323447*^9}, {3.7100486217712383`*^9, 3.710048623439765*^9}, {
   3.7100486754087887`*^9, 3.7100486842876883`*^9}, 3.7101312945890427`*^9, {
   3.710133298663246*^9, 3.7101333021096888`*^9}, 3.7101333778657312`*^9, {
   3.71013345039893*^9, 3.7101335476805763`*^9}, {3.710133674678453*^9, 
   3.710133719765921*^9}, {3.710133779318666*^9, 3.710133797812673*^9}, {
   3.710133888276339*^9, 3.7101339120546627`*^9}, 3.710134646437902*^9, 
   3.7101395938886414`*^9, {3.710139632083514*^9, 3.710139863057811*^9}, {
   3.710139923365398*^9, 3.71013994658121*^9}, {3.710140206921208*^9, 
   3.710140214991817*^9}, {3.710140305480001*^9, 3.710140307286551*^9}, {
   3.7101408890131598`*^9, 3.7101408899701633`*^9}, 3.710140926885313*^9, {
   3.710153821523069*^9, 3.710153831130107*^9}, {3.710153917038196*^9, 
   3.71015391944374*^9}, {3.71015478814992*^9, 3.7101548229193573`*^9}, 
   3.710154856502516*^9, {3.7101553649648*^9, 3.710155447621364*^9}, {
   3.711379793425867*^9, 3.711379794637842*^9}, 3.711428931344059*^9, {
   3.715423241135003*^9, 3.7154232530192013`*^9}, {3.715423286694292*^9, 
   3.715423312173862*^9}, {3.715484794835202*^9, 3.7154848945502663`*^9}, {
   3.71548493902148*^9, 3.715485043456019*^9}, {3.715487170283627*^9, 
   3.715487245892569*^9}, {3.715487346081194*^9, 3.715487445886763*^9}, {
   3.715487600671983*^9, 3.715487608228217*^9}, {3.715487685292489*^9, 
   3.715487775348003*^9}, {3.715487816402063*^9, 3.715487916766281*^9}, {
   3.715487978003601*^9, 3.715487998098872*^9}, {3.715508629321604*^9, 
   3.715508632812253*^9}, {3.715508829098105*^9, 3.7155089149234877`*^9}, 
   3.7155103568052263`*^9, {3.715510406774516*^9, 3.715510477139463*^9}, {
   3.715513142465321*^9, 3.7155131758190002`*^9}, {3.715513210276882*^9, 
   3.715513233357152*^9}, {3.715513295158341*^9, 3.715513297643134*^9}, {
   3.715513748174674*^9, 3.715513756775825*^9}, {3.7155137884559803`*^9, 
   3.7155138167731667`*^9}, {3.715513862924489*^9, 3.715513893380652*^9}, {
   3.71551395812626*^9, 3.715513977060482*^9}, 3.715514045064026*^9, {
   3.716102961177863*^9, 3.7161031896473618`*^9}, {3.7161032511951933`*^9, 
   3.716103303071685*^9}, 3.716174645545568*^9, 3.7161748214530563`*^9, {
   3.716175070782323*^9, 3.7161751502004538`*^9}, {3.716175212423286*^9, 
   3.716175212505431*^9}, {3.7161752493341312`*^9, 3.716175383728878*^9}, {
   3.7161754330512047`*^9, 3.716175436927174*^9}, {3.716175645437518*^9, 
   3.7161756819825077`*^9}, {3.716175736288072*^9, 3.716175794588931*^9}, {
   3.7161758265187902`*^9, 3.716175864430122*^9}, {3.716176070149754*^9, 
   3.716176092454464*^9}, {3.716176179431285*^9, 3.7161761957615433`*^9}, 
   3.716176257912586*^9, {3.7161763289864283`*^9, 3.716176351299925*^9}, {
   3.716203561629629*^9, 3.716203591860847*^9}, {3.71620368414725*^9, 
   3.71620368820932*^9}, {3.716203752299662*^9, 3.716203752705533*^9}, {
   3.7162038149455023`*^9, 3.716203820057727*^9}, {3.7162038587182426`*^9, 
   3.716203890011529*^9}, 3.71620392112778*^9, {3.716203996924375*^9, 
   3.716204008451099*^9}, {3.716204065876939*^9, 3.7162040785724154`*^9}}],

Cell[BoxData["\<\"left column: left leg; top row: retraction; bottom: \
adduction; solid: cond 1; dashed:cond2; dot-dashed:cond3\"\>"], "Print",
 CellChangeTimes->{{3.716203896931056*^9, 3.716203924689802*^9}, 
   3.716204000387536*^9, 3.716204080139463*^9, 3.7162222693045797`*^9, 
   3.716263481098496*^9, 3.71652572446362*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{InsetBox[
      GraphicsBox[{{{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.007], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPzb25Pzdd2c9BYv3BP26dV9tVBaeL3rGD8Xfbn
TnMbJce4OcQ5V/I+NT1ir7c6d9PNqTD5U/Z853fJbn3j5gCSnXL9gv1Sq4Qe
qTR3qPor9nq9uxP/sXk4OEMU2IvE/3vkecUDqv+WfXXI3NNclz0dwLIB9+wL
u8qF13N4Q817YM+z6ew2v2ofhxywhkf2s/Vu/WM28oOa/8Re+1vbruVSAQ4B
YIGn9vyPd9bucw+E2vfcPm6qZW35siAHM6Dpcc4v7Q9qOLzntAuB2v/K/sk1
pe0eYmEOUqeygUJv7NXX8sgUm0VA3fPOXmmnCeu5RVEOkND6YL9EPC7sR0Ss
AwApfI5n
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOrxC4cWMyV4aCxfuGetk+r7Ev0XKI/c8L4u+xn
6308WMKR4RDnXMn71PSIfV3Bu8XPWGHyp+w3ybz25WPKcADJTrl+wf6kC8e5
7X/Soeqv2GssrInf9jXdwRmiwL7wcbXK0zfpUP237HdeEnbSeJTuAJYNuGe/
q2pzet7VdKh5D+w9exJ2bTqW7pAD1vDIPrSCh/H/Vpj5T+wTb/uezl2c7hAA
Fnhq36zqKqfTD7PvuT33hMf/KivTHcyApsc5v7T/eUv694okmP2v7BO/Ja4U
9053kDqVDRR6Y6/CzM6vaQxzzzt7cbkCXXPpdAdIaH2w75c8F9LAnO4AAOX7
kJg=
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPdB9//2BTh4KCxfuGetk+r7GsZF16KS4Dxd9nL
HvG6IV7o4BDnXMn71PSIPfe0G5FfemHyp+z/zWu8xrPLwQEkO+X6BftwdgO3
ZT9g6q/Yh+zsv5ju6+jgDFFgr5cccm/RHkeo/lv2Yc91wnd4OzmAZQPu2efc
Z3uzltEZat4De92F4huFXzg75IA1PLK/U6Pxu4jHFWr+E/uS0mt6q5vcHALA
Ak/tYxsdFd9keEDte26/Ofzgs9R3Xg5mQNPjnF/aNz4Ir7wQ6we1/5X9grNT
e09OCXSQOpUNFHpj72oj8fbnxxCoe97ZTyoT3KyRHekACa0P9rk2j94xtsU5
AAC45ZQw
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOs9R1b6jVUD2isX7in7dMqe1Od5J6VXDD+Lntt
/snCH06qHIhzruR9anrEvnBC/E2baBWo/Cn7ZgbRw41blA+AZKdcv2AfJP6C
cf4ZJaj6K/abD2+baT5b8YAzRIF9t256VLqEAlT/LfsvYov8ZlXIHADLBtyz
/9jyomrtH3GoeQ/sXV8smxK7QuhADljDI/srB3O/+B7ggJr/xL6juDFY9OPn
/QFggaf2h779cgtmfWcPse+5faTlutbYMh4HM6Dpcc4v7WNXtbXsUZJ2gNj/
yr6k9dbRmoeqDlKnsoFCb+yPhj4417TVwAHinnf2wQIi5ukHLR0gofXBvmDq
0sMfalwdACiKmBw=
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[0.02], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMmh9tjHl91ddBYv3BP26dV9n6TFt7pvw3j77IX
92858+i5q0OccyXvU9Mj9vt7gr8x/YXJn7K/NZVL672MmwNIdsr1C/aNK657
NXu6QdVfsX9lbbilqsXNwRmiwL69bjp7/nk3qP5b9lYzTj+8qO3uAJYNuGe/
YEfNvfuz3KHmPbD3nXLuR5esh0MOWMMjewcBzcLILR5Q85/Ym/O+KjOJ93QI
AAs8tb9yOkBFTtYLat9z+wyVwLb9r70czICmxzm/tPd0Xnhk0zFvqP2v7BMv
Lq8PXebjIHUqGyj0xn5FJqvHgVpfqHve2Qvqn9gjb+7nAAmtD/ZRKXN2vljj
5wAAFBOTuA==
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPC+19t9WPPcNBYv3BP26dV9homNf62bDD+LvuV
55bYvGHOcIhzruR9anrE/k3DO4Zv/9Oh8qfsX5+R+fPvZ7oDSHbK9Qv2xo+b
rbZ+TIeqv2J/cJ9yxoVn6Q7OEAX23DEsFwVvwvTfst/9YEGBy4l0B7BswD37
2b4neGy3wMx7YK9tZOV/a066Qw5YwyP7Se3zDrE0wcx/Yp+ir9GwLjndIQAs
8NSeycjD9JIjzL7n9pfuGb8okEl3MAOaHuf80r66PSmn93Ma1P5X9p0boiYq
H09zkDqVDRR6Y1+kZK4lPj0N6p539pXnclYLJac5QELrg72ZoNN0B600BwDD
N5Hd
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMn5v5e/ULMwUFj/cI9bZ9W2a8sXKn/F87fZd8b
/KRBU9zBIc65kvep6RH7oxKtXSXiMPlT9tc32fA/BvJBslOuX7A/+jJ9Z6kE
TP0Ve2lnrwxVSQcHZ4gC+z7tCV/uSML037Jn22i6MV/KwQEsG3DPvky1RLtH
CmbeA/uqtytUVgPV54A1PLJn1hcv/i0GM/+JfcbfDDcfQQeHALDAU/vT39u/
fGeD2ffc3uR27sdFr+0dzICmxzm/tO9LVJfX3mYPtf+V/UaxXxm70uwdpE5l
A4Xe2PPmzZgj/NUO6p539nx5i6LMw+0cIKH1wT6hOi9ufYOtAwCWA4xt
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMVZ+rXXZytekBj/cI9bZ9W2f9r/ism0Q3j77J/
uGqdwaU01QNxzpW8T02P2C9gU1l3QQMmf8p+rlz+37bTKgdAslOuX7B31J9i
ze+lAlV/xb6+3j7LZIHyAWeIAnv5qn+azaeUoPpv2a8Rji9NOqZ4ACwbcM/e
6uvhxyaTFKDmPbB/nhu+gSla7kAOWMMje66jxXn2RtJQ85/Y85mc0zq+TvxA
AFjgqf3855Z3K24IQ+17bh9o+TuKo5T/gBnQ9Djnl/bL/1hWzzzGBrX/lf36
DyK3Eif83i91Khso9Mb+3N5dzmqtj/ZD3PPO/vaevj2bOB7ZQ0Lrg32Tvv8n
o0e/7AEyHpvf
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQNn2B/1ncp1c9BYv3BP26dV9mejFZnOtcD4u+zP
/Pm47Mw2N4c450rep6ZH7OOOmCR38LhD5U/ZP11bc8ywz90BJDvl+gV7m5XX
eqc4e0DVX7Hf+U3yi5+Jp4MzRIG9lJixmWSGF1T/LXufy5od8s+9HcCyAffs
f9yKD8rd5Qs174G9FNuuUwlv/B1ywBoe2X+c28vV7hIINf+Jfc7R/Hjd80EO
AWCBp/bXN7EEbJ4bArXvuf3tXy63PbaHOZgBTY9zfmn/65lb4hKFSKj9r+yP
xRruXXkj2kHqVDZQ6I19Pdcmu0NX4qDueWff1bCFcd//BAdIaH2w/5lz7YHa
vCQHAH9glrk=
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPZXS/0L4hnOGisX7in7dMq+0+z25/Ok4Dxd9n7
NP+wjpfKcIhzruR9anrE3iZu3cFYWZj8KXvPitkF9xUzHECyU65fsPeZuuCl
ogZM/RX7s1sTj0YbZDg4QxTY/9+wS2avFUz/LXt5ywzfAvcMB7BswD171y1N
L2aFwcx7YG9f6dMfl5HhkAPW8Mi+O9Dc9WYNzPwn9p8E4gpVpmQ4BIAFntp7
xUU1Ba6D2ffcvl6/kz/5dIaDGdD0OOeX9uc+SKxxfA2z/5X9d3HxbWt4Mx2k
TmUDhd7Y37r4KUPTKBPqnnf2FxxXc3wNz3SAhNYH+9MCs28w1mU6AAA8BpFz

            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOxN2MnnvVycNBYv3BP26dV9hWHWYreBsD4u+xX
8ou8C4xzcIhzruR9anrEPkiynXVSKUz+lP2KQ8zv8mc6OIBkp1y/YN/Dsm+7
5FmY+iv2jg3GM9pFHB2cIQrs+XyP/uEvdYTqv2X/1V2xK+GbowNYNuCePaPv
XSb7JU5Q8x7Yb/9+pf7jRGeHHLCGR/aMFy4tKn3oAjX/iX1kj/jbwituDgFg
gaf2e+qnbtD56Qm177l92QWOFdc3+DuYAU2Pc35p/9vyG5/GyVCo/a/sWfbL
WuzSSHCQOpUNFHpjv0FxQ094ZgrUPe/sxadPO6JVn+YACa0P9q3KFc1is9Md
ADMokIo=
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQNnihjkLs5WPaCxfuGetk+r7DfsX6ci0Q3j77IX
v/Xy/eU01QNxzpW8T02P2F+fbGFxTQMmf8o+qcGhcfJplQMg2SnXL9jr/zNv
UPVSgaq/Yp/xREk4aIHyAWeIAnvPYyHx008pQfXfso/R+efqeEzxAFg24J69
pPCROxMmKkDNe2BvtsS3RzBC7kAOWMMje4vGq1cF9aSh5j+xX7LLoMl2nfiB
ALDAU3uvEPd3iu+EofY9t58e90A6QV7ggBnQ9Djnl/ZLEvKvitZyQu1/ZX/7
kfWktRPZDkidygYKvbGf/C+yQWifENQ97+wf/PCK3/fH4wAktD7YPzFU7P/s
mHIAAHLYmFA=
            "]]}}, {}}, {{}, {{}, {}, 
          {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[
           1.6], Dashing[{Small, Small}], 
           LineBox[{{0., 180.}, {1., 180.}}]}}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, 0},
       AxesStyle->{
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]], 
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]]},
       BaseStyle->{
        FontFamily -> "Ariel", FontSize -> 40, FontColor -> GrayLevel[0]},
       DisplayFunction->Identity,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImageSize->800,
       Method->{},
       PlotRange->{{0, 1.}, {-17.188733853924695`, 209.12959522275048`}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {0, 0}},
       Ticks->{Automatic, Automatic}], {426.6666666666667, -263.69450186662175`},
       ImageScaled[{0.5, 0.5}], {800, 494.4271909999158}], InsetBox[
      GraphicsBox[{{{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.007], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPstvd5N6m6OWisX7in7dMq+wznIzvkTWH8XfZC
BcvWbgtzc4hzruR9anrE/lSUiW7UBJj8KfukBKniK8/cHECyU65fsGd7cUyY
N94dqv6KPfcLzY5vf9wdnCEK7DNYq/dWHfWA6r9l72WSzyi+19MBLBtwz75i
T/A1/xdeUPMe2KdOTlXU8/dxyAFreGRfMLX69vbfvlDzn9g/2cPb7vzb3yEA
LPDU/ky8ztbJOoFQ+57bv3y+3kdvapCDGdD0OOeX9t+duGzcXUOg9r+yfxe4
pVXKLcxB6lQ2UOiNvc3F45KpMyKg7nln/+XCT3tfnWgHSGh9sDfr0lSyehDr
AABc8o6J
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQO1Oy59uXQ9xUFj/cI9bZ9W2fvLaFf8uQLj77J/
1WJ1+v65FIc450rep6ZH7H/zT1/ddwQmf8q+THR5b8vWFAeQ7JTrF+yvHGXX
TF8IU3/F/o+Y6MzKjhQHZ4gC+61zzK6qZsP037KfFcZ9vscrxQEsG3DPvtrb
onupBsy8B/bxYVl7ndhTHHLAGh7Z7zH/uVjoZTLU/Cf2Hyen3b58IdkhACzw
1J61l4n798FkqH3P7dUb/mhmH0h2MAOaHuf80t7Bhyc/5nwy1P5X9pujf0tl
fkp2kDqVDRR6Y+/Z+dL3ii7MPe/snaf3TRdpT3GAhNYHe/uP1h07WVMdAGqs
lUk=
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMNn+ZM38/h4KCxfuGetk+r7H2F93Zys8P4u+xT
b65sT2R2cIhzruR9anrEvp151UvFX/ZQ+VP2TBMshTY/s3cAyU65fsF+7kvT
/kOn7KHqr9i7znPR5llq7+AMUWCvJeGt/KkEpv+WveUuGzkPG3sHsGzAPfv9
t125fzPBzHtgz7p8XsXu63YOOWANj+yrjDke3L9lBzX/ib1p+Nvq+472DgFg
gaf2i0OWyM83coDa99y+IKDKxabf0cEMaHqc80v7ALsurVnLXKD2v7K3mrl+
auVUbwepU9lAoTf232oe5AadC4G65539xVIuwbfisQ6Q0Ppgbx5gcmbO3wQH
AAM9jZo=
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQO9ndssn75Vc9BYv3BP26dV9g/+HYhfwqoO5e+y
3y/LV91roe4Q51zJ+9T0iL3zOZHZf3th8qfslbm1nvzg0HAAyU65fsGe1ZNp
msFqDaj6K/a3rm7YPzVf08EZosD+WNmXBRYBWlD9t+yzpcMaTey1HcCyAffs
g+IlWR4o60DNe2Bf7xYQxfVCxyEHrOGRfff0C4qqGbpQ85/Y5+rmM7+r03UI
AAs8tZ//6Nux6B86UPue28fe9A5VadF2MAOaHuf80v5m+20Wv0MaUPtf2fuy
Fmx/IqDiIHUqGyj0xl5b8aG8l54E1D3v7FmPzT0mFvttv9S7iIKdl9/b6zku
uhNgYHgAAK5Oj9o=
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[0.02], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPrtqtPOHPe1UFj/cI9bZ9W2YccdrT/dAXG32W/
uvX052f3XR3inCt5n5oesRcySf2b/Rkmf8reZufhPxn8bg4g2SnXL9hPN9u9
v8bUDar+iv2VDzKZrSluDs4QBfZCqlt3is9xg+q/Zf/zzIxGqTtuDmDZgHv2
ExbGSO1WcYea98Bev6+m9n6Fu0MOWMMj+6VzX9r9u+AONf+JvcKrjNmHdT0c
AsACT+3nmYjed57jAbXvuX1geVhEgLKngxnQ9Djnl/b7ywLf/jzlCbX/lf1f
BfGVrPO9HKROZQOF3tizFx5sO7DaG+qed/YHf8RsXPnXxwESWh/suQ+uMy6b
4+cAADjQlqw=
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQNnb2n3+L9OcdBYv3BP26dV9o9vTD/v/QrG32Wv
Xd0mc+pFikOccyXvU9Mj9sZ/mdzfPoXJn7L34Etl7XyU4gCSnXL9gv2CiV+n
S92Dqb9ibzld87zvzRQHZ4gC+z7XResXXoHpv2XPc/ya9NILKQ5g2YB79vt7
Z5vNOwcz74H9FvGE0wznUxxywBoe2ec73s79ewlm/hP7ypMWk57dTXEIAAs8
tc/wF/wU9AFm33P7dUEHA55wpzqYAU2Pc35pf2yy2bIE41So/a/sGf7u8lmZ
leogdSobKPTGvoz/ovTX7alQ97yzD2n7dGGCapoDJLQ+2O951Hd91sk0BwDO
FJqi
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQO6Rn072x7bO2isX7in7dMqe7eHrAyHb8D4u+yL
4n7OmXvE3iHOuZL3qekRe/6TzksvLYTJn7JXfte3wKXA3gEkO+X6BftVst3L
d2nD1F+xl+KLtllyyc7BGaLAfrpi7KYVyXZQ/bfsl/ayejPcs3UAywbcs99e
4fg4wc0Wat4D+03f/ePmzbNxyAFreGTPXzE9K+22NdT8J/aPGmoOmQhZOwSA
BZ7azz4QYbM+2gpq33P7LctDeW+dtHQwA5oe5/zSfkHjtjVdZZZQ+1/Zu/0/
vjqu0dJB6lQ2UOiNPZvDGkc2Hiuoe97Zl58KesVlae0ACa0P9pHPJ6qstbV1
AADNZY+1
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQP705edEctWc9BYv3BP26dV9sLvP08WqILxd9mL
njc9ZD1BzSHOuZL3qekR++5sg8ebd8LkT9nfTs96mftazQEkO+X6BfuUUydu
6eiqQ9VfsV9t3qX3v0zdwRmiwJ55wsf5fIfVofpv2ftwW/Gc49JwAMsG3LO/
Ns1o/hFLDah5D+wzLFJ+63lpOOSANTyy17zb8Y7fXANq/hP7VesiZhgCzQsA
Czy1L3m68uL2y2pQ+57ba2qfKe/3VnUwA5oe5/zSvlf9k4jpfyWo/a/su57t
1VOrlHeQOpUNFHpj38BXdfFdjxjUPe/smRU+zP5tz+oACa0P9hr+KWuzpb/t
BwBm2Y/9
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMB27ieftN3c9BYv3BP26dV9vEJV02aHWH8XfY2
x/qMd6S7OcQ5V/I+NT1iL/33mKnkSpj8KXtVKTOefZzuDiDZKdcv2C+cKPGp
tM8dqv6KPROD9TJmKw8HZ4gCe439lmpXhT2h+m/Zyz5oz7aV9XIAywbcs9+e
7P9fKMkbat4De5k5bs+fvvRxyAFreGSvsf2DT/BhP6j5T+xfxH6y/lcX4BAA
FnhqP9mUc/OHK4FQ+57b83zekboqM9jBDGh6nPNL+4WWMtZL7EKh9r+yn13g
zyDjH+4gdSobKPTGnvHPwzVPJ0ZC3fPOPiExtHsuT4wDJLQ+2J/3arCJtYx3
AABsWoys
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOLf2lYvX6d4qCxfuGetk+r7NuCn+lkw/m77GX4
ykNTX6U4xDlX8j41PWLvYsh68MELmPwp+5XWWy9GP09xAMlOuX7BPvT/o221
z2Dqr9iL28zgrgPKO0MU2G8ydl0eBTf/lr14UcYO1S8pDmDZgHv2e4J9Zosx
p0LNe2B/9uX3e9ZSqQ45YA2P7DsYfvnbWadCzX9i/2HZLJlv6akOAWCBp/a8
H5faei1Khdr33L7jf3+/w5tUBzOg6XHOL+23WxwwVPdIg9r/yv6BJP8x1p1p
DlKnsoFCb+w7Pm/ReuqcDnXPO/tHPkXTDL+kO0BC64N95l6nxv6vGQ4AdnmW
eA==
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMHXU7kvlpp76CxfuGetk+r7Oey/siYOgfG32Xf
v+tD6rd6e4c450rep6ZH7K1m9+/o9IfJn7JndDN/pcRm7wCSnXL9gv3u+xrc
NxfYQdVfsWcxig2Ql7VzcIYosD+eJedb0WAL1X/L/va6rP6gizYOYNmAe/a9
wtts2/RsoOY9sD9uEb5N6by1Qw5YwyN7y7craw+a2UDNf2Kvx6ZR57nGziEA
LPDUvmOLDBfTXGeofc/tzzj9+7O6NtDBDGh6nPNL+7W+NxUSjsZD7X9lf85l
yy27VUkOUqeygUJv7KPS8yNlo5Kh7nlnXzzvlrdVWrIDJLQ+2O9r9FHKUkh2
AAAVr45t
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOX5i36fO+juoPG+oV72j6tst/7/Yn+RlUNKH+X
/cOLBv+4pmk4xDlX8j41PWLP3NJhyxGmCZU/Ze/xeULm9lItB5DslOsX7B+c
yrr2h0kHqv6K/QP1ssT7bHoOzhAF9o8jZtlfdzGA6r9l/7J2d5jiEUMHsGzA
Pfuwldl+HxqNoeY9sH/1xszftcrUIQes4ZF93LK3hevXmkPNf2Jv1FPsW6ls
5RAAFnhqv+WHobLbNxuofc/tj91//bjTysHBDGh6nPNLe2fNo0tfXXaC2v/K
XvdZhHABv6eD1KlsoNAb+xtKF1LKrJKg7nlnb1C+/7rn+gwHSGh9sOfXT9K9
dCbTAQCEhZTJ
            "]]}}, {}}, {{}, {{}, {}, 
          {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[
           1.6], Dashing[{Small, Small}], 
           LineBox[{{0., 180.}, {1., 180.}}]}}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, 0},
       AxesStyle->{
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]], 
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]]},
       BaseStyle->{
        FontFamily -> "Ariel", FontSize -> 40, FontColor -> GrayLevel[0]},
       DisplayFunction->Identity,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImageSize->800,
       Method->{},
       PlotRange->{{0, 1.}, {-17.188733853924695`, 209.12959522275048`}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {0, 0}},
       Ticks->{Automatic, Automatic}], {1280., -263.69450186662175`}, 
      ImageScaled[{0.5, 0.5}], {800, 494.4271909999158}]}, {InsetBox[
      GraphicsBox[{{{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.007], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMrmBRePl+jdUBj/cI9bZ9W2aeq7/UqfArj77IX
XaAt8SNe+0CccyXvU9Mj9o+mK7crGepA5U/Zswinz1TP1j0Akp1y/YL9R8tH
8xfL6kPVX7FfNfcg69pVBgecIQrs+1Uvnf/EawTVf8veNjuze8Vu4wNg2YB7
9rYng8NObDGFmvfAflfJ0ikvv5sfyAFreGR/T3dV4fkGK6j5T+wN41+2XnO3
PRAAFnhq/y99sctcBQeofc/ti+PuPRRf53jADGh6nPNL+3V1ypNfOzhD7X9l
//CrhqvkKZcDUqeygUJv7K+dW8B60MwN6p539r9fcbKVFLgfgITWB/urGc0y
9+M8DgAAdy2cRA==
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPLDc4o7Tr/d7/G+oV72j6tss86Jv37Lut/KH+X
vdbqxWWOlxkOxDlX8j41PWKfGKokZizEfAAif8r+vqdjr1cx2wGQ7JTrF+x5
pVzFlFW4oeqv2P+I/bVebJnAAWeIAnvXLXLvlNtEoPpv2V+Jin4maC95ACwb
cM8+PWqf0o6bclDzHtiv/Bp0yGit0oEcsIZH9q/FnTUUEtSg5j+x//OF39en
SetAAFjgqX1Ob0mNPK8+1L7n9ieXh/rY/TY8YAY0Pc75pb3/QuNO3xkmUPtf
2ffKSGtzhZofkDqVDRR6Y79tly6HrLoV1D3v7AP/vpJ/zGR7ABJaH+wPBSrM
ZL5jfwAACsiS5w==
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOLU68b8Ym7HdBYv3BP26dV9hO3hST/VYLxd9nb
ztfbcsfG7UCccyXvU9Mj9k3bxaP4MmHyp+yvCYf6Vq52OwCSnXL9gn2b+Eyj
NnZ3qPor9i+aF/pJN7gfcIYosE9xi2meIe4B1X/LfsqxeItL5z0OgGUD7tln
276341jlCTXvgX1o5NncS8u8DuSANTyy/9Dn0vHtqDfU/Cf20UsP2/Kz+R4I
AAs8tf9zjXPplWQ/qH3P7Z3/eGxddsP/gBnQ9Djnl/auu6+mn10dALX/lf2B
ZadW3UoOPCB1Khso9Ma+XjejletvINQ97+x5ZFcqbQgIOgAJrQ/2F4+oZ8w2
CjoAABJAmq4=
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOrrTZuvJD/fb/G+oV72j6tsrexDurLkPwF5e+y
f+EtVX7s/v/9cc6VvE9Nj9h7zBd22H6f5QBE/pS93ZyHv9768hwAyU65fsF+
2VXxSf/8hQ9A1F+xP7499MIicakDzhAF9nlRP9ZEBilC9d+ylxRNuaHbo3YA
LBtwz946usrd8rgO1LwH9krr5K1K2Y0O5IA1PLK/utNjup6ZGdT8J/YXpleX
mH+2OhAAFnhqv8u6NDxNwQFq33P7C5nN0Zf5nQ+YAU2Pc35p//qx9iledzeo
/a/sy/4d1vpzyPOA1KlsoNAb+9ceF95mVvtC3fPOXqMrz1Z4bcABSGh9sLd5
Nj9uUnfQAQBFeZwi
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[0.02], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMWKft7dX5oHdBYv3BP26dV9lUTnzolWGpD+bvs
f+9cFnb8mPaBOOdK3qemR+ynf/X/ULlDByp/yj7k7fR6ERW9AyDZKdcv2DOI
JE4J5zOAqr9iPzFQzyA50vCAM0SBfcfJ9/e5fxlB9d+yNxI2Fdzx1eQAWDbg
nv2tpaVFJgHmUPMe2Oe8nLmqk9vqQA5YwyP7H5cDo06q20LNf2Kf9415dmag
w4EAsMBT+4Uskls4bZyg9j23n173ZpVsgMsBM6Dpcc4v7Re/5yup6nCD2v/K
XmOTxT23ex4HpE5lA4Xe2CtYSZac8PCGuuedff8e4/2Se30PQELrg/1Puzdl
N8UCDgAA/LqZGA==
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPhzyZ/ZZrDdEBj/cI9bZ9W2Scu32x/ehEzlL/L
3up51fR9d1gPxDlX8j41PWJ/wKVNRXU1J1T+lH1xuuCmulT+AyDZKdcv2Bsv
KS04skYYqv6K/S2+3119TyUOOEMU2PNWxTT+qZSH6r9l383wgPX2AeUDYNmA
e/blMTJNle0aUPMe2B9JvpknKa53IAes4ZH9y9s9PZWWRlDzn9h76WQcbj5r
eiAALPDUfqf+lnffj1pC7XtuH9dWdCRC3u6AGdD0OOeX9syWmm3qWY5Q+1/Z
1z77u+niO+cDUqeygUJv7HtkvP8ozXSDuuedfc/9Kbabkj0PQELrg/2ExQfl
gzx8DgAA79CbZQ==
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOCOQxJO066HtBYv3BP26dV9gaOnPWPz8D4u+xj
jvQKHr7seiDOuZL3qekRe3eDsJkt92Hyp+w3eZevsPzoegAkO+X6BXtF0aDz
tzjdoOqv2C9jUynw0XI74AxRYP9VZc+6tGA3qP5b9m8SKxwY29wOgGUD7tnn
LCysZz7sBjXvgX3V+qcVFdzuB3LAGh7ZXzx2ddPSBHeo+U/sFxaXSigdcT8Q
ABZ4as+WJ//5hbkH1L7n9qXeB+yT93kcMAOaHuf80v777oq8hChPqP2v7Muy
qhy+83kdkDqVDRR6Y1++7O9+j/teUPe8szfeqBusdM77ACS0Pth3fz59p/Wu
zwEA/6qa3w==
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQN537bc5ld+tl9j/cI9bZ9W2WsssOt/uOwFlL/L
nil+tkKk9Lv9cc6VvE9Nj9jH2v6Z2bP9M1T+lP0XzjdzVu35tR8kO+X6BXvR
+x/1FtkxHYCov2K/tmv579DlHAecIQrs2a2fWzPECxyA6L9lH/op1vlioOgB
sGzAPfvQ86sUtllJH4Aof2A/bd3XhmxhxQM5YA2P7GMePWqwEVSFmv/E/kCE
6PyTczQPBIAFntpvqw3ZoL1HD2rfc3t9sazCx1ZGB8yApsc5v7SXS3kYo5Zh
CrX/lf3e+2yTrV9aHJA6lQ0UemMvzF62yuCgDdQ97+x3fb45U7LS4QAktD7Y
8+kw7szc53QAAFOPmzo=
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMXJxlGF7/ROqCxfuGetk+r7BW3iz3i0tGG8nfZ
c56SrTiwVftAnHMl71PTI/azBLtLahboQOVP2ct2R6xkZdA7AJKdcv2CvcKZ
xTUTn+hD1V+xn7yLmUdY1/CAM0SBfVLOx3OPNhtB9d+y35bzO0G93eQAWDbg
nv2VI++n1i42g5r3wH6XZszZDQyWB3LAGh7Zv5PtKCuaYA01/4m96qG5C47Z
2B0IAAs8te9X8F2mWOwAte+5fUMIW5LrRscDZkDT45xf2hsnx036vdcJav8r
+57CzVdEqpwPSJ3KBgq9sb8R//n89qPOUPe8sz8R9mrCkjbnA5DQ+mCftvqK
ueJ6pwMA7/qazQ==
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPvrS9p5HT+3K+xfuGetk+r7P+xub+IcP4F5e+y
VxSdMWPBtd/745wreZ+aHrHXE3loI9/xDyp/yn7SLZYfF7wYD4Bkp1y/YP95
+cPiA1IsByDqr9ivfd/VffkU+wFniAL7sPVbDT/m8ByA6L9lf3eDeU0wm+AB
sGzAPfu3fJtmrA8TgZr3wP6hivFcfhWJAzlgDY/sK56c6q9IkYGa/8S+c2cJ
s0CzwoEAsMBT++V2GzPUvitB7Xtuz2ijVR1To3rADGh6nPNLexb7DSdf/VaH
2v/K3pN5sbZ2tNYBqVPZQKE39o94Ai9q1+pA3fPOfnXjvWsyrnoHIKH1wV5R
xt+veqb+AQAM+Jlt
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMti6RVjoW7HdBYv3BP26dV9k4HGeMFsmH8XfZB
f3xnPJnidiDOuZL3qekRe17v/qyEOzD5U/b/1Ff+f+TufgAkO+X6BfsP5n3M
PHfdoeqv2PNoTOXbucDjgDNEgX39ro7VTNM9ofpv2VfFS2ibHfY6AJYNuGfP
zsO0/Yi6D9S8B/ZluhfuihzzPZAD1vDIfseWeS1s8/yh5j+x1/JWOxxwLeBA
AFjgqb3Xt4xTEl8CofY9t09bZ3uuQjL4gBnQ9Djnl/Z6WxmOyQiHQO1/ZT9N
VUT1j3vIAalT2UChN/ZadXMPMAUGQ93zzt7+eufG7RsDD0BC64N9/6KLyR+a
/Q8AAAONl5I=
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPC8YcyCh/+26+xfuGetk+r7D/OV8jfZMh4AMLf
Zf/3/ZOflf9ZDsQ5V/I+NT1ir2ibv9atgRsqf8r+RZib680lQgdAslOuX7AX
7Go70VAgCVV/xf5rz03Zm3qKB5whCux/R+l3zzmvBtV/y/4QW6qX5QbdA2DZ
gHv2lccN5Uo+GkHNe2BfWzhncdxu8wM5YA2P7JmWnpz539oWav4Te4sZFRtk
9zgeCAALPLUvjJx2/JmlK9S+5/bXr1sfmyPhecAMaHqc80t7T2uuF9sjfKH2
v7J/t/xO6Zo/AQekTmUDhd7Y3zmXG327Khjqnnf26qImUQE/Qg9AQuuD/bLm
r8y/ngYfAACHh5/p
            "]]}}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, -96.91581104637875},
       AxesStyle->{
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]], 
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]]},
       BaseStyle->{
        FontFamily -> "Ariel", FontSize -> 40, FontColor -> GrayLevel[0]},
       DisplayFunction->Identity,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImageSize->800,
       Method->{},
       PlotRange->{{0, 1.}, {0., -97.40282517223994}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {0, 0}},
       Ticks->{Automatic, Automatic}], {426.6666666666667, -791.0835055998652},
       ImageScaled[{0.5, 0.5}], {800, 494.4271909999158}], InsetBox[
      GraphicsBox[{{{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.007], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQPBtxynTbmvdUBj/cI9bZ9W2X8MyHBMlNGG8nfZ
vzebeXvVAu0Dcc6VvE9Nj9g/47mi8LlFByp/yt6O+wp3/xPdAyDZKdcv2E99
XWN8+oY+VP0V+1mZunk9doYHnCEK7O89PPd06icjqP5b9glGE+vjBUwPgGUD
7tnvrOf9VDvHHGreA3vD3+z2FhOsDuSANTyy5zFbx73zvi3U/Cf2cd4q77p2
OhwIAAs8tY9nP9i0eKoT1L7n9s955r5/VuhywAxoepzzS/uTSaLnrhu7Qe1/
ZX+01itHe7f7AalT2UChN/Y2jx5vXPjEA+qed/aFTdODtSZ6HoCE1gf7rUsW
uiRt8DwAAGRxncQ=
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQO/S4wObYj/sV9j/cI9bZ9W2f/5enDWg+Mw/i77
hU1+8mlLfu6Pc67kfWp6xP5L4aQpE8V+Q+VP2WfIlny8kfl3P0h2yvUL9nek
fLY+TGU4AFF/xT7O5H7w5atMB5whCuzX21+0WajIdgCi/5a9ctWJkNYergNg
2YB79pPPpL4/4i5wAKL8gf37w3YrXfVEDuSANTyyn6WgOfuNjiTU/Cf2zG9t
DRfGyx8IAAs8tZ8W5nnGsU0Zat9z+41ynre/mWscMAOaHuf80l76bF3o6+26
UPtf2R/5kFkZ+8fwgNSpbKDQG/uQFp11hcWmUPe8s1+7T6Wq2NLyACS0Pthv
FKm999HD9gAA9SSgJQ==
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.007], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQNSJ1fGLK11O6CxfuGetk+r7GVfmGfVToXxd9nv
Tgm+eveE24E450rep6ZH7Ccv1xXZKO8OlT9l3xoaoTpnvvsBkOyU6xfs14VU
7mnz8YCqv2K/XTCQpVnd84AzRIF9/MKZBToGXlD9t+xzHrM9PJTsfQAsG3DP
PuK3rrTBPh+oeQ/sN7YmPJlr7XcgB6zhkf2f2VanlW74Q81/Yr/2zKRnB44F
HAgACzy1f+oVHbZ8eSDUvuf2eapTLv3pDjpgBjQ9zvml/Vzb0i7OvGCo/a/s
b4q8ZrczDzkgdSobKPTGvvWy0CWTpSFQ97yzL9rZVfgoOOQAJLQ+2G9tPMMe
GRp8AADi7Jvl
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQNtIprT9Db+2a+xfuGetk+r7BlsxQX2vfwP5e+y
t7FstGbMYz4Q51zJ+9T0iP3+pstl/f6cByDyp+zVdrT687IKHgDJTrl+wV76
hHPF+29iUPVX7NNaPvcUTJM74AxRYP9RbfuvP1+Vofpv2S9STTXlqdY8AJYN
uGfv9ac+vu2OPtS8B/ZBl9bx2fUYH8gBa3hkvznjcIrFXHOo+U/sJQ+biWor
2RwIAAs8tVdaFtZ4sMsBat9z+66f/1vmeDofMAOaHuf80v65WcG9yBg3qP2v
7OVTP0UEn/I8IHUqGyj0xv645jSh2um+UPe8s9/uNdW/827AAUhofbCXka66
8f530AEAmdOZeA==
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[0.02], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQM3LWoXBUhpH9BYv3BP26dV9lsD/ST54mH8XfZp
LSEFe75oH4hzruR9anrEXujI6VnTPupA5U/ZM+i+OfuiWO8ASHbK9Qv2xxNb
LDe4G0DVX7E/LGf6g3G94QFniAL7XS0f3nRXGEP137Jf5LfmAPNK0wNg2YB7
9nO+cAUdcLGAmvfA3nRyMl+om/WBHLCGR/Z98yfJNS61g5r/xP7NpOJrO3Qd
DwSABZ7ar2uvfVGn7wy177m9syOnXl2A6wEzoOlxzi/tb4hznHrX7g61/5X9
0QUvdSNOex6QOpUNFHpj/9TvpMQvHh+oe97ZS0ivduW19jsACa0P9neyegWT
ZAMOAAAOU5iQ
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQM5no/qz01iPKCxfuGetk+r7DkyD2g/iGeC8nfZ
d0U3Ts80ZjkQ51zJ+9T0iP15+XdPPNTZofKn7E/LlnbZ7uU+AJKdcv2C/TnN
XCtWRkGo+iv29Q4FB4X1RA84QxTYd/2ZWPGwRQqq/5b9J5cJk7z7FA6AZQPu
2SuvCr35eKoK1LwH9nIuUe0CwZoHcsAaHtmLX/UUK/2kBzX/if2yiMLORfeM
DgSABZ7av22PbWY6bQa177l9pfr8m2LW1gfMgKbHOb+0rzbp0LERd4Da/8o+
5KvCsdXnnA5IncoGCr2xv/hI7tCv/a5Q97yzL2r8mG3zxOMAJLQ+2G88kPPA
0sznAABsypgd
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], Dashing[0.02], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQMSxz6Vff3hekBj/cI9bZ9W2WcVc3wKZHaD8nfZ
z7A0zYkTdzsQ51zJ+9T0iL1A4GMbXSuY/Cl7q5ceT1Sz3Q6AZKdcv2D/uzEp
Tm4tTP0Vey5lOQHh/24HnCEK7NmC33q+i3eH6r9lz3mc+/Oms+4HwLIB9+z1
ow2etrh5QM17YJ9x/5u/1XGPAzlgDY/s+63W9R919oSa/8Re7BzDDbsdngcC
wAJP7Rd+XnzgrLYX1L7n9tL+D3LT53gdMAOaHuf80t7KvIbbjtMbav8r+zuL
F/fnl3gfkDqVDRR6Y1/tfDtD6JE31D3v7Bn4bKKPRfocgITWB3t35kRN8Wc+
BwD+KJVv
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQNySqf2TXF4vV9j/cI9bZ9W2a98bMe+ovYdlL/L
/syJ82a+iz/tj3Ou5H1qesT+Yc+h1fsSf0DlT9lbzHz+ZUk2wwGQ7JTrF+wF
tvrzpGmxHYCov2IftWLKR4F23gPOEAX2/CkS65+7Ch+A6L9lH6Xx6an5dIkD
YNmAe/abpx31mH9aDmreA3uVstTp1x4rHcgBa3hkz9V59BHDdDWo+U/sV83+
/GnzQq0DAWCBp/Z9q6LD9Q30ofY9tw9YoNp4UtnogBnQ9Djnl/YdF0Tcav6Z
QO1/ZS9la1Fx2dLigNSpbKDQG/ui/QKcPe+soe55Z3/TxSOaSd7hACS0PtiX
uJXzLFnvdAAA6KibQw==
            "]]}}, {}}, {{}, {{}, {}, 
          {RGBColor[0., 0., 0.], PointSize[0.016666666666666666`], Thickness[
           0.01], Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQObPoroMzNqH9BYv3BP26dV9qUr9nUedYTxd9l/
OpVRZ39O+0CccyXvU9Mj9ov0lGf92acDlT9lb3jEg/eWjt4BkOyU6xfs/x65
fHammAFU/RX7rN60fIkswwPOEAX2j6tSJreLGkP137J30T+qpSVregAsG3DP
3uZSee/VSnOoeQ/s36kkPD4ub3UgB6zhkf2qSafP8ny3gZr/xH7NwaQ7Pnft
DwSABZ7aBwreZsgNcoTa99w+WmKTkXm30wEzoOlxzi/tMzmrZLyqnaH2v7K/
7L9i00QOlwNSp7KBQm/s+fm+tqmouEDd885+48FMz/IrzgcgofXB/nxzY7ea
qfMBAJHhl58=
            "]]}, 
          {RGBColor[
           0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQM3GV44vpT6sl9j/cI9bZ9W2VcluIbNYoXxd9mv
/7VfRejK5/1xzpW8T02P2F+uuHlof9NnqPwp+61HJGP/BH/eD5Kdcv2CPZv3
00WramDqr9hfutScKD7py35niAL73syYVeF7vkH137LvalgX52n6ez9YNuCe
/TG3+FutvIwHIMof2Pe2ht8xNGE7kAPW8Mj+Zp7coQQz3gMQ85/Yn2rvXB8o
L3wgACzw1P5qio3h/k0SByD2PbdfrG9dpxcnf8AMaHqc80v7WbFxH2RnKh+A
2P/Kvkhp1fRNBhoHpE5lA4Xe2LvrOVbX7tI9AHHPO/sbclpTLeqMDkBC64O9
XiKr2p1SiwMAYvKc7A==
            "]]}, 
          {RGBColor[
           0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
           PointSize[0.016666666666666666`], Thickness[0.01], 
           Dashing[{0.001, 0.02, 0.02}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQOTPiyQsNngdkBj/cI9bZ9W2X95J7rm4TkYf5f9
Rbuny40F3Q/EOVfyPjU9Yv+yUaP3cKM7VP6U/fI5Tw2D1D0OgGSnXL9gzx1n
fiqT3ROq/oq9zSbJRB5lrwPOEAX2Gb83rHKp9Ybqv2XflXD9yn1+3wNg2YB7
9p91lHmu3/GDmvfAPvQv1/eY/IADOWANj+y9XCV3ynQFQs1/Yr/gkoPr/t1B
BwLAAk/tX1wNcp3zIxhq33P70EouC7M/IQfMgKbHOb+054z4ou2+MQRq/yv7
F6x/uP+qBh+QOpUNFHpjf6Q/90GddCDUPe/sr7a7bS528T0ACa0P9pMTBQKf
vnQ7AADW25wa
            "]]}, 
          {Hue[0.37820393249936934`, 0.6, 0.6], Opacity[0], 
           LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQM/V1yzLjRhPqCxfuGetk+r7Fk3/35qX84K5e+y
d3qVErE/hutAnHMl71PTI/arumf+FY8QhMqfst+k5573o178AEh2yvUL9i+r
jtdqP5aHqr9iX5l89ouvn+oBZ4gCeyX9PR4TX2tD9d+yd7/1NNHuvuEBsGzA
PXueh49kYvPNoOY9sDcq0NIXXWF9IAes4ZG9YO7mjudnHKDmP7G/sPpk2Qsd
lwMBYIGn9m53GQ6VMnlA7Xtub3T83DbheJ8DZkDT45xf2n+6d1tn8aoAqP2v
7BepSG86XRJ8QOpUNlDojX3agdDls6xDoe55Z7/vjGiY2f7AA5DQ+mA/defb
q2V/PQ4AAJvCndc=
            "]]}}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, -96.91581104637875},
       AxesStyle->{
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]], 
         Directive[
          GrayLevel[0], 
          AbsoluteThickness[1.]]},
       BaseStyle->{
        FontFamily -> "Ariel", FontSize -> 40, FontColor -> GrayLevel[0]},
       DisplayFunction->Identity,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImageSize->800,
       Method->{},
       PlotRange->{{0, 1.}, {0., -97.40282517223994}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {0, 0}},
       Ticks->{Automatic, Automatic}], {1280., -791.0835055998652}, 
      ImageScaled[{0.5, 0.5}], {800, 494.4271909999158}]}}, {}},
  ContentSelectable->True,
  ImageSize->800,
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{
  3.7162036082329073`*^9, 3.716203642564434*^9, 3.716203698618745*^9, 
   3.716203736558876*^9, {3.716203790598484*^9, 3.716203823810412*^9}, {
   3.716203896985798*^9, 3.7162039247611437`*^9}, 3.716204000462248*^9, 
   3.716204080217556*^9, 3.71622226938319*^9, 3.7162634811919394`*^9, 
   3.716525724552553*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "save", " ", "figures", " ", "as", " ", "well", " ", "as", " ", 
    "information", " ", "on", " ", "notebook", " ", "used", " ", "to", " ", 
    "make", " ", "the", " ", "figs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nbname", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NotebookFileName", "[", "]"}], "//", "FileNameSplit"}], 
       ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"info", "=", 
     RowBox[{"\"\<Figures created by \>\"", "<>", "nbname"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "[", "setpathfigpanel", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<polarAngles_RETL.gif\>\"", ",", "pA", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<polarAngles_RETR.gif\>\"", ",", "pB", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<polarAngles_ADDL.gif\>\"", ",", "pC", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<polarAngles_ADDR.gif\>\"", ",", "pD", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<polarAngles_info.txt\>\"", ",", "info"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ResetDirectory", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.709974703009994*^9, 3.709974846491468*^9}, {
   3.7099749343710546`*^9, 3.70997500254033*^9}, {3.709975322715515*^9, 
   3.709975384345084*^9}, {3.7099754725197887`*^9, 3.7099754783989077`*^9}, {
   3.709975524867689*^9, 3.709975525980247*^9}, {3.709977871928288*^9, 
   3.709977972091627*^9}, {3.709978052929699*^9, 3.709978082810339*^9}, 
   3.709978114774563*^9, {3.709979027948262*^9, 3.709979144407653*^9}, {
   3.709979177595983*^9, 3.709979250773287*^9}, {3.70997934449542*^9, 
   3.709979372102192*^9}, 3.7099794022068863`*^9, {3.709979594436015*^9, 
   3.709979729516824*^9}, {3.709979995067721*^9, 3.7099800365774*^9}, {
   3.709980073803444*^9, 3.709980222004298*^9}, {3.709980254599595*^9, 
   3.7099802913007507`*^9}, {3.709980540806302*^9, 3.70998056042968*^9}, {
   3.7099806056578093`*^9, 3.709980689269796*^9}, {3.7099807565572853`*^9, 
   3.709980759388626*^9}, {3.709981034934717*^9, 3.709981075242939*^9}, {
   3.709981491099619*^9, 3.709981498777947*^9}, {3.7100405767500963`*^9, 
   3.710040577670363*^9}, {3.71004086366254*^9, 3.710040896563327*^9}, {
   3.710042027485038*^9, 3.710042127328912*^9}, {3.710042167442222*^9, 
   3.7100422621370687`*^9}, {3.710042394640555*^9, 3.710042605653406*^9}, {
   3.710042651435513*^9, 3.7100426691488457`*^9}, 3.7100427025469437`*^9, {
   3.710042820881171*^9, 3.7100428386969023`*^9}, {3.710043038239313*^9, 
   3.710043179659463*^9}, {3.710043228843726*^9, 3.7100432455142508`*^9}, {
   3.710043793178011*^9, 3.710043795727901*^9}, 3.710045624400876*^9, {
   3.710046394041415*^9, 3.710046491382465*^9}, {3.7100465214750757`*^9, 
   3.710046698260365*^9}, {3.710046742641439*^9, 3.710046844216007*^9}, {
   3.710047064777679*^9, 3.71004710111974*^9}, {3.710047214726898*^9, 
   3.710047252045917*^9}, 3.710047317797131*^9, {3.7100479568903513`*^9, 
   3.710047959124342*^9}, {3.7100480881253138`*^9, 3.710048090914966*^9}, {
   3.710048198706153*^9, 3.710048227268169*^9}, {3.710048364332364*^9, 
   3.710048388323447*^9}, {3.7100486217712383`*^9, 3.710048623439765*^9}, {
   3.7100486754087887`*^9, 3.7100486842876883`*^9}, 3.7101312945890427`*^9, {
   3.710133298663246*^9, 3.7101333021096888`*^9}, 3.7101333778657312`*^9, {
   3.71013345039893*^9, 3.7101335476805763`*^9}, {3.710133674678453*^9, 
   3.710133719765921*^9}, {3.710133779318666*^9, 3.710133797812673*^9}, {
   3.710133888276339*^9, 3.7101339120546627`*^9}, 3.710134646437902*^9, 
   3.7101395938886414`*^9, {3.710139632083514*^9, 3.710139863057811*^9}, {
   3.710139923365398*^9, 3.71013994658121*^9}, {3.710140206921208*^9, 
   3.710140214991817*^9}, {3.710140305480001*^9, 3.710140307286551*^9}, {
   3.7101408890131598`*^9, 3.7101408899701633`*^9}, 3.710140926885313*^9, {
   3.710153821523069*^9, 3.710153831130107*^9}, {3.710153917038196*^9, 
   3.71015391944374*^9}, {3.71015478814992*^9, 3.7101548229193573`*^9}, 
   3.710154856502516*^9, {3.7101553649648*^9, 3.710155447621364*^9}, {
   3.711379793425867*^9, 3.711379794637842*^9}, 3.711428931344059*^9, {
   3.715423241135003*^9, 3.7154232530192013`*^9}, {3.715423286694292*^9, 
   3.715423312173862*^9}, {3.715484794835202*^9, 3.7154848945502663`*^9}, {
   3.71548493902148*^9, 3.715485043456019*^9}, {3.715487170283627*^9, 
   3.715487245892569*^9}, {3.715487346081194*^9, 3.715487445886763*^9}, {
   3.715487600671983*^9, 3.715487608228217*^9}, {3.715487685292489*^9, 
   3.715487775348003*^9}, {3.715487816402063*^9, 3.715487916766281*^9}, {
   3.715487978003601*^9, 3.715487998098872*^9}, {3.715508629321604*^9, 
   3.715508794193776*^9}}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
figs/panels\"\>"], "Output",
 CellChangeTimes->{
  3.715508799321581*^9, 3.715508847562469*^9, {3.715508889754014*^9, 
   3.7155089190002317`*^9}, {3.7155104566369333`*^9, 3.715510481173895*^9}, 
   3.715514052889347*^9, 3.716176209198124*^9, 3.716176264017115*^9, 
   3.716176370309473*^9, 3.716525741227119*^9}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
simData\"\>"], "Output",
 CellChangeTimes->{
  3.715508799321581*^9, 3.715508847562469*^9, {3.715508889754014*^9, 
   3.7155089190002317`*^9}, {3.7155104566369333`*^9, 3.715510481173895*^9}, 
   3.715514052889347*^9, 3.716176209198124*^9, 3.716176264017115*^9, 
   3.716176370309473*^9, 3.716525742111644*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7154876573092403`*^9, 3.7154876788966093`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
8.  Pick a specific run (from those loaded) and interactively view kinematics \
R&L legs.\[LineSeparator]\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
   3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
   3.710040593968562*^9}, {3.7100407522967653`*^9, 3.710040752832938*^9}, {
   3.710040822594124*^9, 3.7100408276873493`*^9}, {3.710042782021922*^9, 
   3.7100428102999687`*^9}, {3.711428813014496*^9, 3.711428871895347*^9}, {
   3.7114289446153173`*^9, 3.711428974068613*^9}, 3.716197679706822*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"run", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fileL", "=", 
       RowBox[{"loadFilesL", "[", 
        RowBox[{"[", "run", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fileR", "=", 
       RowBox[{"loadFilesR", "[", 
        RowBox[{"[", "run", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSiLraw", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"fileL", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSiRraw", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"fileR", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nsamples", "=", 
       RowBox[{"Length", "[", "PNTSiLraw", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PNTSiL", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"PNTSiLraw", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PNTSiR", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"PNTSiRraw", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"limbL", "=", 
       RowBox[{"PNTSiL", "[", 
        RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limbR", "=", 
       RowBox[{"PNTSiR", "[", 
        RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limbR", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "limbR"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "mirror", " ", "the", " ", "Right", " ", "limb", " ", "just", " ", 
        "to", " ", "calculate", " ", "angles", " ", "similar", " ", "to", " ",
         "how", " ", "it", " ", "was", " ", "done", " ", "on", " ", "left"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"limbRm", "=", 
       RowBox[{"limbMirror", "[", 
        RowBox[{"limbR", ",", 
         RowBox[{
          RowBox[{"limbR", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"limbR", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"0", "*", 
          RowBox[{"limbIinit", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbRm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
           RowBox[{"limbIinit", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbRm", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vfemL", "=", 
       RowBox[{
        RowBox[{"limbL", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", 
        RowBox[{"limbL", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vtibL", "=", 
       RowBox[{
        RowBox[{"limbL", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", 
        RowBox[{"limbL", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vtarL", "=", 
       RowBox[{
        RowBox[{"limbL", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "-", 
        RowBox[{"limbL", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vpftL", "=", 
       RowBox[{
        RowBox[{"limbL", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "-", 
        RowBox[{"limbL", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vfemR", "=", 
       RowBox[{
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", 
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vtibR", "=", 
       RowBox[{
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", 
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vtarR", "=", 
       RowBox[{
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "-", 
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vpftR", "=", 
       RowBox[{
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "-", 
        RowBox[{"limbRm", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"segVec", "=", "vtibL"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bodyaxis", "=", 
       RowBox[{
        RowBox[{"limbL", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"limbL", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bodyyaw", "=", 
       RowBox[{"VectorAngle", "[", 
        RowBox[{
         RowBox[{"bodyaxis", "*", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bodypitch", "=", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "-", 
        RowBox[{"VectorAngle", "[", 
         RowBox[{"bodyaxis", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"phi", ",", "theta"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "+", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
           RowBox[{
            RowBox[{"CoordinateTransform", "[", 
             RowBox[{
              RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
              "segVec"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], "}"}]}]}], ";"}], " ", 
       RowBox[{"(*", 
        RowBox[{"for", " ", "hip"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"phi", ",", "theta"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"N", "@", "Pi"}]}], "/", "2"}], ",", "0"}], "}"}], "+", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "*", 
         RowBox[{
          RowBox[{"CoordinateTransform", "[", 
           RowBox[{
            RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
            "segVec"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "/", "2"}]}], "}"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"for", " ", "knee"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"phi", ",", "theta"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "+", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
           RowBox[{
            RowBox[{"CoordinateTransform", "[", 
             RowBox[{
              RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
              "segVec"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], "}"}]}]}], ";"}], " ", 
       RowBox[{"(*", 
        RowBox[{"for", " ", "ankle"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"phi", ",", "theta"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "+", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
           RowBox[{
            RowBox[{"CoordinateTransform", "[", 
             RowBox[{
              RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
              "segVec"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], "}"}]}]}], ";"}], " ", 
       RowBox[{"(*", 
        RowBox[{"for", " ", "tmt"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"midframesQ", "=", 
       RowBox[{"fr", "\[Equal]", "1"}]}], 
      RowBox[{"(*", 
       RowBox[{"||", 
        RowBox[{"fr", "\[Equal]", "nsamples"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lineThickness", "=", 
       RowBox[{"If", "[", 
        RowBox[{"midframesQ", ",", "0.01", ",", "0.0005"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lineColorL", "=", 
       RowBox[{"If", "[", 
        RowBox[{"midframesQ", ",", "Black", ",", "Gray"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lineColorR", "=", 
       RowBox[{"If", "[", 
        RowBox[{"midframesQ", ",", 
         RowBox[{"colors", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "Pink"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lineColorR", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"run", "\[Equal]", "3"}], ",", "lineColorR", ",", 
         "Transparent"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "only", " ", "show", " ", "right", " ", "limb", " ", "on", " ", "turn",
         " ", "trial"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FR", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "3", "]"}], "*", "0.3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FR", "=", 
       RowBox[{"Riffle", "[", 
        RowBox[{"FR", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FR", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FR", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", ".5"}], ",", "0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "FR", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPointPlot3D", "[", 
         RowBox[{"limbL", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", "Large", "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"hippnt", "=", 
               RowBox[{"PNTSiL", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", "i"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"hippnt", "-", "1.1"}], ",", 
                RowBox[{"hippnt", "+", "1.1"}]}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"bodypitch", ",", "bodyyaw"}], "}"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
            "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ListPointPlot3D", "[", 
         RowBox[{"limbR", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Large", ",", "lineColorR"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"lineColorL", ",", 
           RowBox[{"Thickness", "\[Rule]", "lineThickness"}], ",", 
           RowBox[{"Line", "[", "limbL", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"lineColorR", ",", 
           RowBox[{"Thickness", "\[Rule]", "lineThickness"}], ",", 
           RowBox[{"Line", "[", "limbR", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Transparent", ",", 
           RowBox[{"Line", "[", "limbRm", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"FR", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"colors", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"FR", "[", 
             RowBox[{"[", 
              RowBox[{"4", ";;"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Transparent", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "segVec"}], 
             "}"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"fr", ",", "1", ",", "nsamples", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"for", " ", "selecting", " ", "view", " ", "point"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vp", "=", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"datasubset", ",", 
         RowBox[{"ViewPoint", "\[Rule]", "vp"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "5"}], ",", "10"}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewBack", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.13999999999999968`"}], ",", 
       RowBox[{"-", "5.`"}], ",", 
       RowBox[{"-", "0.1200000000000001`"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewTop", "=", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.21999999999999975`"}], ",", "10.`"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"view3d", "=", 
     RowBox[{"{", 
      RowBox[{"2.5`", ",", 
       RowBox[{"-", "3.02`"}], ",", "1.8600000000000003`"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewrt", "=", 
     RowBox[{"{", 
      RowBox[{"2.7199999999999998`", ",", "1.2199999999999998`", ",", "0.`"}],
       "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.710045850048087*^9, {3.710045910318499*^9, 3.7100459270005093`*^9}, 
   3.710045967351198*^9, 3.710047172142083*^9, {3.710049882702715*^9, 
   3.710049922956283*^9}, {3.710049973197917*^9, 3.71004997336654*^9}, {
   3.710131086747754*^9, 3.7101311482255497`*^9}, {3.710131805974725*^9, 
   3.710131865792611*^9}, {3.7101319240177383`*^9, 3.710131936559806*^9}, {
   3.710131981981881*^9, 3.710131999141171*^9}, {3.7101320321872873`*^9, 
   3.710132036042904*^9}, {3.710132069108654*^9, 3.710132131366488*^9}, {
   3.710132191114485*^9, 3.710132245141529*^9}, {3.710132275249407*^9, 
   3.710132385296558*^9}, {3.710132477236816*^9, 3.710132551753461*^9}, {
   3.7101328290084753`*^9, 3.710132860389792*^9}, {3.710132954741214*^9, 
   3.710132959051777*^9}, {3.710133075010722*^9, 3.7101331576392097`*^9}, {
   3.710133201723963*^9, 3.710133210645894*^9}, {3.710133579031473*^9, 
   3.710133590753744*^9}, {3.7101337629715014`*^9, 3.71013376317763*^9}, {
   3.710133804108437*^9, 3.710133843930575*^9}, {3.7101339224135017`*^9, 
   3.710133963916754*^9}, {3.710133995317543*^9, 3.710134053529413*^9}, {
   3.710134086984671*^9, 3.710134171913892*^9}, {3.710134230272661*^9, 
   3.7101342721240883`*^9}, {3.7101343023823833`*^9, 3.710134374061838*^9}, {
   3.710134410022377*^9, 3.7101345648560257`*^9}, {3.710134689694024*^9, 
   3.710134970316409*^9}, {3.710135018619657*^9, 3.710135022209503*^9}, {
   3.7101352472216587`*^9, 3.71013528374771*^9}, 3.7101353181397343`*^9, {
   3.710135365837895*^9, 3.7101353761647873`*^9}, {3.710135431942279*^9, 
   3.710135441597858*^9}, {3.710139304040416*^9, 3.710139356338216*^9}, {
   3.710139390246626*^9, 3.71013939957934*^9}, {3.710139437593668*^9, 
   3.710139519613201*^9}, {3.710140376099832*^9, 3.7101403783608227`*^9}, 
   3.710140500441324*^9, {3.710140722151918*^9, 3.710140786344571*^9}, {
   3.7101409735172987`*^9, 3.710141012045635*^9}, {3.710141051190213*^9, 
   3.710141055708662*^9}, {3.710141103845439*^9, 3.710141123676634*^9}, {
   3.710141165430005*^9, 3.71014119161156*^9}, {3.710141295805894*^9, 
   3.710141296171466*^9}, 3.710141543515283*^9, {3.7101416071848583`*^9, 
   3.710141614718896*^9}, {3.710141650826285*^9, 3.7101416509024467`*^9}, {
   3.710141986692687*^9, 3.710142052795342*^9}, {3.710235993158415*^9, 
   3.710236036488953*^9}, {3.710236133724947*^9, 3.710236133889398*^9}, 
   3.710236199531611*^9, 3.711358686101837*^9, 3.715424212870377*^9, {
   3.7154243458403807`*^9, 3.715424345885602*^9}, {3.715484636471447*^9, 
   3.7154846365685453`*^9}, 3.7154846671345797`*^9, 3.715485464972254*^9, {
   3.715485526271159*^9, 3.715485541514843*^9}, {3.715485579545397*^9, 
   3.715485686251017*^9}, {3.715489772436397*^9, 3.715489844962303*^9}, 
   3.715489875302108*^9, {3.715489913916572*^9, 3.7154899453677177`*^9}, {
   3.7154900132501163`*^9, 3.7154901036899967`*^9}, {3.7154913267663107`*^9, 
   3.7154915729856033`*^9}, 3.7154932999076433`*^9, {3.715493343661173*^9, 
   3.7154933731178923`*^9}, {3.715493477838057*^9, 3.7154934782493362`*^9}, {
   3.715493629856203*^9, 3.715493651606366*^9}, {3.715493711137229*^9, 
   3.7154937408735743`*^9}, {3.715494221345415*^9, 3.715494271892063*^9}, {
   3.715494356752675*^9, 3.715494365778426*^9}, {3.715494396402134*^9, 
   3.715494409223624*^9}, {3.715494521572362*^9, 3.715494538047421*^9}, 
   3.715495335737173*^9, {3.715495676352394*^9, 3.715495716373727*^9}, {
   3.715504606390458*^9, 3.715504610462002*^9}, 3.7155048005087967`*^9, 
   3.7160891131355457`*^9, {3.716089155285502*^9, 3.71608916627483*^9}, {
   3.716089264381671*^9, 3.716089339979426*^9}, {3.716089391777842*^9, 
   3.7160894091134777`*^9}, 3.7160894824263763`*^9, {3.716089543033409*^9, 
   3.716089543126183*^9}, 3.7161022230606823`*^9, 3.716102640078096*^9, 
   3.716102720539772*^9, 3.7161977255385637`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "Degree"}], " ", "0.281"}]], "Input",
 CellChangeTimes->{{3.716202821140729*^9, 3.71620286527247*^9}}],

Cell[BoxData["16.100114043176134`"], "Output",
 CellChangeTimes->{{3.716202830411237*^9, 3.716202865863937*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"animDATA", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"run", "=", "itr"}], ";", "\[IndentingNewLine]", 
        RowBox[{"fileL", "=", 
         RowBox[{"loadFilesL", "[", 
          RowBox[{"[", "run", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fileR", "=", 
         RowBox[{"loadFilesR", "[", 
          RowBox[{"[", "run", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"PNTSiLraw", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"fileL", ",", "\"\<Table\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PNTSiRraw", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"fileR", ",", "\"\<Table\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nsamples", "=", 
         RowBox[{"Length", "[", "PNTSiLraw", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PNTSiL", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"PNTSiLraw", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PNTSiR", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"PNTSiRraw", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"limbL", "=", 
         RowBox[{"PNTSiL", "[", 
          RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"limbR", "=", 
         RowBox[{"PNTSiR", "[", 
          RowBox[{"[", "fr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"limbR", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"limbL", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "limbR"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "mirror", " ", "the", " ", "Right", " ", "limb", " ", "just", " ", 
          "to", " ", "calculate", " ", "angles", " ", "similar", " ", "to", 
          " ", "how", " ", "it", " ", "was", " ", "done", " ", "on", " ", 
          "left"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"limbRm", "=", 
         RowBox[{"limbMirror", "[", 
          RowBox[{"limbR", ",", 
           RowBox[{
            RowBox[{"limbR", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"limbR", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"0", "*", 
            RowBox[{"limbIinit", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"limbRm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"limbRm", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}], "*", 
             RowBox[{"limbIinit", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "limbRm", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vfemL", "=", 
         RowBox[{
          RowBox[{"limbL", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vtibL", "=", 
         RowBox[{
          RowBox[{"limbL", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vtarL", "=", 
         RowBox[{
          RowBox[{"limbL", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "-", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vpftL", "=", 
         RowBox[{
          RowBox[{"limbL", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "-", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"vfemR", "=", 
         RowBox[{
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vtibR", "=", 
         RowBox[{
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vtarR", "=", 
         RowBox[{
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "-", 
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vpftR", "=", 
         RowBox[{
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "-", 
          RowBox[{"limbRm", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"segVec", "=", "vtibL"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bodyaxis", "=", 
         RowBox[{
          RowBox[{"limbL", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bodyyaw", "=", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{
           RowBox[{"bodyaxis", "*", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bodypitch", "=", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "-", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"bodyaxis", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"phi", ",", "theta"}], "}"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "@", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "+", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
             RowBox[{
              RowBox[{"CoordinateTransform", "[", 
               RowBox[{
                RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",",
                 "segVec"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], "}"}]}]}], ";"}], 
         " ", 
         RowBox[{"(*", 
          RowBox[{"for", " ", "hip"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"phi", ",", "theta"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"N", "@", "Pi"}]}], "/", "2"}], ",", "0"}], "}"}], "+", 
          
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "*", 
           RowBox[{
            RowBox[{"CoordinateTransform", "[", 
             RowBox[{
              RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
              "segVec"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"N", "@", "Pi"}], "/", "2"}]}], "}"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"for", " ", "knee"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"phi", ",", "theta"}], "}"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "@", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "+", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
             RowBox[{
              RowBox[{"CoordinateTransform", "[", 
               RowBox[{
                RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",",
                 "segVec"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], "}"}]}]}], ";"}], 
         " ", 
         RowBox[{"(*", 
          RowBox[{"for", " ", "ankle"}], "*)"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"phi", ",", "theta"}], "}"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "@", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "+", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
             RowBox[{
              RowBox[{"CoordinateTransform", "[", 
               RowBox[{
                RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",",
                 "segVec"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}]}], "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], "}"}]}]}], ";"}], 
         " ", 
         RowBox[{"(*", 
          RowBox[{"for", " ", "tmt"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"midframesQ", "=", 
         RowBox[{"fr", "\[Equal]", "1"}]}], 
        RowBox[{"(*", 
         RowBox[{"||", 
          RowBox[{"fr", "\[Equal]", "nsamples"}]}], "*)"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lineThickness", "=", 
         RowBox[{"If", "[", 
          RowBox[{"midframesQ", ",", "0.01", ",", "0.0005"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lineColorL", "=", 
         RowBox[{"If", "[", 
          RowBox[{"midframesQ", ",", "Black", ",", "Gray"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lineColorR", "=", 
         RowBox[{"If", "[", 
          RowBox[{"midframesQ", ",", 
           RowBox[{"colors", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Pink"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lineColorR", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"itr", "\[Equal]", "3"}], ",", "lineColorR", ",", 
           "Transparent"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "only", " ", "show", " ", "right", " ", "limb", " ", "on", " ", 
          "turn", " ", "trial"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"FR", "=", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "3", "]"}], "*", "0.3"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"FR", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"FR", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"FR", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FR", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".5"}], ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "FR", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPointPlot3D", "[", 
           RowBox[{"limbL", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", "Large", "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"hippnt", "=", 
                 RowBox[{"PNTSiL", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2", ",", "i"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"hippnt", "-", "1.1"}], ",", 
                  RowBox[{"hippnt", "+", "1.1"}]}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"BoxRatios", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPointPlot3D", "[", 
           RowBox[{"limbR", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Large", ",", "lineColorR"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"lineColorL", ",", 
             RowBox[{"Thickness", "\[Rule]", "lineThickness"}], ",", 
             RowBox[{"Line", "[", "limbL", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"lineColorR", ",", 
             RowBox[{"Thickness", "\[Rule]", "lineThickness"}], ",", 
             RowBox[{"Line", "[", "limbR", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Transparent", ",", 
             RowBox[{"Line", "[", "limbRm", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"FR", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], "}"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"colors", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"FR", "[", 
               RowBox[{"[", 
                RowBox[{"4", ";;"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Transparent", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "segVec"}], 
               "}"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"fr", ",", "1", ",", "nsamples"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"itr", ",", "1", ",", 
         RowBox[{"Length", "[", "getFiles", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"animDATA", "[", 
        RowBox[{"[", "fr", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"fr", ",", "1", ",", 
        RowBox[{"Length", "[", "animDATA", "]"}], ",", "1"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"for", " ", "selecting", " ", "view", " ", "point"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vp", "=", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"datasubset", ",", 
         RowBox[{"ViewPoint", "\[Rule]", "vp"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "5"}], ",", "10"}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewBack", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.13999999999999968`"}], ",", 
       RowBox[{"-", "5.`"}], ",", 
       RowBox[{"-", "0.1200000000000001`"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewTop", "=", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.21999999999999975`"}], ",", "10.`"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"view3d", "=", 
     RowBox[{"{", 
      RowBox[{"2.5`", ",", 
       RowBox[{"-", "3.02`"}], ",", "1.8600000000000003`"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewrt", "=", 
     RowBox[{"{", 
      RowBox[{"2.7199999999999998`", ",", "1.2199999999999998`", ",", "0.`"}],
       "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.710045850048087*^9, {3.710045910318499*^9, 3.7100459270005093`*^9}, 
   3.710045967351198*^9, 3.710047172142083*^9, {3.710049882702715*^9, 
   3.710049922956283*^9}, {3.710049973197917*^9, 3.71004997336654*^9}, {
   3.710131086747754*^9, 3.7101311482255497`*^9}, {3.710131805974725*^9, 
   3.710131865792611*^9}, {3.7101319240177383`*^9, 3.710131936559806*^9}, {
   3.710131981981881*^9, 3.710131999141171*^9}, {3.7101320321872873`*^9, 
   3.710132036042904*^9}, {3.710132069108654*^9, 3.710132131366488*^9}, {
   3.710132191114485*^9, 3.710132245141529*^9}, {3.710132275249407*^9, 
   3.710132385296558*^9}, {3.710132477236816*^9, 3.710132551753461*^9}, {
   3.7101328290084753`*^9, 3.710132860389792*^9}, {3.710132954741214*^9, 
   3.710132959051777*^9}, {3.710133075010722*^9, 3.7101331576392097`*^9}, {
   3.710133201723963*^9, 3.710133210645894*^9}, {3.710133579031473*^9, 
   3.710133590753744*^9}, {3.7101337629715014`*^9, 3.71013376317763*^9}, {
   3.710133804108437*^9, 3.710133843930575*^9}, {3.7101339224135017`*^9, 
   3.710133963916754*^9}, {3.710133995317543*^9, 3.710134053529413*^9}, {
   3.710134086984671*^9, 3.710134171913892*^9}, {3.710134230272661*^9, 
   3.7101342721240883`*^9}, {3.7101343023823833`*^9, 3.710134374061838*^9}, {
   3.710134410022377*^9, 3.7101345648560257`*^9}, {3.710134689694024*^9, 
   3.710134970316409*^9}, {3.710135018619657*^9, 3.710135022209503*^9}, {
   3.7101352472216587`*^9, 3.71013528374771*^9}, 3.7101353181397343`*^9, {
   3.710135365837895*^9, 3.7101353761647873`*^9}, {3.710135431942279*^9, 
   3.710135441597858*^9}, {3.710139304040416*^9, 3.710139356338216*^9}, {
   3.710139390246626*^9, 3.71013939957934*^9}, {3.710139437593668*^9, 
   3.710139519613201*^9}, {3.710140376099832*^9, 3.7101403783608227`*^9}, 
   3.710140500441324*^9, {3.710140722151918*^9, 3.710140786344571*^9}, {
   3.7101409735172987`*^9, 3.710141012045635*^9}, {3.710141051190213*^9, 
   3.710141055708662*^9}, {3.710141103845439*^9, 3.710141123676634*^9}, {
   3.710141165430005*^9, 3.71014119161156*^9}, {3.710141295805894*^9, 
   3.710141296171466*^9}, 3.710141543515283*^9, {3.7101416071848583`*^9, 
   3.710141614718896*^9}, {3.710141650826285*^9, 3.7101416509024467`*^9}, {
   3.710141986692687*^9, 3.710142052795342*^9}, {3.710235993158415*^9, 
   3.710236036488953*^9}, {3.710236133724947*^9, 3.710236133889398*^9}, 
   3.710236199531611*^9, 3.711358686101837*^9, 3.715424212870377*^9, {
   3.7154243458403807`*^9, 3.715424345885602*^9}, {3.715484636471447*^9, 
   3.7154846365685453`*^9}, 3.7154846671345797`*^9, 3.715485464972254*^9, {
   3.715485526271159*^9, 3.715485541514843*^9}, {3.715485579545397*^9, 
   3.715485686251017*^9}, {3.715489772436397*^9, 3.715489844962303*^9}, 
   3.715489875302108*^9, {3.715489913916572*^9, 3.7154899453677177`*^9}, {
   3.7154900132501163`*^9, 3.7154901036899967`*^9}, {3.7154913267663107`*^9, 
   3.7154915729856033`*^9}, 3.7154932999076433`*^9, {3.715493343661173*^9, 
   3.7154933731178923`*^9}, {3.715493477838057*^9, 3.7154934782493362`*^9}, {
   3.715493629856203*^9, 3.715493651606366*^9}, {3.715493711137229*^9, 
   3.7154937408735743`*^9}, {3.715494221345415*^9, 3.715494271892063*^9}, {
   3.715494356752675*^9, 3.715494365778426*^9}, {3.715494396402134*^9, 
   3.715494409223624*^9}, {3.715494521572362*^9, 3.715494538047421*^9}, 
   3.715495335737173*^9, {3.715495676352394*^9, 3.715495716373727*^9}, {
   3.715504606390458*^9, 3.715504610462002*^9}, 3.7155048005087967`*^9, 
   3.7160891131355457`*^9, {3.716089155285502*^9, 3.71608916627483*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frameskip", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runNum", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framelist", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "nframes", ",", "frameskip"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framelist", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"framelist", ",", 
      RowBox[{"{", "nframes", "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datasubset", "=", 
   RowBox[{"animDATA", "[", 
    RowBox[{"[", 
     RowBox[{"framelist", ",", "runNum"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond13d", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "view3d"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond1tp", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewTop"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond1bk", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewBack"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cond1rt", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"datasubset", ",", 
      RowBox[{"ViewPoint", "\[Rule]", "viewrt"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runNum", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framelist", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "nframes", ",", "frameskip"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framelist", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"framelist", ",", 
      RowBox[{"{", "nframes", "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datasubset", "=", 
   RowBox[{"animDATA", "[", 
    RowBox[{"[", 
     RowBox[{"framelist", ",", "runNum"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond23d", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "view3d"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond2tp", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewTop"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond2bk", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewBack"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cond2rt", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"datasubset", ",", 
      RowBox[{"ViewPoint", "\[Rule]", "viewrt"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runNum", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framelist", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "nframes", ",", "frameskip"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framelist", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"framelist", ",", 
      RowBox[{"{", "nframes", "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datasubset", "=", 
   RowBox[{"animDATA", "[", 
    RowBox[{"[", 
     RowBox[{"framelist", ",", "runNum"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond33d", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "view3d"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond3tp", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewTop"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond3bk", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewBack"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cond3rt", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"datasubset", ",", 
     RowBox[{"ViewPoint", "\[Rule]", "viewrt"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7154890021118107`*^9, 3.7154890946333313`*^9}, 
   3.7154891272386837`*^9, {3.715489164941497*^9, 3.715489171509164*^9}, {
   3.715489206012113*^9, 3.715489322086375*^9}, {3.715489352962718*^9, 
   3.715489592305007*^9}, {3.715489628509317*^9, 3.71548963392*^9}, {
   3.715489980757452*^9, 3.7154900020052977`*^9}, {3.7154903115178223`*^9, 
   3.7154904685388803`*^9}, {3.71549064381035*^9, 3.715490645903763*^9}, {
   3.7154907936958523`*^9, 3.715490815079207*^9}, {3.7154908861755257`*^9, 
   3.7154909326081*^9}, {3.715491857952999*^9, 3.7154918963238173`*^9}, 
   3.7154933907557917`*^9, {3.715493554647105*^9, 3.715493561067832*^9}, {
   3.7154935958209*^9, 3.715493606949986*^9}, {3.7154936435378637`*^9, 
   3.7154936436580267`*^9}, {3.715493790273637*^9, 3.715493902958672*^9}, {
   3.715494557857724*^9, 3.715494577461401*^9}, {3.7154948044745283`*^9, 
   3.71549484106281*^9}, {3.715495062756518*^9, 3.7154950829709873`*^9}, {
   3.715495122350037*^9, 3.715495148912005*^9}, {3.715495185865951*^9, 
   3.715495192128957*^9}, {3.7154954240069532`*^9, 3.7154954261882*^9}, {
   3.7154954567001333`*^9, 3.71549547925841*^9}, {3.715495596692171*^9, 
   3.71549560536224*^9}, {3.715496271013907*^9, 3.715496276457148*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "save", " ", "figures", " ", "as", " ", "well", " ", "as", " ", 
    "information", " ", "on", " ", "notebook", " ", "used", " ", "to", " ", 
    "make", " ", "the", " ", "figs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nbname", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NotebookFileName", "[", "]"}], "//", "FileNameSplit"}], 
       ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"info", "=", 
     RowBox[{"\"\<Figures created by \>\"", "<>", "nbname"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "[", "setpathfigpanel", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond13d.gif\>\"", ",", "cond13d", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond23d.gif\>\"", ",", "cond23d", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond33d.gif\>\"", ",", "cond33d", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond1tp.gif\>\"", ",", "cond1tp", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond2tp.gif\>\"", ",", "cond2tp", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond3tp.gif\>\"", ",", "cond3tp", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond1bk.gif\>\"", ",", "cond1bk", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond2bk.gif\>\"", ",", "cond2bk", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond3bk.gif\>\"", ",", "cond3bk", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond1rt.gif\>\"", ",", "cond1rt", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond2rt.gif\>\"", ",", "cond2rt", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_cond3rt.gif\>\"", ",", "cond3rt", ",", 
      RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<stickJumps_info.txt\>\"", ",", "info"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ResetDirectory", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7154890021118107`*^9, 3.7154890946333313`*^9}, 
   3.7154891272386837`*^9, {3.715489164941497*^9, 3.715489171509164*^9}, {
   3.715489206012113*^9, 3.715489322086375*^9}, {3.715489352962718*^9, 
   3.715489592305007*^9}, {3.715489628509317*^9, 3.71548963392*^9}, {
   3.715489980757452*^9, 3.7154900020052977`*^9}, {3.7154903115178223`*^9, 
   3.7154904685388803`*^9}, {3.71549064381035*^9, 3.715490645903763*^9}, {
   3.7154907936958523`*^9, 3.715490815079207*^9}, {3.7154908861755257`*^9, 
   3.7154909326081*^9}, {3.715491857952999*^9, 3.7154918963238173`*^9}, 
   3.7154933907557917`*^9, {3.715493554647105*^9, 3.715493561067832*^9}, {
   3.7154935958209*^9, 3.715493606949986*^9}, {3.7154936435378637`*^9, 
   3.7154936436580267`*^9}, {3.715493790273637*^9, 3.715493902958672*^9}, {
   3.715494557857724*^9, 3.715494577461401*^9}, {3.7154948044745283`*^9, 
   3.71549484106281*^9}, {3.715495062756518*^9, 3.7154950829709873`*^9}, {
   3.715495122350037*^9, 3.715495148912005*^9}, {3.715495185865951*^9, 
   3.715495192128957*^9}, {3.7154954240069532`*^9, 3.7154954261882*^9}, {
   3.7154954567001333`*^9, 3.71549547925841*^9}, {3.715495596692171*^9, 
   3.71549560536224*^9}, {3.715496271013907*^9, 3.715496456113285*^9}, {
   3.715503999003186*^9, 3.715504020053911*^9}, 3.715504145399667*^9, {
   3.715504225677003*^9, 3.715504279617865*^9}}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
figs/panels\"\>"], "Output",
 CellChangeTimes->{3.715496477460237*^9, 3.715504021608626*^9, 
  3.715504146737389*^9, 3.715504287803732*^9, 3.7155047265404177`*^9, 
  3.715504810307033*^9, 3.7155049074723186`*^9, 3.7161767820809307`*^9}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
simData\"\>"], "Output",
 CellChangeTimes->{3.715496477460237*^9, 3.715504021608626*^9, 
  3.715504146737389*^9, 3.715504287803732*^9, 3.7155047265404177`*^9, 
  3.715504810307033*^9, 3.7155049074723186`*^9, 3.716176785758314*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
9.  Interactively change the target heading of the nominal simulation and \
watch the kinematic trajectories update.  Use for demo.\[LineSeparator]
\[LineSeparator]
\[LineSeparator]
TO DO: 
- add fig legends for joints
\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
  3.710040593968562*^9}, {3.7100407522967653`*^9, 3.710040752832938*^9}, {
  3.710040822594124*^9, 3.7100408276873493`*^9}, {3.710042782021922*^9, 
  3.7100428102999687`*^9}, {3.711428813014496*^9, 3.711428871895347*^9}, {
  3.7114289446153173`*^9, 3.711429041835001*^9}, {3.714719139340725*^9, 
  3.714719251461725*^9}, {3.7150566308721437`*^9, 3.715056634230201*^9}, {
  3.716200067987953*^9, 3.716200072192827*^9}, {3.71661208120947*^9, 
  3.716612087895389*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.71471888962742*^9, 3.7147189135498247`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intermediateColor", "=", 
     RowBox[{"Setting", "[", 
      ColorSetterBox[RGBColor[
       0.7722590981918059, 0.7171282520790417, 0.7237201495384146], "Swatch"],
       "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "intermediate", " ", "stick", " ", "figure", " ", "frames"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"range", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchlabel", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{"\"\<Pitch\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"FontSize", "\[Rule]", 
           RowBox[{"Round", "[", "fontsizePlot", "]"}]}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refframecol", "=", "Transparent"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats1", "=", "quatsi"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quats1", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limbIinit", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "change", " ", "the", " ", "initial", " ", "body", " ", "axis", " ", 
      "pitch", " ", "without", " ", "influencing", " ", "other", " ", 
      "segments"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"qpitchInit", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"pitchangleInit", "+", 
          RowBox[{"0", "*", 
           RowBox[{
            RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bodyInit", "=", 
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bodyInitRot", "=", 
       RowBox[{"qRot", "[", 
        RowBox[{"qpitchInit", ",", "bodyInit"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbInitRot", "=", "limbIinit"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"limbInitRot", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"limbInitRot", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "bodyInitRot"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quats1mod", "=", 
       RowBox[{"limbQUAT", "[", 
        RowBox[{"limbInitRot", ",", "qref"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"quats1", "=", "quats1mod"}], ";", "\[IndentingNewLine]", 
      RowBox[{"quats2", "=", "quatsfNominal"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"qpitch", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"pitchangle", "+", 
          RowBox[{"0", "*", 
           RowBox[{
            RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qyaw", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "yawangle"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qtarget", "=", 
       RowBox[{"qMult", "[", 
        RowBox[{"qyaw", ",", "qpitch"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"quats2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"qMult", "[", 
        RowBox[{"qtarget", ",", 
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "qtarget"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", "constrain"}]}]}], " ", "end", " ", "of", " ", "jump",
          " ", "based", " ", "on", " ", "hip", " ", "3", "d", " ", 
         RowBox[{"angle", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"angHip3d", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"hip", " ", "3", "d", " ", "angle"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tt", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"time", " ", "value", " ", "to", " ", "use"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dt", "=", "0.01"}], ";", 
      RowBox[{"(*", 
       RowBox[{"increment", " ", "for", " ", "time"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"angHip3d", "<", 
         RowBox[{"130", "*", 
          RowBox[{"Pi", "/", "180.0"}]}]}], 
        RowBox[{"(*", 
         RowBox[{"hip", " ", "3", "d", " ", "angle", " ", "threshold"}], 
         "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"quatsItest", "=", 
          RowBox[{"limbSlerp", "[", 
           RowBox[{"quats1", ",", "quats2", ",", "tt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limbItest", "=", 
          RowBox[{"quatFK", "[", 
           RowBox[{"quatsItest", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"limbItest", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"limbItest", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"limbItest", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "limbItest", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"angHip3d", "=", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "-", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tt", "=", 
          RowBox[{"tt", "+", "dt"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "scale", " ", "the", " ", "timefun", " ", "according", " ", "to", " ", 
        "tt", " ", "to", " ", "try", " ", "to", " ", "have", " ", "the", " ", 
        "same", " ", "velocity", " ", "profile"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"timeTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"time", "*", "tt"}], ",", 
           RowBox[{"tt", "*", "timefun"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"time", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"nsamples", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"timefunScaled", "=", 
       RowBox[{"Interpolation", "[", "timeTable", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"timevalue", "=", 
       RowBox[{"timefunScaled", "[", 
        RowBox[{"(", 
         RowBox[{"tt", "*", "t"}], ")"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"quatsCurr", "=", 
       RowBox[{"limbSlerp", "[", 
        RowBox[{"quats1", ",", "quats2", ",", "timevalue"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbCurr", "=", 
       RowBox[{"quatFK", "[", 
        RowBox[{"quatsCurr", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbCurr", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"limbCurr", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"limbCurr", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "limbCurr", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nsticks", "=", "5"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "number", " ", "of", " ", "stick", " ", "figures", " ", "to", " ", 
        "superimpose"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"limbSticks", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"timeStick", "=", 
           RowBox[{"timefunScaled", "[", 
            RowBox[{"(", 
             RowBox[{"tt", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"tstick", "-", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"nsticks", "-", "1"}], ")"}]}]}], ")"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"quatsStick", "=", 
           RowBox[{"limbSlerp", "[", 
            RowBox[{"quats1", ",", "quats2", ",", "timeStick"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"limbStick", "=", 
           RowBox[{"quatFK", "[", 
            RowBox[{"quatsStick", ",", "lengths", ",", "qref"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"limbStick", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"limbStick", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"limbStick", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "limbStick", "]"}]}], "}"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"tstick", ",", "1", ",", "nsticks"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PNTSi", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"quatsI", "=", 
           RowBox[{"limbSlerp", "[", 
            RowBox[{"quats1", ",", "quats2", ",", 
             RowBox[{"timefunScaled", "[", 
              RowBox[{"(", 
               RowBox[{"tt", "*", "relTime"}], ")"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"limbI1", "=", 
           RowBox[{"quatFK", "[", 
            RowBox[{"quatsI", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"limbI", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"limbI1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"limbI1", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "limbI1", "]"}]}], "}"}]}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"relTime", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phifemLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thefemRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phifemRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"thetibLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitibLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thetibRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitibRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"thetarLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitarLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thetarRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitarRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phipftLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thepftRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phipftRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"limbL", "=", 
          RowBox[{"PNTSi", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vbodL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vfemL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtibL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtarL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vpftL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"t1L", "=", "0"}], ";", 
         RowBox[{"t2L", "=", "1.0"}], ";", 
         RowBox[{"t3L", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"theta", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"p1L", "=", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "/", "2"}]}], ";", 
         RowBox[{"p2L", "=", 
          RowBox[{"-", "1."}]}], ";", 
         RowBox[{"p3L", "=", "0"}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"phi", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"order", " ", "is", " ", "r"}], ",", " ", "phi", ",", " ", 
           "theta"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thefemL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"<", 
           RowBox[{
            RowBox[{"--", "note"}], " ", "negatives", " ", "for", " ", 
            "knee"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"thetibL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibL", "=", 
          RowBox[{
           RowBox[{"-", "p1L"}], "-", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetarL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thepftL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thefemLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thefemLdata", ",", 
            RowBox[{"{", "thefemL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phifemLdata", ",", 
            RowBox[{"{", "phifemL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetibLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetibLdata", ",", 
            RowBox[{"{", "thetibL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitibLdata", ",", 
            RowBox[{"{", "phitibL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetarLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetarLdata", ",", 
            RowBox[{"{", "thetarL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitarLdata", ",", 
            RowBox[{"{", "phitarL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thepftLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thepftLdata", ",", 
            RowBox[{"{", "thepftL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phipftLdata", ",", 
            RowBox[{"{", "phipftL", "}"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "PNTSi", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thefemLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phifemLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phifemLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetibLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thetibLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phitibLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetarLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thetarLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phitarLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thepftLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phipftLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ndat", "=", 
       RowBox[{"Length", "[", "phifemLdata", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"datTimeValues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"ndat", "-", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ndat"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thefemLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phifemLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phifemLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetibLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thetibLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phitibLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetarLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thetarLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phitarLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thepftLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phipftLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bodyaxis", "=", 
       RowBox[{
        RowBox[{"limbL", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"limbL", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bodyyaw", "=", 
       RowBox[{"VectorAngle", "[", 
        RowBox[{
         RowBox[{"bodyaxis", "*", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bodypitch", "=", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "-", 
        RowBox[{"VectorAngle", "[", 
         RowBox[{"bodyaxis", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"label", "=", 
       RowBox[{"\"\<Takeoff pitch = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{"180", "*", 
           RowBox[{"bodypitch", "/", "3.14"}]}], "]"}], "]"}], "<>", 
        "\"\< deg \\n\>\"", "<>", "\"\<Takeoff yaw = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{"180", "*", 
           RowBox[{"bodyyaw", "/", "3.14"}]}], "]"}], "]"}], "<>", 
        "\"\< deg \\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P1", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{"limbCurr", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "label"}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
               "}"}]}]}], "*)"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], ",", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Line", "[", "limbCurr", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", "intermediateColor", ",", 
            RowBox[{"Line", "[", "limbSticks", "]"}]}], "}"}], "]"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Top", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", "Front"}], "}"}], 
           "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"ViewCenter", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P1a", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{"limbCurr", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "label"}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
               "}"}]}], ","}], "*)"}], 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Line", "[", "limbCurr", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", "intermediateColor", ",", 
            RowBox[{"Line", "[", "limbSticks", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Gray", ",", "Dashed", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "ymarker", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "ymarker", ",", "2"}], "}"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Right"}], ",", 
         RowBox[{"ViewCenter", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P2", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "thefemLdataXY", ",", "thetibLdataXY", ",", "thetarLdataXY", ",", 
             "thepftLdataXY"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "rangeTheta"}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"p2line", "=", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"rangeTheta", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Dashed", ",", "Black"}], "}"}]}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P3", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "phifemLdataXY", ",", "phitibLdataXY", ",", "phitarLdataXY", ",", 
             "phipftLdataXY"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"colors", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "rangePhi"}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"p3line", "=", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"rangePhi", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0"}], "}"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Dashed", ",", "Black"}], "}"}]}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"-", "for"}]}], " ", 
         RowBox[{
          RowBox[{"sliders", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"slidersize", "=", "100"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sliderfraction", "=", "0.6"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "fraction", " ", "of", " ", "slider", " ", "within", " ", "slider", 
        " ", "inset"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"targetSlider", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"blank", ",", 
         RowBox[{"{", 
          RowBox[{"blank", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", 
             RowBox[{"Slider2D", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "yawangle"}], ",", "pitchangle"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"sliderfraction", "*", "slidersize"}], ",", 
                  RowBox[{"sliderfraction", "*", "slidersize"}]}], "}"}]}]}], 
              "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{"\"\<Yaw\>\"", ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.53", ",", "0.9"}], "}"}], "]"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{"pitchlabel", ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "0.53"}], "}"}], "]"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"slidersize", ",", "slidersize"}], "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"timeSlider", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"blank", ",", 
         RowBox[{"{", 
          RowBox[{"blank", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"t", ",", "0.01"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{"\"\<\[Tau]\>\"", ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.35", ",", "0.505"}], "}"}], "]"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "slidersize"}], ",", 
            RowBox[{"10", "slidersize"}]}], "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"P1", ",", "P1a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"P2", ",", "P3"}], "}"}]}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "700"}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{"\"\<Relative time (\[Tau])\>\"", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.55", ",", 
                RowBox[{"-", "0.3"}]}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"\"\<X\>\"", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.58"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"\"\<Y\>\"", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.3"}], ",", "0.9"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"\"\<Y\>\"", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0.58"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"\"\<Z\>\"", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.67", ",", "0.9"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{
             "\"\<Segment retraction angle(\[Degree])\\nhip 3D angle\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"1.", "/", "Degree"}], " ", 
                RowBox[{"VectorAngle", "[", 
                 RowBox[{"vbodL", ",", "vfemL"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.35"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"\"\<Segment adduction angle(\[Degree])\>\"", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0.35"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"timeSlider", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.55", ",", "0.47"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"targetSlider", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.47", ",", "0.7"}], "}"}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Scaled", "[", ".5", "]"}]}], "}"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pitchangle", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"yawangle", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pitchangleInit", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ymarker", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"TrackedSymbols", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "t", ",", "pitchangle", ",", "yawangle", ",", "pitchangleInit", ",", 
        "ymarker"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.710169693014718*^9, 3.710169722473415*^9}, {
   3.710169776777179*^9, 3.710169896658449*^9}, {3.710169964032371*^9, 
   3.7101700778126717`*^9}, {3.710170109012896*^9, 3.7101701323126097`*^9}, {
   3.710170193321117*^9, 3.710170206617949*^9}, {3.7101702419653997`*^9, 
   3.710170277994153*^9}, {3.710170317995895*^9, 3.710170387549094*^9}, {
   3.7101746406510477`*^9, 3.710174668532082*^9}, 3.7101747801280403`*^9, {
   3.710175061073135*^9, 3.7101750686058693`*^9}, {3.7101751050342417`*^9, 
   3.7101751495240602`*^9}, {3.7101751917158823`*^9, 3.710175191815586*^9}, {
   3.710175258271051*^9, 3.71017536388102*^9}, 3.7101754330840054`*^9, {
   3.710175472939744*^9, 3.710175520522954*^9}, {3.710175569778688*^9, 
   3.710175572728292*^9}, 3.710175626830142*^9, {3.7101757517186937`*^9, 
   3.710175805726012*^9}, {3.710219339558475*^9, 3.710219444527022*^9}, {
   3.710219504239189*^9, 3.710219507541676*^9}, {3.710219575805872*^9, 
   3.7102196400250053`*^9}, {3.710219690778541*^9, 3.710219762323306*^9}, {
   3.710233722740574*^9, 3.710233750507526*^9}, {3.710233806807139*^9, 
   3.710233934516354*^9}, {3.7113589756499777`*^9, 3.711358976119001*^9}, {
   3.711359073041408*^9, 3.711359082319186*^9}, {3.711359280211893*^9, 
   3.711359285803252*^9}, 3.711367534508868*^9, {3.7113798903093243`*^9, 
   3.7113798915871143`*^9}, {3.711380086192844*^9, 3.711380122149983*^9}, {
   3.711380196401441*^9, 3.711380251612158*^9}, 3.711380332512714*^9, {
   3.711380393420784*^9, 3.7113804286024427`*^9}, 3.711427613965941*^9, {
   3.711427651925507*^9, 3.7114276521539516`*^9}, 3.711427822498521*^9, {
   3.711427859817264*^9, 3.711427860925984*^9}, 3.7114283633131943`*^9, 
   3.7114284801380863`*^9, 3.711428983673514*^9, {3.711429192637282*^9, 
   3.711429276043722*^9}, {3.711429340465996*^9, 3.71142947352175*^9}, {
   3.711429516880639*^9, 3.711429516958269*^9}, {3.711429590149376*^9, 
   3.7114295911331673`*^9}, {3.71471886390823*^9, 3.714718882014119*^9}, {
   3.714718915953137*^9, 3.71471892571171*^9}, 3.714718956808804*^9, {
   3.714724585702256*^9, 3.714724716945765*^9}, {3.7147248235489187`*^9, 
   3.7147248248771*^9}, {3.714724905020402*^9, 3.7147249110122747`*^9}, {
   3.714724960455717*^9, 3.714724999202044*^9}, {3.714725032058667*^9, 
   3.714725116886743*^9}, {3.714725165711494*^9, 3.714725225821299*^9}, {
   3.714725340417714*^9, 3.71472534193587*^9}, {3.714725874667273*^9, 
   3.714726071997221*^9}, {3.714726106116826*^9, 3.7147262087382097`*^9}, {
   3.7147262422549257`*^9, 3.714726248175321*^9}, {3.7147267237379417`*^9, 
   3.714726734730859*^9}, {3.714726863867605*^9, 3.714726883524878*^9}, {
   3.714726974175983*^9, 3.714726997935454*^9}, {3.7147270411084547`*^9, 
   3.714727045476409*^9}, {3.7147271555363617`*^9, 3.714727160944395*^9}, {
   3.714727254599387*^9, 3.714727260406187*^9}, {3.714727295598983*^9, 
   3.714727296405944*^9}, {3.714727550661826*^9, 3.714728220220894*^9}, {
   3.714728263435937*^9, 3.7147282648907547`*^9}, {3.714728432890469*^9, 
   3.714728532949445*^9}, {3.7147285648190193`*^9, 3.714728625938442*^9}, {
   3.714728659912203*^9, 3.714728715116406*^9}, {3.714728944829123*^9, 
   3.7147289706632833`*^9}, {3.714799729516824*^9, 3.714799752722495*^9}, {
   3.7147998137239113`*^9, 3.714799823926734*^9}, {3.714799855816812*^9, 
   3.714799874780952*^9}, {3.714799938777959*^9, 3.714799940984167*^9}, {
   3.714800018648486*^9, 3.7148000729435787`*^9}, {3.714800136157236*^9, 
   3.714800202993504*^9}, {3.714880244989093*^9, 3.714880332859972*^9}, {
   3.714880463849522*^9, 3.7148804753839397`*^9}, {3.7148805884904747`*^9, 
   3.714880594744421*^9}, {3.714881444967393*^9, 3.714881607108062*^9}, {
   3.7148816565086718`*^9, 3.714881672913887*^9}, {3.7148817219062243`*^9, 
   3.7148817703832483`*^9}, {3.7148818253744707`*^9, 
   3.7148818681327953`*^9}, {3.714881899153205*^9, 3.7148819416352158`*^9}, {
   3.714881985649289*^9, 3.714882019053645*^9}, {3.714882067411428*^9, 
   3.714882321783688*^9}, {3.7148823551669807`*^9, 3.714882425037527*^9}, {
   3.7148826253568697`*^9, 3.714882629297477*^9}, 3.714883528266871*^9, {
   3.71496755941925*^9, 3.7149675762822447`*^9}, {3.7149676623889217`*^9, 
   3.7149676697726727`*^9}, {3.714967723774634*^9, 3.714967736644435*^9}, {
   3.714968524620832*^9, 3.714968530593789*^9}, {3.7162008487738657`*^9, 
   3.716200848855752*^9}, {3.71661219711614*^9, 3.716612266934496*^9}, {
   3.716612318898719*^9, 3.716612350827183*^9}, {3.716614134500484*^9, 
   3.716614134764923*^9}, {3.716614185753874*^9, 3.7166141879922256`*^9}, {
   3.7166142415759706`*^9, 3.716614243422597*^9}, {3.7166142831672707`*^9, 
   3.716614287141518*^9}, {3.716614408965798*^9, 3.716614462553431*^9}, {
   3.71661450919563*^9, 3.71661456990656*^9}, {3.716614610620386*^9, 
   3.716614620136249*^9}, {3.7166146986251993`*^9, 3.716614701132922*^9}, {
   3.7166147327560787`*^9, 3.716614734035437*^9}, {3.7166148076024923`*^9, 
   3.716614831162051*^9}, {3.7166151741264563`*^9, 3.71661526132113*^9}, {
   3.71661530013441*^9, 3.716615430634789*^9}, {3.716619168468186*^9, 
   3.716619406666646*^9}, {3.7166213354316673`*^9, 3.716621358613391*^9}, {
   3.716622040577718*^9, 3.7166220437997913`*^9}, 3.716622163543838*^9, {
   3.716627687466258*^9, 3.7166277448198442`*^9}, {3.7166277802539167`*^9, 
   3.7166277868386087`*^9}, 3.71662782591282*^9}],

Cell[CellGroupData[{

Cell[BoxData["quats1"], "Input",
 CellChangeTimes->{{3.716612458897331*^9, 3.7166124821933002`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.36372410077031603`"}], ",", "0.9315067248918953`", ",", 
     "1.532080026689058`*^-16", ",", "2.5804329570182977`*^-16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4255539313730087`", ",", "0.446950133790708`", ",", 
     "0.19110206095375915`", ",", 
     RowBox[{"-", "0.7632951144194955`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2874630456669443`", ",", 
     RowBox[{"-", "0.38930440900948227`"}], ",", 
     RowBox[{"-", "0.10505270793261567`"}], ",", "0.8687755769228825`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4060528815590357`", ",", "0.84093828430507`", ",", 
     "0.1932114704826098`", ",", 
     RowBox[{"-", "0.3010202435744096`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8744850107717493`", ",", "0.3852159232359623`", ",", 
     RowBox[{"-", "0.07552000301881645`"}], ",", 
     RowBox[{"-", "0.2849234766828392`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.716612462229601*^9, 3.716612497483391*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
10.  Make the above into a demo video simulating user control playing with \
the values
\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
  3.710040593968562*^9}, {3.7100407522967653`*^9, 3.710040752832938*^9}, {
  3.710040822594124*^9, 3.7100408276873493`*^9}, {3.710042782021922*^9, 
  3.7100428102999687`*^9}, {3.711428813014496*^9, 3.711428871895347*^9}, {
  3.7114289446153173`*^9, 3.711429041835001*^9}, {3.714719139340725*^9, 
  3.714719251461725*^9}, {3.71496782088663*^9, 3.714967846748127*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nsteps", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nconds", "=", "12"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"how", " ", "many", " ", "conditinos"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepLengths", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"nsteps", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nconds"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "how", " ", "many", " ", "steps", " ", "to", " ", "do", " ", "through", 
     " ", "each", " ", "change", " ", "of", " ", "condition"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pauseLengths", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nconds"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "length", " ", "of", " ", "pauses", " ", "between", " ", "condition"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"npauses", "=", 
     RowBox[{"Length", "[", "pauseLengths", "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "pauses"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nslices", "=", 
     RowBox[{"nconds", "+", "npauses"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sliceLengths", "=", 
     RowBox[{"Riffle", "[", 
      RowBox[{"stepLengths", ",", "pauseLengths"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nindices", "=", 
     RowBox[{"Total", "[", "sliceLengths", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "number", " ", "of", " ", "indices", " ", "which", " ", "will", " ", 
     "become", " ", "slices", " ", "for", " ", "simulated", " ", "user", " ", 
     "data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sliceData", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "nindices"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slices", "=", 
     RowBox[{"listSplit", "[", 
      RowBox[{"sliceData", ",", "sliceLengths"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "generate"}]}], " ", "simulated", " ", "user", " ", 
      "control", " ", "data", " ", "to", " ", "operate", " ", 
      RowBox[{"sliders", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"maxpitch", "=", "1"}], ";", 
     RowBox[{"maxyaw", "=", "0.47"}], ";", 
     RowBox[{"minpitch", "=", 
      RowBox[{"-", "0.7"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxpitch", "=", "1"}], ";", 
    RowBox[{"maxyaw", "=", "0.51"}], ";", 
    RowBox[{"minpitch", "=", 
     RowBox[{"-", "0.52"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"slider", " ", "control", " ", "data", " ", "for", " ", "time"}],
      ",", " ", "yaw", ",", " ", "pitch"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeData", "=", 
     RowBox[{"yawData", "=", 
      RowBox[{"pitchData", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nindices"}], "}"}]}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeup", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"N", "@", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"nsteps", "-", "1"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nsteps"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timedown", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"nsteps", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nsteps"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchup", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"maxpitch", "*", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"nsteps", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nsteps"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchdown", "=", 
     RowBox[{"pitchdown", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"maxpitch", "-", "minpitch"}], ")"}], 
            RowBox[{
             RowBox[{"N", "@", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"nsteps", "-", "1"}], ")"}]}]}], ")"}]}], "+", 
         "maxpitch"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nsteps"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yawup", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"maxyaw", "*", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"nsteps", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nsteps"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yawdown", "=", 
     RowBox[{"maxyaw", "-", "yawup"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchreset", "=", 
     RowBox[{"timedown", "*", "minpitch"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yawreset", "=", 
     RowBox[{"maxyaw", "*", "timedown"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", "GENERATE"}]}]}]}], " ", "SIMULATEED", " ", "USER", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"DATA", "--"}], "--"}], "--"}]}], "-"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timeup"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timedown"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "pitchup"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timeup"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timedown"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "10", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "11", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "pitchdown"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "12", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "13", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timeup"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "14", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "15", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timedown"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "16", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "17", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "yawup"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "18", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxyaw"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "19", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timeup"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxyaw"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "20", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxyaw"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "21", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "timedown"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxyaw"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "22", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "minpitch"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "maxyaw"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "23", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "pitchreset"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "yawreset"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"slices", "[", 
      RowBox[{"[", "24", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pitchData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yawData", "[", 
      RowBox[{"[", "slice", "]"}], "]"}], "=", "0"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7149032998169603`*^9, 3.7149033666076193`*^9}, {
   3.714903414277856*^9, 3.714903480399838*^9}, {3.714903515226368*^9, 
   3.714903516778633*^9}, {3.714903549246462*^9, 3.714903653692519*^9}, {
   3.71490373518233*^9, 3.714903766980502*^9}, 3.714903961737607*^9, {
   3.714904203144809*^9, 3.714904206660006*^9}, {3.714904375772448*^9, 
   3.714904377357809*^9}, {3.7149051396080503`*^9, 3.714905151667157*^9}, {
   3.714908483898588*^9, 3.7149084841062*^9}, {3.714908517749303*^9, 
   3.714908519803787*^9}, {3.714965569443096*^9, 3.714965637950781*^9}, {
   3.714965811756805*^9, 3.714965842843054*^9}, {3.714966561528453*^9, 
   3.7149665940766373`*^9}, {3.714967851357442*^9, 3.714967899847423*^9}, {
   3.714968036602409*^9, 3.714968155663025*^9}, {3.714968210385504*^9, 
   3.714968289789201*^9}, 3.714968592658523*^9, {3.71496862424627*^9, 
   3.714968633560018*^9}, {3.714969660562327*^9, 3.714969674188465*^9}, 
   3.714969788166444*^9, {3.714970451308263*^9, 3.714970454393971*^9}, 
   3.714970507145072*^9, {3.7185190710321074`*^9, 3.7185190751922817`*^9}, {
   3.718519134319948*^9, 3.7185191425432568`*^9}, {3.718519216018404*^9, 
   3.718519247208219*^9}, {3.7185194570498953`*^9, 3.7185194849211884`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", "CREATE"}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ANIMATION", "--"}], "--"}], "--"}]}], "-"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intermediateColor", "=", 
     RowBox[{"Setting", "[", 
      ColorSetterBox[RGBColor[
       0.7722590981918059, 0.7171282520790417, 0.7237201495384146], "Swatch"],
       "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "intermediate", " ", "stick", " ", "figure", " ", "frames"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"range", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchlabel", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{"\"\<Pitch\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"FontSize", "\[Rule]", 
           RowBox[{"Round", "[", "fontsizePlot", "]"}]}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refframecol", "=", "Transparent"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats1", "=", "quatsi"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quats1", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limbIinit", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"animation", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"timeData", "[", 
          RowBox[{"[", "frame", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pitchangle", "=", 
         RowBox[{"pitchData", "[", 
          RowBox[{"[", "frame", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yawangle", "=", 
         RowBox[{"yawData", "[", 
          RowBox[{"[", "frame", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"quats2", "=", "quatsfNominal"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"qpitch", "=", 
         RowBox[{"aaToq", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"pitchangle", "+", 
            RowBox[{"0", "*", 
             RowBox[{
              RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qyaw", "=", 
         RowBox[{"aaToq", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "yawangle"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"qtarget", "=", 
         RowBox[{"qMult", "[", 
          RowBox[{"qyaw", ",", "qpitch"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"qMult", "[", 
          RowBox[{"qtarget", ",", 
           RowBox[{"quats2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"quats2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", "qtarget"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", "constrain"}]}]}], " ", "end", " ", "of", " ", 
           "jump", " ", "based", " ", "on", " ", "hip", " ", "3", "d", " ", 
           RowBox[{"angle", "--"}]}], "-"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"angHip3d", "=", "0"}], ";", 
        RowBox[{"(*", 
         RowBox[{"hip", " ", "3", "d", " ", "angle"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tt", "=", "0"}], ";", 
        RowBox[{"(*", 
         RowBox[{"time", " ", "value", " ", "to", " ", "use"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dt", "=", "0.01"}], ";", 
        RowBox[{"(*", 
         RowBox[{"increment", " ", "for", " ", "time"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"angHip3d", "<", 
           RowBox[{"130", "*", 
            RowBox[{"Pi", "/", "180.0"}]}]}], 
          RowBox[{"(*", 
           RowBox[{"hip", " ", "3", "d", " ", "angle", " ", "threshold"}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"quatsItest", "=", 
            RowBox[{"limbSlerp", "[", 
             RowBox[{"quats1", ",", "quats2", ",", "tt"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"limbItest", "=", 
            RowBox[{"quatFK", "[", 
             RowBox[{"quatsItest", ",", "lengths", ",", "qref"}], "]"}]}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"limbItest", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"limbItest", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"limbItest", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "limbItest", "]"}]}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"angHip3d", "=", 
            RowBox[{
             RowBox[{"N", "@", "Pi"}], "-", 
             RowBox[{"VectorAngle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"limbItest", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"limbItest", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"limbItest", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"limbItest", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tt", "=", 
            RowBox[{"tt", "+", "dt"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "scale", " ", "the", " ", "timefun", " ", "according", " ", "to", 
          " ", "tt", " ", "to", " ", "try", " ", "to", " ", "have", " ", 
          "the", " ", "same", " ", "velocity", " ", "profile"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"timeTable", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"time", "*", "tt"}], ",", 
             RowBox[{"tt", "*", "timefun"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"nsamples", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"timefunScaled", "=", 
         RowBox[{"Interpolation", "[", "timeTable", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
          " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"timevalue", "=", 
         RowBox[{"timefunScaled", "[", 
          RowBox[{"(", 
           RowBox[{"tt", "*", "t"}], ")"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"quatsCurr", "=", 
         RowBox[{"limbSlerp", "[", 
          RowBox[{"quats1", ",", "quats2", ",", "timevalue"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"limbCurr", "=", 
         RowBox[{"quatFK", "[", 
          RowBox[{"quatsCurr", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"limbCurr", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"limbCurr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"limbCurr", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "limbCurr", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nsticks", "=", "8"}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "number", " ", "of", " ", "stick", " ", "figures", " ", "to", " ", 
          "superimpose"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"limbSticks", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"timeStick", "=", 
             RowBox[{"timefunScaled", "[", 
              RowBox[{"(", 
               RowBox[{"tt", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"tstick", "-", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"nsticks", "-", "1"}], ")"}]}]}], ")"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"quatsStick", "=", 
             RowBox[{"limbSlerp", "[", 
              RowBox[{"quats1", ",", "quats2", ",", "timeStick"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"limbStick", "=", 
             RowBox[{"quatFK", "[", 
              RowBox[{"quatsStick", ",", "lengths", ",", "qref"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"limbStick", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"limbStick", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"limbStick", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "limbStick", "]"}]}], "}"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"tstick", ",", "1", ",", "nsticks"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PNTSi", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"quatsI", "=", 
             RowBox[{"limbSlerp", "[", 
              RowBox[{"quats1", ",", "quats2", ",", 
               RowBox[{"timefunScaled", "[", 
                RowBox[{"(", 
                 RowBox[{"tt", "*", "relTime"}], ")"}], "]"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"limbI1", "=", 
             RowBox[{"quatFK", "[", 
              RowBox[{"quatsI", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"limbI", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"limbI1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"limbI1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "limbI1", "]"}]}], "}"}]}], "]"}]}]}],
            ",", 
           RowBox[{"{", 
            RowBox[{"relTime", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thefemLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phifemLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"thefemRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phifemRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"thetibLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phitibLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"thetibRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phitibRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"thetarLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phitarLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"thetarRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phitarRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thepftLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phipftLdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"thepftRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phipftRdata", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"limbL", "=", 
            RowBox[{"PNTSi", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vbodL", "=", 
            RowBox[{
             RowBox[{"limbL", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"vfemL", "=", 
            RowBox[{
             RowBox[{"limbL", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"vtibL", "=", 
            RowBox[{
             RowBox[{"limbL", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"vtarL", "=", 
            RowBox[{
             RowBox[{"limbL", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "-", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"vpftL", "=", 
            RowBox[{
             RowBox[{"limbL", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "-", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"t1L", "=", "0"}], ";", 
           RowBox[{"t2L", "=", "1.0"}], ";", 
           RowBox[{"t3L", "=", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"theta", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"p1L", "=", 
            RowBox[{
             RowBox[{"N", "@", "Pi"}], "/", "2"}]}], ";", 
           RowBox[{"p2L", "=", 
            RowBox[{"-", "1."}]}], ";", 
           RowBox[{"p3L", "=", "0"}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"phi", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"order", " ", "is", " ", "r"}], ",", " ", "phi", ",", 
             " ", "theta"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"thefemL", "=", 
            RowBox[{"t1L", "+", 
             RowBox[{"t2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phifemL", "=", 
            RowBox[{"p1L", "+", 
             RowBox[{"p2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"<", 
             RowBox[{
              RowBox[{"--", "note"}], " ", "negatives", " ", "for", " ", 
              "knee"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"thetibL", "=", 
            RowBox[{"t1L", "+", 
             RowBox[{"t2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", "t3L"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phitibL", "=", 
            RowBox[{
             RowBox[{"-", "p1L"}], "-", 
             RowBox[{"p2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"thetarL", "=", 
            RowBox[{"t1L", "+", 
             RowBox[{"t2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phitarL", "=", 
            RowBox[{"p1L", "+", 
             RowBox[{"p2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"thepftL", "=", 
            RowBox[{"t1L", "+", 
             RowBox[{"t2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phipftL", "=", 
            RowBox[{"p1L", "+", 
             RowBox[{"p2L", "*", 
              RowBox[{
               RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"thefemLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"thefemLdata", ",", 
              RowBox[{"{", "thefemL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phifemLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"phifemLdata", ",", 
              RowBox[{"{", "phifemL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"thetibLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"thetibLdata", ",", 
              RowBox[{"{", "thetibL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phitibLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"phitibLdata", ",", 
              RowBox[{"{", "phitibL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"thetarLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"thetarLdata", ",", 
              RowBox[{"{", "thetarL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phitarLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"phitarLdata", ",", 
              RowBox[{"{", "phitarL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"thepftLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"thepftLdata", ",", 
              RowBox[{"{", "thepftL", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"phipftLdata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"phipftLdata", ",", 
              RowBox[{"{", "phipftL", "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "PNTSi", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thefemLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "thefemLdata"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phifemLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "phifemLdata"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thetibLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "thetibLdata"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phitibLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "phitibLdata"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thetarLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "thetarLdata"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phitarLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "phitarLdata"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thepftLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "thepftLdata"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phipftLdata", "=", 
         RowBox[{
          RowBox[{"1.", "/", "Degree"}], "  ", 
          RowBox[{"unwrapPhase", "@", "phipftLdata"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ndat", "=", 
         RowBox[{"Length", "[", "phifemLdata", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"datTimeValues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}], "/", 
            RowBox[{"(", 
             RowBox[{"ndat", "-", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "ndat"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thefemLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "thefemLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"phifemLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "phifemLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thetibLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "thetibLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"phitibLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "phitibLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thetarLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "thetarLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"phitarLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "phitarLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thepftLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "thepftLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"phipftLdataXY", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"datTimeValues", ",", "phipftLdata"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"bodyaxis", "=", 
         RowBox[{
          RowBox[{"limbL", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"limbL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bodyyaw", "=", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{
           RowBox[{"bodyaxis", "*", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bodypitch", "=", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "-", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"bodyaxis", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"label", "=", 
         RowBox[{"\"\<Takeoff pitch = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"180", "*", 
             RowBox[{"bodypitch", "/", "3.14"}]}], "]"}], "]"}], "<>", 
          "\"\< deg \\n\>\"", "<>", "\"\<Takeoff yaw = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"180", "*", 
             RowBox[{"bodyyaw", "/", "3.14"}]}], "]"}], "]"}], "<>", 
          "\"\< deg \\n\>\""}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"P1", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPointPlot3D", "[", 
            RowBox[{"limbCurr", ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"BoxRatios", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "label"}], 
             RowBox[{"(*", 
              RowBox[{",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
                 "}"}]}]}], "*)"}], ",", 
             RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
             RowBox[{"Axes", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], ",", 
             RowBox[{"Ticks", "\[Rule]", "False"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Line", "[", "limbCurr", "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", "intermediateColor", ",", 
              RowBox[{"Line", "[", "limbSticks", "]"}]}], "}"}], "]"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Top", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", "Front"}], "}"}],
              "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"ViewCenter", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"P1a", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPointPlot3D", "[", 
            RowBox[{"limbCurr", ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"BoxRatios", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "label"}], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
                 "}"}]}], ","}], "*)"}], 
             RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
             RowBox[{"Axes", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], ",", 
             RowBox[{"Ticks", "\[Rule]", "False"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Line", "[", "limbCurr", "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", "intermediateColor", ",", 
              RowBox[{"Line", "[", "limbSticks", "]"}]}], "}"}], "]"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Right"}], ",", 
           RowBox[{"ViewCenter", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"P2", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "thefemLdataXY", ",", "thetibLdataXY", ",", "thetarLdataXY", 
               ",", "thepftLdataXY"}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Transparent"}], 
                 RowBox[{"(*", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "*)"}], "}"}]}], "}"}]}], 
             ",", 
             RowBox[{"PlotRange", "\[Rule]", "rangeTheta"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
             RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"p2line", "=", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", 
                  RowBox[{"rangeTheta", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Dashed", ",", "Black"}], "}"}]}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"P3", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "phifemLdataXY", ",", "phitibLdataXY", ",", "phitarLdataXY", 
               ",", "phipftLdataXY"}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Transparent"}], 
                 RowBox[{"(*", 
                  RowBox[{"colors", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "*)"}], "}"}]}], "}"}]}], 
             ",", 
             RowBox[{"PlotRange", "\[Rule]", "rangePhi"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
             RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"p3line", "=", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t", ",", 
                  RowBox[{"rangePhi", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Dashed", ",", "Black"}], "}"}]}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", "for"}]}], " ", 
           RowBox[{
            RowBox[{"sliders", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"slidersize", "=", "100"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"sliderfraction", "=", "0.6"}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "fraction", " ", "of", " ", "slider", " ", "within", " ", "slider", 
          " ", "inset"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"targetSlider", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{"blank", ",", 
           RowBox[{"{", 
            RowBox[{"blank", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Transparent"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{"Slider2D", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "yawangle"}], ",", "pitchangle"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sliderfraction", "*", "slidersize"}], ",", 
                    RowBox[{"sliderfraction", "*", "slidersize"}]}], 
                   "}"}]}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", 
               RowBox[{"\"\<Yaw\>\"", ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.53", ",", "0.9"}], "}"}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", 
               RowBox[{"pitchlabel", ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "0.53"}], "}"}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"slidersize", ",", "slidersize"}], "}"}]}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"timeSlider", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{"blank", ",", 
           RowBox[{"{", 
            RowBox[{"blank", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Transparent"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Slider", "[", 
                 RowBox[{
                  RowBox[{"Round", "[", 
                   RowBox[{"t", ",", "0.01"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                  RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", 
               RowBox[{"\"\<\[Tau]\>\"", ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.35", ",", "0.505"}], "}"}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"10", "slidersize"}], ",", 
              RowBox[{"10", "slidersize"}]}], "}"}]}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "-"}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"status", "=", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "nindices"}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"GraphicsGrid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"P1", ",", "P1a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"P2", ",", "P3"}], "}"}]}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "700"}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<Relative time (\[Tau])\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.55", ",", 
                  RowBox[{"-", "0.3"}]}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<X\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.58"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<Y\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.3"}], ",", "0.9"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<Y\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0.58"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<Z\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.67", ",", "0.9"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<Segment retraction angle(\[Degree])\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.35"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"\"\<Segment adduction angle(\[Degree])\>\"", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0.35"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"timeSlider", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.55", ",", "0.47"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"targetSlider", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.47", ",", "0.7"}], "}"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Scaled", "[", ".5", "]"}]}], "}"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"frame", ",", "1", ",", "nindices"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7149032998169603`*^9, 3.7149033666076193`*^9}, {
   3.714903414277856*^9, 3.714903480399838*^9}, {3.714903515226368*^9, 
   3.714903516778633*^9}, {3.714903549246462*^9, 3.714903653692519*^9}, {
   3.71490373518233*^9, 3.714903766980502*^9}, 3.714903961737607*^9, {
   3.714904203144809*^9, 3.714904206660006*^9}, {3.714904375772448*^9, 
   3.714904377357809*^9}, {3.7149051396080503`*^9, 3.714905151667157*^9}, {
   3.714908483898588*^9, 3.7149084841062*^9}, {3.714908517749303*^9, 
   3.714908519803787*^9}, {3.714965569443096*^9, 3.714965637950781*^9}, {
   3.714965811756805*^9, 3.714965842843054*^9}, {3.714966561528453*^9, 
   3.7149665940766373`*^9}, {3.714967851357442*^9, 3.714967899847423*^9}, {
   3.714968036602409*^9, 3.714968155663025*^9}, {3.714968210385504*^9, 
   3.714968289789201*^9}, 3.714968592658523*^9, {3.71496862424627*^9, 
   3.714968633560018*^9}, {3.714969660562327*^9, 3.714969674188465*^9}, 
   3.714969788166444*^9, {3.718518168131122*^9, 3.718518183911228*^9}, {
   3.718518254934504*^9, 3.7185182665923367`*^9}, 3.718519502729594*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"animation", "[", 
    RowBox[{"[", "fr", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"fr", ",", "1", ",", 
     RowBox[{"Length", "[", "animation", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.714968279273458*^9, 3.7149682799983797`*^9}, {
  3.718518080738729*^9, 3.718518097800868*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", "status", "]"}]], "Input",
 CellChangeTimes->{{3.714968132015876*^9, 3.714968138654181*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`status, StandardForm],
  ImageSizeCache->{75., {2.40576171875, 9.}}]], "Output",
 CellChangeTimes->{3.714968139199613*^9, 3.714969803457196*^9, 
  3.718518020028426*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", " ", "to", " ", "ms", " ", "folder"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetDirectory", "[", "setpathms", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<SIMovie1.mov\>\"", ",", "animation", ",", 
     RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "5"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ResetDirectory", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.714967986348089*^9, 3.7149680074182034`*^9}, {
   3.7149683420755243`*^9, 3.714968357736474*^9}, {3.714968803578979*^9, 
   3.714968839307132*^9}, 3.7149689498735447`*^9, {3.718520945223604*^9, 
   3.718520949627244*^9}}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp\"\>\
"], "Output",
 CellChangeTimes->{
  3.71496835968891*^9, {3.714968816105546*^9, 3.714968839947754*^9}, 
   3.714968953160368*^9, 3.714969883314748*^9, 3.714970567778306*^9, 
   3.718520952290835*^9}],

Cell[BoxData["\<\"SIMovie1.mov\"\>"], "Output",
 CellChangeTimes->{
  3.71496835968891*^9, {3.714968816105546*^9, 3.714968839947754*^9}, 
   3.714968953160368*^9, 3.714969883314748*^9, 3.714970567778306*^9, 
   3.7185209929006367`*^9}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
simData\"\>"], "Output",
 CellChangeTimes->{
  3.71496835968891*^9, {3.714968816105546*^9, 3.714968839947754*^9}, 
   3.714968953160368*^9, 3.714969883314748*^9, 3.714970567778306*^9, 
   3.718520992905952*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "save", " ", "figures", " ", "as", " ", "well", " ", "as", " ", 
    "information", " ", "on", " ", "notebook", " ", "used", " ", "to", " ", 
    "make", " ", "the", " ", "figs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nbname", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NotebookFileName", "[", "]"}], "//", "FileNameSplit"}], 
       ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"info", "=", 
     RowBox[{"\"\<Figures created by \>\"", "<>", "nbname"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "[", "setpathfigpanel", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<linearVsNonlinearA.pdf\>\"", ",", "panelA"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<linearVsNonlinearA_info.txt\>\"", ",", "info"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ResetDirectory", "[", "]"}]}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
11.  Vary pitch and yaw target angles from reference configuration 
\
\>", "Chapter",
 CellChangeTimes->{{3.709716007421989*^9, 3.7097160104686728`*^9}, {
  3.709879282450776*^9, 3.7098793094949617`*^9}, {3.7100405889387217`*^9, 
  3.710040593968562*^9}, {3.7100407522967653`*^9, 3.710040752832938*^9}, {
  3.710040822594124*^9, 3.7100408276873493`*^9}, {3.710042782021922*^9, 
  3.7100428102999687`*^9}, {3.711428813014496*^9, 3.711428871895347*^9}, {
  3.7114289446153173`*^9, 3.711429041835001*^9}, {3.714719139340725*^9, 
  3.714719251461725*^9}, {3.71496782088663*^9, 3.714967846748127*^9}, {
  3.715403885833037*^9, 3.715403919748909*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"finalAngles", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.574", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.03", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.258", ",", "0.31"}], "}"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "pitch", " ", "and", " ", "yaw", " ", "takeoff", " ", "angles", " ", "for",
     " ", "3", " ", "conditions", " ", "use", " ", "for", " ", "the", " ", 
    "figures"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"finalAngles", "*", 
  RowBox[{"1", "/", "Degree"}]}]}], "Input",
 CellChangeTimes->{{3.71608995336668*^9, 3.7160899662455*^9}, {
  3.716102766241281*^9, 3.716102767531372*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"32.887777440509254`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"59.01465289847479`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14.78231111437524`", ",", "17.76169164905552`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7160899623704367`*^9, 3.716089966766287*^9}, 
   3.716102769376333*^9, 3.716177031370379*^9, 3.727611832357634*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"-", "SELECT"}]}], " ", "PITCH", " ", "or", " ", "YAW", " ", 
    "modulation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pitchORyaw", "=", "1"}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"1", " ", "for", " ", "pitch"}], ",", " ", 
      RowBox[{"2", " ", "for", " ", "yaw"}], ",", " ", 
      RowBox[{
      "3", " ", "for", " ", "varying", " ", "init", " ", "angle", " ", "and", 
       " ", "compensating", " ", "pitch", " ", "so", " ", "final", " ", 
       "angle", " ", "is", " ", 
       RowBox[{"60", "'"}]}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"femRETminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femRETmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femRETexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibRETminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibRETmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibRETexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarRETminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarRETmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarRETexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftRETminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftRETmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftRETexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femADDminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femADDmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femADDexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibADDminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibADDmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibADDexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarADDminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarADDmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarADDexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftADDminData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftADDmaxData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftADDexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hipexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kneexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ankexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmtexcData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hipexc4dData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kneexc4dData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ankexc4dData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmtexc4dData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vcomAnglesTakeoff", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prepAngleData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stickPlotsInit", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quats1", "=", "quatsi"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"quatFK", "[", 
      RowBox[{"quats1", ",", "lengths", ",", "qref"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limbIinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "limbIinit", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ndata", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"20", ",", "20", ",", "10"}], "}"}], "[", 
      RowBox[{"[", "pitchORyaw", "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "number", " ", "of", " ", "incremental", " ", "target", " ", "angles", 
      " ", "to", " ", "consider"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"maxpitch", "=", "1"}], ";", 
    RowBox[{"maxyaw", "=", "0.47"}], ";", 
    RowBox[{"minpitch", "=", 
     RowBox[{"-", "0.7"}]}], ";", 
    RowBox[{"minyaw", "=", 
     RowBox[{"-", "0.47"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchup", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"maxpitch", "-", "minpitch"}], ")"}], 
            RowBox[{
             RowBox[{"N", "@", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"ndata", "-", "1"}], ")"}]}]}], ")"}]}], "+", 
         "maxpitch"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ndata"}], "}"}]}], "]"}], "//", 
      "Reverse"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yawup", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"maxyaw", "-", "minyaw"}], ")"}], 
            RowBox[{
             RowBox[{"N", "@", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"ndata", "-", "1"}], ")"}]}]}], ")"}]}], "+", 
         "maxyaw"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ndata"}], "}"}]}], "]"}], "//", 
      "Reverse"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"for", " ", "initial", " ", "pitch"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minpitchInit", "=", 
     RowBox[{"-", "0.27"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxpitchInit", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nsteps", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchInitup", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"maxpitchInit", "-", "minpitchInit"}], ")"}], 
            RowBox[{
             RowBox[{"N", "@", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"nsteps", "-", "1"}], ")"}]}]}], ")"}]}], "+", 
         "maxpitchInit"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nsteps"}], "}"}]}], "]"}], "//", 
      "Reverse"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchAnglesComp", "=", 
     RowBox[{"{", 
      RowBox[{
      "2.45", ",", "1.4", ",", "0.95", ",", "0.8", ",", "0.66", ",", "0.54", 
       ",", "0.45", ",", "0.33", ",", "0.2", ",", "0.02"}], "}"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "compensating", " ", "pitch", " ", "angles", " ", "so", " ", "that", 
       " ", "takeoff", " ", "always"}], " ", "=", " ", 
      RowBox[{"60", " ", "deg"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"pitchInitup", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"pitchInitup", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pitchAnglesComp", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"pitchAnglesComp", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Manipulate", "["}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"pitchAngInit", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"pitchInitup", "[", 
           RowBox[{"[", "itr", "]"}], "]"}]}], "}"}], "[", 
        RowBox[{"[", "pitchORyaw", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pitchAng", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pitchup", "[", 
           RowBox[{"[", "itr", "]"}], "]"}], ",", "minpitch", ",", 
          RowBox[{"pitchAnglesComp", "[", 
           RowBox[{"[", "itr", "]"}], "]"}]}], "}"}], "[", 
        RowBox[{"[", "pitchORyaw", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yawAng", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"yawup", "[", 
           RowBox[{"[", "itr", "]"}], "]"}], ",", "0"}], "}"}], "[", 
        RowBox[{"[", "pitchORyaw", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "change", " ", "the", " ", "initial", " ", "body", " ", "axis", " ", 
        "pitch", " ", "without", " ", "influencing", " ", "other", " ", 
        "segments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"qpitchInit", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"pitchAngInit", "+", 
          RowBox[{"0", "*", 
           RowBox[{
            RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bodyInit", "=", 
       RowBox[{
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"limbIinit", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bodyInitRot", "=", 
       RowBox[{"qRot", "[", 
        RowBox[{"qpitchInit", ",", "bodyInit"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"limbInitRot", "=", "limbIinit"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"limbInitRot", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"limbInitRot", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "bodyInitRot"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quats1mod", "=", 
       RowBox[{"limbQUAT", "[", 
        RowBox[{"limbInitRot", ",", "qref"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"quats1", "=", "quats1mod"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"quats2", "=", "quatsfNominal"}], ";", "\[IndentingNewLine]", 
      RowBox[{"qpitch", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"pitchAng", "+", 
          RowBox[{"0", "*", 
           RowBox[{
            RowBox[{"N", "@", "Pi"}], "/", "2"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qyaw", "=", 
       RowBox[{"aaToq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "yawAng"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"qtarget", "=", 
       RowBox[{"qMult", "[", 
        RowBox[{"qyaw", ",", "qpitch"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"quats2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"qMult", "[", 
        RowBox[{"qtarget", ",", 
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"quats2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "qtarget"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", "constrain"}]}]}], " ", "end", " ", "of", " ", "jump",
          " ", "based", " ", "on", " ", "hip", " ", "3", "d", " ", 
         RowBox[{"angle", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"angHip3d", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"hip", " ", "3", "d", " ", "angle"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tt", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"time", " ", "value", " ", "to", " ", "use"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dt", "=", "0.01"}], ";", 
      RowBox[{"(*", 
       RowBox[{"increment", " ", "for", " ", "time"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"angHip3d", "<", 
         RowBox[{"130", "*", 
          RowBox[{"Pi", "/", "180.0"}]}]}], 
        RowBox[{"(*", 
         RowBox[{"hip", " ", "3", "d", " ", "angle", " ", "threshold"}], 
         "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"quatsItest", "=", 
          RowBox[{"limbSlerp", "[", 
           RowBox[{"quats1", ",", "quats2", ",", "tt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"limbItest", "=", 
          RowBox[{"quatFK", "[", 
           RowBox[{"quatsItest", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"limbItest", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"limbItest", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"limbItest", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "limbItest", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"angHip3d", "=", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "-", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"limbItest", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tt", "=", 
          RowBox[{"tt", "+", "dt"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "scale", " ", "the", " ", "timefun", " ", "according", " ", "to", " ", 
        "tt", " ", "to", " ", "try", " ", "to", " ", "have", " ", "the", " ", 
        "same", " ", "velocity", " ", "profile"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"timeTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"time", "*", "tt"}], ",", 
           RowBox[{"tt", "*", "timefun"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"time", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"nsamples", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"timefunScaled", "=", 
       RowBox[{"Interpolation", "[", "timeTable", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"npoints", "=", "50"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "number", " ", "of", " ", "points", " ", "to", " ", "make", " ", 
        "graphs"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PNTSi", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"quatsI", "=", 
           RowBox[{"limbSlerp", "[", 
            RowBox[{"quats1", ",", "quats2", ",", 
             RowBox[{"timefunScaled", "[", 
              RowBox[{"(", 
               RowBox[{"tt", "*", "relTime"}], ")"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"limbI1", "=", 
           RowBox[{"quatFK", "[", 
            RowBox[{"quatsI", ",", "lengths", ",", "qref"}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"limbI", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"limbI1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"limbI1", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "limbI1", "]"}]}], "}"}]}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"relTime", ",", "0", ",", "1", ",", 
           RowBox[{"1.0", "/", 
            RowBox[{"(", 
             RowBox[{"npoints", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
      "\n", "\[IndentingNewLine]", 
      RowBox[{"stickPlot", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Line", "[", 
           RowBox[{"PNTSi", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "1"}], ";;", "5"}], "]"}], "]"}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phifemLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thefemRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phifemRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"thetibLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitibLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thetibRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitibRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"thetarLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitarLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thetarRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phitarRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phipftLdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thepftRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phipftRdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hipAng3dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kneAng3dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ankAng3dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmtAng3dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hipAng4dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kneAng4dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ankAng4dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmtAng4dData", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"comXdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"comYdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"comZdata", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"limbL", "=", 
          RowBox[{"PNTSi", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vbodL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vfemL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtibL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtarL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vpftL", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"bodyaxis", "=", 
          RowBox[{
           RowBox[{"limbL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"limbL", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bodyyaw", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"VectorAngle", "[", 
             RowBox[{
              RowBox[{"bodyaxis", "*", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "*", 
           RowBox[{"Sign", "[", "yawAng", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bodypitch", "=", 
          RowBox[{
           RowBox[{"Pi", "/", "2"}], "-", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{"bodyaxis", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"t1L", "=", "0"}], ";", 
         RowBox[{"t2L", "=", "1.0"}], ";", 
         RowBox[{"t3L", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"N", "@", "Pi"}]}], "/", "2"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"theta", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"p1L", "=", 
          RowBox[{
           RowBox[{"N", "@", "Pi"}], "/", "2"}]}], ";", 
         RowBox[{"p2L", "=", 
          RowBox[{"-", "1."}]}], ";", 
         RowBox[{"p3L", "=", "0"}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"phi", " ", "offsets"}], ",", " ", "Left"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "3"}]}]}]}]}]}], "D", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ANGLES", "--"}], "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"hipAng3d", "=", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"vbodL", ",", "vfemL"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kneAng3d", "=", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"vfemL", ",", "vtibL"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ankAng3d", "=", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"vtibL", ",", "vtarL"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmtAng3d", "=", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"vtarL", ",", "vpftL"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", "4"}]}]}]}]}]}], "D", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ANGLES", "--"}], "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"quatsL", "=", 
          RowBox[{"limbQUAT", "[", 
           RowBox[{"limbL", ",", "qref"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"angles4d", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"VectorAngle", "[", 
             RowBox[{
              RowBox[{"quatsL", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"quatsL", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "quatsL", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", "com"}]}], " ", 
           RowBox[{
            RowBox[{"data", "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"comXdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"comXdata", ",", 
            RowBox[{"{", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"comYdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"comYdata", ",", 
            RowBox[{"{", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"comZdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"comZdata", ",", 
            RowBox[{"{", 
             RowBox[{"limbL", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "3"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"order", " ", "is", " ", "r"}], ",", " ", "phi", ",", " ", 
           "theta"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thefemL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vfemL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"<", 
           RowBox[{
            RowBox[{"--", "note"}], " ", "negatives", " ", "for", " ", 
            "knee"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"thetibL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibL", "=", 
          RowBox[{
           RowBox[{"-", "p1L"}], "-", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtibL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetarL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vtarL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thepftL", "=", 
          RowBox[{"t1L", "+", 
           RowBox[{"t2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", "t3L"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftL", "=", 
          RowBox[{"p1L", "+", 
           RowBox[{"p2L", "*", 
            RowBox[{
             RowBox[{"toSpherical", "[", "vpftL", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", "p3L"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thefemLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thefemLdata", ",", 
            RowBox[{"{", "thefemL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phifemLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phifemLdata", ",", 
            RowBox[{"{", "phifemL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetibLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetibLdata", ",", 
            RowBox[{"{", "thetibL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitibLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitibLdata", ",", 
            RowBox[{"{", "phitibL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thetarLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetarLdata", ",", 
            RowBox[{"{", "thetarL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phitarLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phitarLdata", ",", 
            RowBox[{"{", "phitarL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"thepftLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thepftLdata", ",", 
            RowBox[{"{", "thepftL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipftLdata", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phipftLdata", ",", 
            RowBox[{"{", "phipftL", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hipAng3dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"hipAng3dData", ",", 
            RowBox[{"{", "hipAng3d", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kneAng3dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"kneAng3dData", ",", 
            RowBox[{"{", "kneAng3d", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ankAng3dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ankAng3dData", ",", 
            RowBox[{"{", "ankAng3d", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmtAng3dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"tmtAng3dData", ",", 
            RowBox[{"{", "tmtAng3d", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hipAng4dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"hipAng4dData", ",", 
            RowBox[{"{", 
             RowBox[{"angles4d", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kneAng4dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"kneAng4dData", ",", 
            RowBox[{"{", 
             RowBox[{"angles4d", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ankAng4dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ankAng4dData", ",", 
            RowBox[{"{", 
             RowBox[{"angles4d", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmtAng4dData", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"tmtAng4dData", ",", 
            RowBox[{"{", 
             RowBox[{"angles4d", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "}"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "PNTSi", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vcomX", "=", 
       RowBox[{"Differentiator1D", "[", 
        RowBox[{"comXdata", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vcomY", "=", 
       RowBox[{"Differentiator1D", "[", 
        RowBox[{"comYdata", ",", "2", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vcomZ", "=", 
       RowBox[{"Differentiator1D", "[", 
        RowBox[{"comZdata", ",", "3", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vcomAngle", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"vcomY", ",", "vcomZ"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vcomAngleDev", "=", 
       RowBox[{"60", "-", "vcomAngle"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"deviation", " ", "from", " ", "60", " ", "degrees"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vcomAnglesTakeoff", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"vcomAnglesTakeoff", ",", 
         RowBox[{"{", 
          RowBox[{"vcomAngle", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bodyAxisInit", "=", 
       RowBox[{
        RowBox[{"PNTSi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"PNTSi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prepAngle", "=", 
       RowBox[{"VectorAngle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "bodyAxisInit"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prepAngleData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"prepAngleData", ",", 
         RowBox[{"{", "prepAngle", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"-", "make"}]}], " ", "a", " ", "plot", " ", "of", " ", 
         "side", " ", "view", " ", "stick", " ", "figure", " ", "with", " ", 
         "vel", " ", "vector", " ", "showing", " ", "init", " ", "prep", " ", 
         
         RowBox[{
          RowBox[{"angle", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"limbInit", "=", 
       RowBox[{"PNTSi", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"velscale", "=", "40"}], ";", "\[IndentingNewLine]", 
      RowBox[{"velVector", "=", 
       RowBox[{"velscale", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vcomX", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"vcomY", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"vcomZ", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"velVectorPnts", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PNTSi", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"PNTSi", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "+", 
          "velVector"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"stickPlotInit", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{"limbInit", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], 
               "}"}]}], ","}], "*)"}], 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Right"}], ",", 
           RowBox[{"ViewAngle", "\[Rule]", ".4"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", 
            RowBox[{"Setting", "[", 
             
             ColorSetterBox[RGBColor[
              0.7253376058594644, 0.7253376058594644, 0.7253376058594644], 
              "Swatch"], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"PNTSi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"-", "1"}], ";;", "6"}], "]"}], "]"}], "]"}]}], "}"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
            RowBox[{"Line", "[", "limbInit", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.005", "]"}], ",", "Red", ",", 
            RowBox[{"Arrowheads", "[", "0.015", "]"}], ",", 
            RowBox[{"Arrow", "[", "velVectorPnts", "]"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"itr", "\[Equal]", "1"}], "||", 
         RowBox[{"itr", "\[Equal]", "7"}], "||", 
         RowBox[{"itr", "\[Equal]", "10"}]}], ",", 
        RowBox[{"stickPlotsInit", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"stickPlotsInit", ",", 
           RowBox[{"{", "stickPlotInit", "}"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"##", "&"}], "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thefemLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phifemLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phifemLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetibLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thetibLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phitibLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetarLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thetarLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phitarLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "thepftLdata"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftLdata", "=", 
       RowBox[{
        RowBox[{"1.", "/", "Degree"}], "  ", 
        RowBox[{"unwrapPhase", "@", "phipftLdata"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ndat", "=", 
       RowBox[{"Length", "[", "phifemLdata", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"datTimeValues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"ndat", "-", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ndat"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thefemLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thefemLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phifemLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phifemLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetibLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thetibLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitibLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phitibLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thetarLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thetarLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phitarLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phitarLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"thepftLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "thepftLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phipftLdataXY", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"datTimeValues", ",", "phipftLdata"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "RETRACTION"}]}]}], " ", "SUMMARY", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"DATA", "--"}], "--"}], "--"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"femRETmin", "=", 
       RowBox[{"Min", "[", "thefemLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"femRETmax", "=", 
       RowBox[{"Max", "[", "thefemLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"femRETexc", "=", 
       RowBox[{"femRETmax", "-", "femRETmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tibRETmin", "=", 
       RowBox[{"Min", "[", "thetibLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tibRETmax", "=", 
       RowBox[{"Max", "[", "thetibLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tibRETexc", "=", 
       RowBox[{"tibRETmax", "-", "tibRETmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tarRETmin", "=", 
       RowBox[{"Min", "[", "thetarLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tarRETmax", "=", 
       RowBox[{"Max", "[", "thetarLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tarRETexc", "=", 
       RowBox[{"tarRETmax", "-", "tarRETmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pftRETmin", "=", 
       RowBox[{"Min", "[", "thepftLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pftRETmax", "=", 
       RowBox[{"Max", "[", "thepftLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pftRETexc", "=", 
       RowBox[{"pftRETmax", "-", "pftRETmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "ADDUCTION"}]}]}], " ", "SUMMARY", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"DATA", "--"}], "--"}], "--"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"femADDmin", "=", 
       RowBox[{"Min", "[", "phifemLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"femADDmax", "=", 
       RowBox[{"Max", "[", "phifemLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"femADDexc", "=", 
       RowBox[{"femADDmax", "-", "femADDmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tibADDmin", "=", 
       RowBox[{"Min", "[", "phitibLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tibADDmax", "=", 
       RowBox[{"Max", "[", "phitibLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tibADDexc", "=", 
       RowBox[{"tibADDmax", "-", "tibADDmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tarADDmin", "=", 
       RowBox[{"Min", "[", "phitarLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tarADDmax", "=", 
       RowBox[{"Max", "[", "phitarLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tarADDexc", "=", 
       RowBox[{"tarADDmax", "-", "tarADDmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pftADDmin", "=", 
       RowBox[{"Min", "[", "phipftLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pftADDmax", "=", 
       RowBox[{"Max", "[", "phipftLdata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pftADDexc", "=", 
       RowBox[{"pftADDmax", "-", "pftADDmin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"-", "GATHER"}]}], " ", 
         RowBox[{"DATA", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"femRETminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"femRETminData", ",", 
         RowBox[{"{", "femRETmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"femRETmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"femRETmaxData", ",", 
         RowBox[{"{", "femRETmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"femRETexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"femRETexcData", ",", 
         RowBox[{"{", "femRETexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tibRETminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tibRETminData", ",", 
         RowBox[{"{", "tibRETmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tibETmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tibRETmaxData", ",", 
         RowBox[{"{", "tibRETmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tibRETexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tibRETexcData", ",", 
         RowBox[{"{", "tibRETexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tarRETminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tarRETminData", ",", 
         RowBox[{"{", "tarRETmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tarETmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tarRETmaxData", ",", 
         RowBox[{"{", "tarRETmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tarRETexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tarRETexcData", ",", 
         RowBox[{"{", "tarRETexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pftRETminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pftRETminData", ",", 
         RowBox[{"{", "pftRETmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pftRETmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pftRETmaxData", ",", 
         RowBox[{"{", "pftRETmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pftRETexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pftRETexcData", ",", 
         RowBox[{"{", "pftRETexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"femADDminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"femADDminData", ",", 
         RowBox[{"{", "femADDmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"femADDmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"femADDmaxData", ",", 
         RowBox[{"{", "femADDmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"femADDexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"femADDexcData", ",", 
         RowBox[{"{", "femADDexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tibADDminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tibADDminData", ",", 
         RowBox[{"{", "tibADDmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tibETmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tibADDmaxData", ",", 
         RowBox[{"{", "tibADDmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tibADDexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tibADDexcData", ",", 
         RowBox[{"{", "tibADDexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tarADDminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tarADDminData", ",", 
         RowBox[{"{", "tarADDmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tarETmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tarADDmaxData", ",", 
         RowBox[{"{", "tarADDmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tarADDexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tarADDexcData", ",", 
         RowBox[{"{", "tarADDexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pftADDminData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pftADDminData", ",", 
         RowBox[{"{", "pftADDmin", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pftADDmaxData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pftADDmaxData", ",", 
         RowBox[{"{", "pftADDmax", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pftADDexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pftADDexcData", ",", 
         RowBox[{"{", "pftADDexc", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "3"}]}]}]}]}], "D"}], " ", "&"}], " ", "4", "D", 
        " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"angles", " ", "--"}], "--"}], "--"}], "--"}], 
                "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
         "--"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hipexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"hipexcData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "hipAng3dData", "]"}], "-", 
           RowBox[{"Min", "[", "hipAng3dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"kneexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"kneexcData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "kneAng3dData", "]"}], "-", 
           RowBox[{"Min", "[", "kneAng3dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ankexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ankexcData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "ankAng3dData", "]"}], "-", 
           RowBox[{"Min", "[", "ankAng3dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"tmtexcData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tmtexcData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "tmtAng3dData", "]"}], "-", 
           RowBox[{"Min", "[", "tmtAng3dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hipexc4dData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"hipexc4dData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "hipAng4dData", "]"}], "-", 
           RowBox[{"Min", "[", "hipAng4dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"kneexc4dData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"kneexc4dData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "kneAng4dData", "]"}], "-", 
           RowBox[{"Min", "[", "kneAng4dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ankexc4dData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ankexc4dData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "ankAng4dData", "]"}], "-", 
           RowBox[{"Min", "[", "ankAng4dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"tmtexc4dData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"tmtexc4dData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", "tmtAng4dData", "]"}], "-", 
           RowBox[{"Min", "[", "tmtAng4dData", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ang", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pitchAng", ",", "yawAng"}], "}"}], "[", 
          RowBox[{"[", "pitchORyaw", "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ang", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bodypitch", ",", "bodyyaw", ",", 
          RowBox[{"pitchInitup", "[", 
           RowBox[{"[", "itr", "]"}], "]"}]}], "}"}], "[", 
        RowBox[{"[", "pitchORyaw", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"angData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1.", "/", "Degree"}], ")"}], "ang"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"pitchData", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pitchData", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1.", "/", "Degree"}], ")"}], "bodypitch"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"status", "=", 
       RowBox[{"{", 
        RowBox[{"itr", ",", 
         RowBox[{"(*", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "hipAng3dData", ",", "kneAng3dData", ",", "ankAng3dData", ",", 
              "tmtAng3dData"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3.5"}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "colors"}]}], "]"}], "*)"}], 
         RowBox[{"(*", "stickPlot", "*)"}], 
         RowBox[{"ListPlot", "[", 
          RowBox[{"vcomAngleDev", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "50"}], ",", "50"}], "}"}]}], "}"}]}]}], "]"}], 
         ",", "pitchAng", ",", "yawAng"}], "}"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"itr", ",", "10", ",", "10"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vcomAngleData", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1.", "/", "Degree"}], " ", "prepAngleData"}], ",", 
        "vcomAnglesTakeoff"}], "}"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710169693014718*^9, 3.710169722473415*^9}, {
   3.710169776777179*^9, 3.710169896658449*^9}, {3.710169964032371*^9, 
   3.7101700778126717`*^9}, {3.710170109012896*^9, 3.7101701323126097`*^9}, {
   3.710170193321117*^9, 3.710170206617949*^9}, {3.7101702419653997`*^9, 
   3.710170277994153*^9}, {3.710170317995895*^9, 3.710170387549094*^9}, {
   3.7101746406510477`*^9, 3.710174668532082*^9}, 3.7101747801280403`*^9, {
   3.710175061073135*^9, 3.7101750686058693`*^9}, {3.7101751050342417`*^9, 
   3.7101751495240602`*^9}, {3.7101751917158823`*^9, 3.710175191815586*^9}, {
   3.710175258271051*^9, 3.71017536388102*^9}, 3.7101754330840054`*^9, {
   3.710175472939744*^9, 3.710175520522954*^9}, {3.710175569778688*^9, 
   3.710175572728292*^9}, 3.710175626830142*^9, {3.7101757517186937`*^9, 
   3.710175805726012*^9}, {3.710219339558475*^9, 3.710219444527022*^9}, {
   3.710219504239189*^9, 3.710219507541676*^9}, {3.710219575805872*^9, 
   3.7102196400250053`*^9}, {3.710219690778541*^9, 3.710219762323306*^9}, {
   3.710233722740574*^9, 3.710233750507526*^9}, {3.710233806807139*^9, 
   3.710233934516354*^9}, {3.7113589756499777`*^9, 3.711358976119001*^9}, {
   3.711359073041408*^9, 3.711359082319186*^9}, {3.711359280211893*^9, 
   3.711359285803252*^9}, 3.711367534508868*^9, {3.7113798903093243`*^9, 
   3.7113798915871143`*^9}, {3.711380086192844*^9, 3.711380122149983*^9}, {
   3.711380196401441*^9, 3.711380251612158*^9}, 3.711380332512714*^9, {
   3.711380393420784*^9, 3.7113804286024427`*^9}, 3.711427613965941*^9, {
   3.711427651925507*^9, 3.7114276521539516`*^9}, 3.711427822498521*^9, {
   3.711427859817264*^9, 3.711427860925984*^9}, 3.7114283633131943`*^9, 
   3.7114284801380863`*^9, 3.711428983673514*^9, {3.711429192637282*^9, 
   3.711429276043722*^9}, {3.711429340465996*^9, 3.71142947352175*^9}, {
   3.711429516880639*^9, 3.711429516958269*^9}, {3.711429590149376*^9, 
   3.7114295911331673`*^9}, {3.71471886390823*^9, 3.714718882014119*^9}, {
   3.714718915953137*^9, 3.71471892571171*^9}, 3.714718956808804*^9, {
   3.714724585702256*^9, 3.714724716945765*^9}, {3.7147248235489187`*^9, 
   3.7147248248771*^9}, {3.714724905020402*^9, 3.7147249110122747`*^9}, {
   3.714724960455717*^9, 3.714724999202044*^9}, {3.714725032058667*^9, 
   3.714725116886743*^9}, {3.714725165711494*^9, 3.714725225821299*^9}, {
   3.714725340417714*^9, 3.71472534193587*^9}, {3.714725874667273*^9, 
   3.714726071997221*^9}, {3.714726106116826*^9, 3.7147262087382097`*^9}, {
   3.7147262422549257`*^9, 3.714726248175321*^9}, {3.7147267237379417`*^9, 
   3.714726734730859*^9}, {3.714726863867605*^9, 3.714726883524878*^9}, {
   3.714726974175983*^9, 3.714726997935454*^9}, {3.7147270411084547`*^9, 
   3.714727045476409*^9}, {3.7147271555363617`*^9, 3.714727160944395*^9}, {
   3.714727254599387*^9, 3.714727260406187*^9}, {3.714727295598983*^9, 
   3.714727296405944*^9}, {3.714727550661826*^9, 3.714728220220894*^9}, {
   3.714728263435937*^9, 3.7147282648907547`*^9}, {3.714728432890469*^9, 
   3.714728532949445*^9}, {3.7147285648190193`*^9, 3.714728625938442*^9}, {
   3.714728659912203*^9, 3.714728715116406*^9}, {3.714728944829123*^9, 
   3.7147289706632833`*^9}, {3.714799729516824*^9, 3.714799752722495*^9}, {
   3.7147998137239113`*^9, 3.714799823926734*^9}, {3.714799855816812*^9, 
   3.714799874780952*^9}, {3.714799938777959*^9, 3.714799940984167*^9}, {
   3.714800018648486*^9, 3.7148000729435787`*^9}, {3.714800136157236*^9, 
   3.714800202993504*^9}, {3.714880244989093*^9, 3.714880332859972*^9}, {
   3.714880463849522*^9, 3.7148804753839397`*^9}, {3.7148805884904747`*^9, 
   3.714880594744421*^9}, {3.714881444967393*^9, 3.714881607108062*^9}, {
   3.7148816565086718`*^9, 3.714881672913887*^9}, {3.7148817219062243`*^9, 
   3.7148817703832483`*^9}, {3.7148818253744707`*^9, 
   3.7148818681327953`*^9}, {3.714881899153205*^9, 3.7148819416352158`*^9}, {
   3.714881985649289*^9, 3.714882019053645*^9}, {3.714882067411428*^9, 
   3.714882321783688*^9}, {3.7148823551669807`*^9, 3.714882425037527*^9}, {
   3.7148826253568697`*^9, 3.714882629297477*^9}, 3.714883528266871*^9, {
   3.71496755941925*^9, 3.7149675762822447`*^9}, {3.7149676623889217`*^9, 
   3.7149676697726727`*^9}, {3.714967723774634*^9, 3.714967736644435*^9}, {
   3.714968524620832*^9, 3.714968530593789*^9}, {3.7150566985407343`*^9, 
   3.715056699880807*^9}, {3.715056756363603*^9, 3.715056769679932*^9}, {
   3.715056825885113*^9, 3.715056827515821*^9}, {3.715057012070105*^9, 
   3.715057014966639*^9}, {3.715057071041381*^9, 3.715057126900285*^9}, {
   3.715057177358343*^9, 3.7150571970334997`*^9}, {3.715057253171925*^9, 
   3.715057320471798*^9}, {3.715062395499571*^9, 3.7150624674981318`*^9}, {
   3.715062536189651*^9, 3.715062563009695*^9}, {3.715062910439213*^9, 
   3.7150629183385572`*^9}, {3.7150629935256653`*^9, 3.715063018966915*^9}, {
   3.715063213639283*^9, 3.715063419275593*^9}, {3.715063534210903*^9, 
   3.7150635480675592`*^9}, {3.715063578457529*^9, 3.7150636354104958`*^9}, 
   3.71506375142588*^9, 3.7150639061330843`*^9, {3.715063965039791*^9, 
   3.7150639673157167`*^9}, 3.715064556592204*^9, {3.7150646076050243`*^9, 
   3.7150646077339773`*^9}, {3.715404254912579*^9, 3.7154042953489037`*^9}, {
   3.715404348237508*^9, 3.71540434933809*^9}, {3.7154043824015408`*^9, 
   3.7154044057576523`*^9}, 3.715404444277432*^9, {3.715404654206983*^9, 
   3.7154047537894173`*^9}, {3.715404797265313*^9, 3.715404828095598*^9}, {
   3.7154048584776993`*^9, 3.715404868053134*^9}, {3.715404899667766*^9, 
   3.7154048997292843`*^9}, {3.715404961011183*^9, 3.715404961627893*^9}, {
   3.715405021620867*^9, 3.715405031987691*^9}, {3.715405082062055*^9, 
   3.7154050847199917`*^9}, {3.7154051271629972`*^9, 3.715405195091359*^9}, {
   3.715405296823638*^9, 3.715405296906559*^9}, {3.7154107672910023`*^9, 
   3.715410774531891*^9}, {3.7154110425022*^9, 3.715411087608632*^9}, {
   3.715419281415717*^9, 3.715419283074294*^9}, {3.715419318422675*^9, 
   3.7154193484533653`*^9}, {3.715419432339196*^9, 3.7154194438790483`*^9}, {
   3.715419562284645*^9, 3.715419569557371*^9}, {3.715419895867753*^9, 
   3.7154199752731533`*^9}, {3.71608968719575*^9, 3.71608968930783*^9}, 
   3.7160899427031803`*^9, {3.716101668463254*^9, 3.7161017093813543`*^9}, 
   3.7161018236780367`*^9, {3.716101909048895*^9, 3.716101910699367*^9}, {
   3.716199580591099*^9, 3.716199594785852*^9}, {3.716199724187787*^9, 
   3.716199767508195*^9}, {3.716199925066869*^9, 3.7161999279618807`*^9}, 
   3.7162000261520243`*^9, {3.7162017164382067`*^9, 3.716201934078307*^9}, {
   3.716201973826441*^9, 3.716202057149208*^9}, {3.7162021083079863`*^9, 
   3.7162021084718523`*^9}, {3.716202152334682*^9, 3.716202169738559*^9}, 
   3.7162222969575653`*^9, {3.7162223426622562`*^9, 3.716222515561318*^9}, {
   3.7162226166887608`*^9, 3.71622269838625*^9}, {3.7162234348724957`*^9, 
   3.716223435702057*^9}, {3.7162236257454977`*^9, 3.7162236340727587`*^9}, {
   3.716223706271297*^9, 3.716223804370322*^9}, 3.716224025801704*^9, {
   3.716224272173275*^9, 3.716224289469131*^9}, {3.716224373948374*^9, 
   3.716224374601152*^9}, {3.7162244208054457`*^9, 3.7162244325241137`*^9}, {
   3.7162635055631657`*^9, 3.716263513881781*^9}, {3.716263742306798*^9, 
   3.716263767289282*^9}, {3.716263825135014*^9, 3.716263849083647*^9}, {
   3.716263921999103*^9, 3.716263962762536*^9}, {3.7162639981201077`*^9, 
   3.716264001918099*^9}, {3.716264083403569*^9, 3.7162641451406937`*^9}, {
   3.716264176940906*^9, 3.71626419189966*^9}, {3.716264280446396*^9, 
   3.71626430858383*^9}, {3.716264339897531*^9, 3.716264339997113*^9}, {
   3.7162900533717747`*^9, 3.7162900564265537`*^9}, {3.7162904275998373`*^9, 
   3.716290477756963*^9}, 3.716526705399876*^9, {3.716527676090426*^9, 
   3.716527676174478*^9}, {3.716528182174737*^9, 3.7165281822753887`*^9}, {
   3.716528223628978*^9, 3.716528223729575*^9}, {3.716628742445109*^9, 
   3.7166287797238007`*^9}, {3.716628940028659*^9, 3.716628952920744*^9}, {
   3.716629160071164*^9, 3.716629161437224*^9}, {3.716629197910779*^9, 
   3.716629276936717*^9}, {3.716629312081962*^9, 3.71662931946943*^9}, {
   3.716629389741761*^9, 3.71662939391223*^9}, {3.716629491327264*^9, 
   3.7166294949979057`*^9}, {3.7166295840398197`*^9, 3.716629630147809*^9}, {
   3.7166296735292053`*^9, 3.7166296854862967`*^9}, {3.716629731833665*^9, 
   3.7166298241537046`*^9}, {3.716630020024796*^9, 3.716630037942437*^9}, {
   3.716630088486381*^9, 3.7166301011045437`*^9}, 3.716630382162944*^9, 
   3.7166304433791018`*^9, {3.716640020797002*^9, 3.716640024923306*^9}, {
   3.716640169991308*^9, 3.716640177813233*^9}, {3.716640261861224*^9, 
   3.716640281618952*^9}, {3.716640328122315*^9, 3.71664040539394*^9}, {
   3.716640758588044*^9, 3.716640828695231*^9}, {3.7166408589495897`*^9, 
   3.716640872080327*^9}, {3.7166409057807217`*^9, 3.716640973507595*^9}, {
   3.716693012510715*^9, 3.716693188034637*^9}, {3.716693958549954*^9, 
   3.7166940127719088`*^9}, {3.7166940437094297`*^9, 3.716694091105822*^9}, {
   3.716697866448275*^9, 3.716697942262117*^9}, 3.71669806853598*^9, {
   3.716698106401924*^9, 3.716698226784774*^9}, {3.716698280844063*^9, 
   3.716698282242044*^9}, {3.716698322517997*^9, 3.7166983281445312`*^9}, {
   3.71669838018347*^9, 3.716698386177391*^9}, {3.716698701104609*^9, 
   3.716698712640238*^9}, {3.716698762844667*^9, 3.7166987753956537`*^9}, {
   3.716698996714142*^9, 3.716699017714076*^9}, 3.727611802308826*^9, {
   3.727611868972932*^9, 3.7276120125020103`*^9}, {3.727612051605447*^9, 
   3.727612089611855*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", "status", "]"}]], "Input",
 CellChangeTimes->{{3.7166294508989353`*^9, 3.716629451744681*^9}, 
   3.71664008725532*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`status, StandardForm],
  ImageSizeCache->{321., {48., 53.}}]], "Output",
 CellChangeTimes->{3.716629452187364*^9, 3.716640087823571*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"colorsmod", "=", "colors"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colorsmod", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "=", "Transparent"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femRETexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "femRETexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibRETexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "tibRETexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarRETexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "tarRETexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftRETexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "pftRETexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"femADDexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "femADDexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tibADDexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "tibADDexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tarADDexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "tarADDexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pftADDexcDataXY", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"angData", ",", "pftADDexcData"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dashthickness", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pointsize", "=", "0.02"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles1", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "pointsize", "]"}], ",", "colorsmod"}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"lineStyles2", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Dashing", "[", "0.02", "]"}], ",", 
         RowBox[{"Thickness", "[", "dashthickness", "]"}], ",", "colorsmod"}],
         "}"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles2", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "pointsize", "]"}], ",", "colorsmod"}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineStyles3", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", 
         RowBox[{"pointsize", "*", "0.6"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"White", ",", "White", ",", "White"}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"plotPitch", "=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "femRETexcDataXY", ",", "tibRETexcDataXY", ",", "tarRETexcDataXY"}],
           "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles1"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "160"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "femRETexcDataXY", ",", "tibRETexcDataXY", ",", 
             "tarRETexcDataXY"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "colors"}]}], "]"}], ","}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "femADDexcDataXY", ",", "tibADDexcDataXY", ",", "tarADDexcDataXY"}],
           "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles2"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "femADDexcDataXY", ",", "tibADDexcDataXY", ",", "tarADDexcDataXY"}],
           "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles3"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"plotYaw", "=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "femRETexcDataXY", ",", "tibRETexcDataXY", ",", 
            "tarRETexcDataXY"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "colors"}]}], "]"}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "femADDexcDataXY", ",", "tibADDexcDataXY", ",", "tarADDexcDataXY"}],
           "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles2"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "style"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "160"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "axStyle"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "femADDexcDataXY", ",", "tibADDexcDataXY", ",", "tarADDexcDataXY"}],
           "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles3"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "femRETexcDataXY", ",", "tibRETexcDataXY", ",", "tarRETexcDataXY"}],
           "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "lineStyles1"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotPitchInit", "=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{"vcomAngleData", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "60"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"47.5", ",", "60"}], "}"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Black", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"47.5", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"47.5", ",", "60"}], "}"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle3dDATA", "=", 
     RowBox[{"{", 
      RowBox[{
      "hipexcData", ",", "kneexcData", ",", "ankexcData", ",", "tmtexcData"}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle4dDATA", "=", 
     RowBox[{"{", 
      RowBox[{
      "hipexc4dData", ",", "kneexc4dData", ",", "ankexc4dData", ",", 
       "tmtexc4dData"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", "For"}], " ", "ranges", " ", "of", " ", "3", "D", " ", 
     RowBox[{
      RowBox[{"angles", "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"angle3dDATA", ",", 
     RowBox[{"PlotStyle", "\[Rule]", "colors"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "/", "Degree"}], " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"angle3dDATA", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
       RowBox[{"Min", "[", 
        RowBox[{"angle3dDATA", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "/", "Degree"}], " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"angle4dDATA", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
       RowBox[{"Min", "[", 
        RowBox[{"angle4dDATA", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exc3dNominal", "=", 
     RowBox[{
      RowBox[{"1", "/", "Degree"}], " ", 
      RowBox[{"angle3dDATA", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "7"}], "]"}], "]"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"3", "d", " ", "excersions", " ", "for", " ", "hip"}], ",", " ",
       "knee", ",", " ", "ank", ",", " ", 
      RowBox[{"tmt", " ", "for", " ", "nominal", " ", "case"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"exc4dNominal", "=", 
     RowBox[{
      RowBox[{"1", "/", "Degree"}], " ", 
      RowBox[{"angle4dDATA", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "7"}], "]"}], "]"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"4", "d", " ", "excersions", " ", "for", " ", "hip"}], ",", " ",
       "knee", ",", " ", "ank", ",", " ", 
      RowBox[{"tmt", " ", "for", " ", "nominal", " ", "case"}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\"\<Nominal simulation excursion for hip, knee, ankle, tmt 3D\>\""}], 
   "\[IndentingNewLine]", "exc3dNominal", "\[IndentingNewLine]", 
   "\"\<Nominal simulation excursion for hip, knee, ankle, tmt 4D\>\"", 
   "\[IndentingNewLine]", "exc4dNominal", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.710169693014718*^9, 3.710169722473415*^9}, {
   3.710169776777179*^9, 3.710169896658449*^9}, {3.710169964032371*^9, 
   3.7101700778126717`*^9}, {3.710170109012896*^9, 3.7101701323126097`*^9}, {
   3.710170193321117*^9, 3.710170206617949*^9}, {3.7101702419653997`*^9, 
   3.710170277994153*^9}, {3.710170317995895*^9, 3.710170387549094*^9}, {
   3.7101746406510477`*^9, 3.710174668532082*^9}, 3.7101747801280403`*^9, {
   3.710175061073135*^9, 3.7101750686058693`*^9}, {3.7101751050342417`*^9, 
   3.7101751495240602`*^9}, {3.7101751917158823`*^9, 3.710175191815586*^9}, {
   3.710175258271051*^9, 3.71017536388102*^9}, 3.7101754330840054`*^9, {
   3.710175472939744*^9, 3.710175520522954*^9}, {3.710175569778688*^9, 
   3.710175572728292*^9}, 3.710175626830142*^9, {3.7101757517186937`*^9, 
   3.710175805726012*^9}, {3.710219339558475*^9, 3.710219444527022*^9}, {
   3.710219504239189*^9, 3.710219507541676*^9}, {3.710219575805872*^9, 
   3.7102196400250053`*^9}, {3.710219690778541*^9, 3.710219762323306*^9}, {
   3.710233722740574*^9, 3.710233750507526*^9}, {3.710233806807139*^9, 
   3.710233934516354*^9}, {3.7113589756499777`*^9, 3.711358976119001*^9}, {
   3.711359073041408*^9, 3.711359082319186*^9}, {3.711359280211893*^9, 
   3.711359285803252*^9}, 3.711367534508868*^9, {3.7113798903093243`*^9, 
   3.7113798915871143`*^9}, {3.711380086192844*^9, 3.711380122149983*^9}, {
   3.711380196401441*^9, 3.711380251612158*^9}, 3.711380332512714*^9, {
   3.711380393420784*^9, 3.7113804286024427`*^9}, 3.711427613965941*^9, {
   3.711427651925507*^9, 3.7114276521539516`*^9}, 3.711427822498521*^9, {
   3.711427859817264*^9, 3.711427860925984*^9}, 3.7114283633131943`*^9, 
   3.7114284801380863`*^9, 3.711428983673514*^9, {3.711429192637282*^9, 
   3.711429276043722*^9}, {3.711429340465996*^9, 3.71142947352175*^9}, {
   3.711429516880639*^9, 3.711429516958269*^9}, {3.711429590149376*^9, 
   3.7114295911331673`*^9}, {3.71471886390823*^9, 3.714718882014119*^9}, {
   3.714718915953137*^9, 3.71471892571171*^9}, 3.714718956808804*^9, {
   3.714724585702256*^9, 3.714724716945765*^9}, {3.7147248235489187`*^9, 
   3.7147248248771*^9}, {3.714724905020402*^9, 3.7147249110122747`*^9}, {
   3.714724960455717*^9, 3.714724999202044*^9}, {3.714725032058667*^9, 
   3.714725116886743*^9}, {3.714725165711494*^9, 3.714725225821299*^9}, {
   3.714725340417714*^9, 3.71472534193587*^9}, {3.714725874667273*^9, 
   3.714726071997221*^9}, {3.714726106116826*^9, 3.7147262087382097`*^9}, {
   3.7147262422549257`*^9, 3.714726248175321*^9}, {3.7147267237379417`*^9, 
   3.714726734730859*^9}, {3.714726863867605*^9, 3.714726883524878*^9}, {
   3.714726974175983*^9, 3.714726997935454*^9}, {3.7147270411084547`*^9, 
   3.714727045476409*^9}, {3.7147271555363617`*^9, 3.714727160944395*^9}, {
   3.714727254599387*^9, 3.714727260406187*^9}, {3.714727295598983*^9, 
   3.714727296405944*^9}, {3.714727550661826*^9, 3.714728220220894*^9}, {
   3.714728263435937*^9, 3.7147282648907547`*^9}, {3.714728432890469*^9, 
   3.714728532949445*^9}, {3.7147285648190193`*^9, 3.714728625938442*^9}, {
   3.714728659912203*^9, 3.714728715116406*^9}, {3.714728944829123*^9, 
   3.7147289706632833`*^9}, {3.714799729516824*^9, 3.714799752722495*^9}, {
   3.7147998137239113`*^9, 3.714799823926734*^9}, {3.714799855816812*^9, 
   3.714799874780952*^9}, {3.714799938777959*^9, 3.714799940984167*^9}, {
   3.714800018648486*^9, 3.7148000729435787`*^9}, {3.714800136157236*^9, 
   3.714800202993504*^9}, {3.714880244989093*^9, 3.714880332859972*^9}, {
   3.714880463849522*^9, 3.7148804753839397`*^9}, {3.7148805884904747`*^9, 
   3.714880594744421*^9}, {3.714881444967393*^9, 3.714881607108062*^9}, {
   3.7148816565086718`*^9, 3.714881672913887*^9}, {3.7148817219062243`*^9, 
   3.7148817703832483`*^9}, {3.7148818253744707`*^9, 
   3.7148818681327953`*^9}, {3.714881899153205*^9, 3.7148819416352158`*^9}, {
   3.714881985649289*^9, 3.714882019053645*^9}, {3.714882067411428*^9, 
   3.714882321783688*^9}, {3.7148823551669807`*^9, 3.714882425037527*^9}, {
   3.7148826253568697`*^9, 3.714882629297477*^9}, 3.714883528266871*^9, {
   3.71496755941925*^9, 3.7149675762822447`*^9}, {3.7149676623889217`*^9, 
   3.7149676697726727`*^9}, {3.714967723774634*^9, 3.714967736644435*^9}, {
   3.714968524620832*^9, 3.714968530593789*^9}, {3.7150566985407343`*^9, 
   3.715056699880807*^9}, {3.715056756363603*^9, 3.715056769679932*^9}, {
   3.715056825885113*^9, 3.715056827515821*^9}, {3.715057012070105*^9, 
   3.715057014966639*^9}, {3.715057071041381*^9, 3.715057126900285*^9}, {
   3.715057177358343*^9, 3.7150571970334997`*^9}, {3.715057253171925*^9, 
   3.715057320471798*^9}, {3.715062395499571*^9, 3.7150624674981318`*^9}, {
   3.715062536189651*^9, 3.715062563009695*^9}, {3.715062910439213*^9, 
   3.7150629183385572`*^9}, {3.7150629935256653`*^9, 3.715063018966915*^9}, {
   3.715063213639283*^9, 3.715063419275593*^9}, {3.715063534210903*^9, 
   3.7150635480675592`*^9}, {3.715063578457529*^9, 3.7150636354104958`*^9}, 
   3.71506375142588*^9, 3.7150639061330843`*^9, {3.715063965039791*^9, 
   3.7150639673157167`*^9}, 3.715064556592204*^9, {3.7150646076050243`*^9, 
   3.7150646077339773`*^9}, {3.715404254912579*^9, 3.7154042953489037`*^9}, {
   3.715404348237508*^9, 3.71540434933809*^9}, {3.7154043824015408`*^9, 
   3.7154044057576523`*^9}, 3.715404444277432*^9, {3.715404654206983*^9, 
   3.7154047537894173`*^9}, {3.715404797265313*^9, 3.715404828095598*^9}, {
   3.7154048584776993`*^9, 3.715404868053134*^9}, {3.715404899667766*^9, 
   3.7154048997292843`*^9}, {3.715404961011183*^9, 3.715404961627893*^9}, {
   3.715405021620867*^9, 3.715405031987691*^9}, {3.715405082062055*^9, 
   3.7154050847199917`*^9}, {3.7154051271629972`*^9, 3.715405195091359*^9}, {
   3.715405296823638*^9, 3.715405296906559*^9}, {3.7154107672910023`*^9, 
   3.715410774531891*^9}, {3.7154110425022*^9, 3.715411087608632*^9}, {
   3.715419281415717*^9, 3.715419283074294*^9}, {3.715419318422675*^9, 
   3.7154193484533653`*^9}, {3.715419432339196*^9, 3.7154194438790483`*^9}, {
   3.715419562284645*^9, 3.715419569557371*^9}, {3.715419895867753*^9, 
   3.7154199752731533`*^9}, {3.71608968719575*^9, 3.71608968930783*^9}, 
   3.7160899427031803`*^9, {3.716101668463254*^9, 3.7161017093813543`*^9}, 
   3.7161018236780367`*^9, {3.716101909048895*^9, 3.716101910699367*^9}, {
   3.716199580591099*^9, 3.716199594785852*^9}, {3.716199724187787*^9, 
   3.716199767508195*^9}, {3.716199925066869*^9, 3.7161999279618807`*^9}, 
   3.7162000261520243`*^9, {3.7162017164382067`*^9, 3.716201934078307*^9}, {
   3.716201973826441*^9, 3.716202057149208*^9}, {3.7162021083079863`*^9, 
   3.7162021084718523`*^9}, {3.716202152334682*^9, 3.716202169738559*^9}, 
   3.7162222969575653`*^9, {3.7162223426622562`*^9, 3.716222515561318*^9}, {
   3.7162226166887608`*^9, 3.71622269838625*^9}, {3.7162234348724957`*^9, 
   3.716223435702057*^9}, {3.7162236257454977`*^9, 3.7162236340727587`*^9}, {
   3.716223706271297*^9, 3.716223804370322*^9}, 3.716224025801704*^9, {
   3.716224272173275*^9, 3.716224289469131*^9}, {3.716224373948374*^9, 
   3.716224374601152*^9}, {3.7162244208054457`*^9, 3.7162244325241137`*^9}, {
   3.7162635055631657`*^9, 3.716263513881781*^9}, {3.716263742306798*^9, 
   3.716263767289282*^9}, {3.716263825135014*^9, 3.716263849083647*^9}, {
   3.716263921999103*^9, 3.716263962762536*^9}, {3.7162639981201077`*^9, 
   3.716264001918099*^9}, {3.716264083403569*^9, 3.7162641451406937`*^9}, {
   3.716264176940906*^9, 3.71626419189966*^9}, {3.716264280446396*^9, 
   3.71626430858383*^9}, {3.716264339897531*^9, 3.716264339997113*^9}, {
   3.7162900533717747`*^9, 3.7162900564265537`*^9}, {3.7162904275998373`*^9, 
   3.716290477756963*^9}, 3.716526705399876*^9, {3.7165268388870707`*^9, 
   3.7165269702328987`*^9}, {3.716527020767002*^9, 3.7165270248761*^9}, {
   3.716527115211946*^9, 3.716527116921804*^9}, {3.716527157013023*^9, 
   3.716527238694694*^9}, {3.716527589076996*^9, 3.716527592078253*^9}, {
   3.71652762512221*^9, 3.71652762612978*^9}, {3.716527847172996*^9, 
   3.716527903050211*^9}, {3.716527935536233*^9, 3.7165281711741858`*^9}, {
   3.716528215793041*^9, 3.71652821828104*^9}, {3.716629549501873*^9, 
   3.7166295510730057`*^9}, {3.7166304085018587`*^9, 3.716630411334627*^9}, {
   3.716630533492814*^9, 3.716630555660733*^9}, {3.7166306515810137`*^9, 
   3.716630674690131*^9}, {3.7166307134963207`*^9, 3.716630717075107*^9}, {
   3.716696632113183*^9, 3.7166966551757097`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0., 0., 0.], PointSize[0.019444444444444445`], 
     AbsoluteThickness[1.6], 
     PointBox[{{1., 1.5675332879262394`}, {2., 1.465261184697007}, {3., 
      1.4071871160731693`}, {4., 1.3124588085216402`}, {5., 
      1.2208479393277432`}, {6., 1.1304718231502384`}, {7., 
      1.0376833213712842`}, {8., 0.9376022659900833}, {9., 
      0.8333527690716569}, {10., 0.7272779668545264}}]}, 
    {RGBColor[0.9981994354161898, 0.3931486991683833, 0.3889829861905852], 
     PointSize[0.019444444444444445`], AbsoluteThickness[1.6], 
     PointBox[{{1., 1.5956713148337496`}, {2., 1.6212905026712086`}, {3., 
      1.6838497047196512`}, {4., 1.68603698405244}, {5., 
      1.6779068398569392`}, {6., 1.6600034720748353`}, {7., 
      1.6296537855806972`}, {8., 1.5783600807508504`}, {9., 
      1.5083037345045924`}, {10., 1.417909320775002}}]}, 
    {RGBColor[0.33640039673456934`, 0.6105745021744107, 0.9036545357442588], 
     PointSize[0.019444444444444445`], AbsoluteThickness[1.6], 
     PointBox[{{1., 0.9282863203253006}, {2., 1.0566858495540892`}, {3., 
      1.207265738489569}, {4., 1.2452424818378702`}, {5., 
      1.2657800761560427`}, {6., 1.2653483167934456`}, {7., 
      1.2428083853289442`}, {8., 1.1984942261532798`}, {9., 
      1.133061429218913}, {10., 1.0494401530108184`}}]}, 
    {RGBColor[0.6215762569619288, 0.8791485465781643, 0.39208056763561455`], 
     PointSize[0.019444444444444445`], AbsoluteThickness[1.6], 
     PointBox[{{1., 0.36861686566298146`}, {2., 0.4639122426060971}, {3., 
      0.537504833314437}, {4., 0.5531948799618114}, {5., 
      0.5621565554933139}, {6., 0.5625200851048142}, {7., 
      0.5531457715298232}, {8., 0.5354605594124199}, {9., 
      0.5088434166372537}, {10., 0.47518888720891483`}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 10.}, {0, 1.68603698405244}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.716696664379031*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "48.14308361081906`", ",", "15.362583476502072`", ",", 
   "19.336967821120243`", ",", "11.109836108016067`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.716696664389041*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "22.776546117527356`", ",", "43.936870636269035`", ",", 
   "13.188941760294083`", ",", "11.596044154563247`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.7166966643924007`*^9}],

Cell[BoxData["\<\"Nominal simulation excursion for hip, knee, ankle, tmt 3D\"\
\>"], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.7166966643957157`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "59.45487478569204`", ",", "93.37228398129156`", ",", "71.20767522281704`", 
   ",", "31.692918164166564`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.7166966644005947`*^9}],

Cell[BoxData["\<\"Nominal simulation excursion for hip, knee, ankle, tmt 4D\"\
\>"], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.716696664406608*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "15.876830457808127`", ",", "66.57223040062817`", ",", "66.09834981074702`",
    ",", "21.415985526858478`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.716223811710232*^9, {3.71622400821463*^9, 3.716224032346891*^9}, 
   3.716224295830902*^9, 3.7162243818219967`*^9, 3.7162244391459503`*^9, 
   3.7162642669367857`*^9, {3.716264319292089*^9, 3.716264349266871*^9}, 
   3.716290065672307*^9, 3.7162904863566504`*^9, 3.716525899736595*^9, 
   3.716526723599914*^9, {3.7165268401954107`*^9, 3.716526864124236*^9}, {
   3.716526912990355*^9, 3.716526920048984*^9}, 3.716526975619475*^9, 
   3.716527025405498*^9, 3.7165271174014397`*^9, {3.716527167018198*^9, 
   3.716527176626833*^9}, {3.71652723039365*^9, 3.716527239207255*^9}, 
   3.71652762673193*^9, 3.716527690529522*^9, {3.716527912933601*^9, 
   3.7165279605892344`*^9}, {3.716528078063444*^9, 3.716528150056342*^9}, 
   3.716528197219767*^9, 3.716528243705476*^9, 3.716628968276607*^9, 
   3.716629510131139*^9, 3.71662955160909*^9, 3.716629838031602*^9, 
   3.7166300575114193`*^9, 3.716630111689464*^9, 3.716630412478504*^9, 
   3.7166304618840513`*^9, {3.716630534729113*^9, 3.716630558317737*^9}, 
   3.716630675243429*^9, 3.716630717703054*^9, {3.716640066955555*^9, 
   3.716640074792507*^9}, 3.7166966644120092`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "save", " ", "figures", " ", "as", " ", "well", " ", "as", " ", 
    "information", " ", "on", " ", "notebook", " ", "used", " ", "to", " ", 
    "make", " ", "the", " ", "figs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nbname", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NotebookFileName", "[", "]"}], "//", "FileNameSplit"}], 
       ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"info", "=", 
     RowBox[{"\"\<Figures created by \>\"", "<>", "nbname"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", " ", "for"}]}], " ", "target", " ", "vary", " ", 
      RowBox[{"figure", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "[", "setpathfigpanel", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<targetVary_pitch.pdf\>\"", ",", "plotPitch"}], "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<targetVary_yaw.pdf\>\"", ",", "plotYaw"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<targetVary.txt\>\"", ",", "info"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ResetDirectory", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716699474028255*^9, 3.716699581738553*^9}}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
figs/panels\"\>"], "Output",
 CellChangeTimes->{3.716527638213973*^9, 3.7165282475362673`*^9}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
simData\"\>"], "Output",
 CellChangeTimes->{3.716527638213973*^9, 3.7165282479693747`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbname", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NotebookFileName", "[", "]"}], "//", "FileNameSplit"}], ")"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"info", "=", 
    RowBox[{"\"\<Figures created by \>\"", "<>", "nbname"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", " ", "for"}]}], " ", "init", " ", "vary", " ", 
     RowBox[{
      RowBox[{"figure", "--"}], "--"}]}], "-"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "setpathfigpanel", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<initVary_plot.pdf\>\"", ",", "plotPitchInit"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<initVary_stick01.gif\>\"", ",", 
    RowBox[{"stickPlotsInit", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<initVary_stick02.gif\>\"", ",", 
    RowBox[{"stickPlotsInit", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<initVary_stick03.gif\>\"", ",", 
    RowBox[{"stickPlotsInit", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"\"\<TransparentColor\>\"", "\[Rule]", "White"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<initVary.txt\>\"", ",", "info"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ResetDirectory", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.716699562876884*^9, 3.716699597691218*^9}, {
  3.71669964090062*^9, 3.716699693849553*^9}, {3.716699759040313*^9, 
  3.716699767853765*^9}}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
figs/panels\"\>"], "Output",
 CellChangeTimes->{3.716699773364441*^9}],

Cell[BoxData["\<\"/Users/chrisrichards/Desktop/FrogWork/FrogPubs/frogSlerp/\
simData\"\>"], "Output",
 CellChangeTimes->{3.7166997741248093`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1119, 872},
WindowMargins->{{Automatic, 47}, {Automatic, 26}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 836, 14, 165, "Input"],
Cell[CellGroupData[{
Cell[1419, 38, 39403, 1119, 3431, "Input"],
Cell[40825, 1159, 837, 11, 276, "Print"]
}, Open  ]],
Cell[41677, 1173, 587, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[42289, 1185, 92, 1, 28, "Input"],
Cell[42384, 1188, 131, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42552, 1195, 208, 4, 65, "Chapter"],
Cell[42763, 1201, 18966, 534, 1253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61766, 1740, 518, 9, 241, "Chapter"],
Cell[CellGroupData[{
Cell[62309, 1753, 16083, 458, 1253, "Input"],
Cell[78395, 2213, 1046, 16, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79478, 2234, 98, 1, 28, "Input"],
Cell[79579, 2237, 74, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79702, 2244, 360, 6, 153, "Chapter"],
Cell[80065, 2252, 28520, 590, 1168, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[108622, 2847, 310, 6, 98, "Chapter"],
Cell[108935, 2855, 43198, 963, 2953, "Input"],
Cell[152136, 3820, 69, 1, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[152242, 3826, 283, 3, 54, "Chapter"],
Cell[152528, 3831, 3405, 87, 267, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[155970, 3923, 433, 8, 98, "Chapter"],
Cell[CellGroupData[{
Cell[156428, 3935, 5848, 144, 505, "Input"],
Cell[162279, 4081, 1802, 27, 28, "Output"],
Cell[164084, 4110, 1804, 27, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[165937, 4143, 587, 9, 153, "Chapter"],
Cell[CellGroupData[{
Cell[166549, 4156, 39951, 935, 3514, "Input"],
Cell[206503, 5093, 329, 4, 22, "Print"],
Cell[206835, 5099, 32566, 663, 510, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239438, 5767, 5425, 96, 216, "Input"],
Cell[244866, 5865, 390, 6, 28, "Output"],
Cell[245259, 5873, 386, 6, 28, "Output"]
}, Open  ]],
Cell[245660, 5882, 96, 1, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[245793, 5888, 576, 9, 142, "Chapter"],
Cell[246372, 5899, 21878, 526, 1491, "Input"],
Cell[CellGroupData[{
Cell[268275, 6429, 146, 3, 28, "Input"],
Cell[268424, 6434, 112, 1, 28, "Output"]
}, Open  ]],
Cell[268551, 6438, 22880, 538, 1542, "Input"],
Cell[291434, 6978, 6812, 178, 488, "Input"],
Cell[CellGroupData[{
Cell[298271, 7160, 5010, 106, 352, "Input"],
Cell[303284, 7268, 313, 4, 28, "Output"],
Cell[303600, 7274, 307, 4, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[303956, 7284, 857, 17, 450, "Chapter"],
Cell[304816, 7303, 93, 1, 28, "Input"],
Cell[304912, 7306, 52393, 1223, 4115, "Input"],
Cell[CellGroupData[{
Cell[357330, 8533, 100, 1, 28, "Input"],
Cell[357433, 8536, 1065, 26, 56, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[358547, 8568, 626, 11, 142, "Chapter"],
Cell[359176, 8581, 22317, 663, 2579, "Input"],
Cell[381496, 9246, 47999, 1118, 3945, "Input"],
Cell[429498, 10366, 383, 10, 28, "Input"],
Cell[CellGroupData[{
Cell[429906, 10380, 131, 2, 28, "Input"],
Cell[430040, 10384, 216, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[430293, 10393, 697, 15, 80, "Input"],
Cell[430993, 10410, 279, 5, 28, "Output"],
Cell[431275, 10417, 235, 4, 28, "Output"],
Cell[431513, 10423, 287, 5, 86, "Output"]
}, Open  ]],
Cell[431815, 10431, 1131, 31, 131, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[432983, 10467, 655, 11, 98, "Chapter"],
Cell[CellGroupData[{
Cell[433663, 10482, 743, 20, 46, "Input"],
Cell[434409, 10504, 440, 11, 28, "Output"]
}, Open  ]],
Cell[434864, 10518, 73993, 1767, 6607, "Input"],
Cell[CellGroupData[{
Cell[508882, 12289, 158, 3, 28, "Input"],
Cell[509043, 12294, 183, 3, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[509263, 12302, 19558, 414, 1066, "Input"],
Cell[528824, 12718, 3598, 66, 244, "Output"],
Cell[532425, 12786, 1322, 21, 28, "Output"],
Cell[533750, 12809, 1325, 21, 28, "Output"],
Cell[535078, 12832, 1247, 18, 28, "Output"],
Cell[536328, 12852, 1322, 21, 28, "Output"],
Cell[537653, 12875, 1245, 18, 28, "Output"],
Cell[538901, 12895, 1323, 21, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[540261, 12921, 1560, 42, 182, "Input"],
Cell[541824, 12965, 171, 2, 28, "Output"],
Cell[541998, 12969, 167, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[542202, 12976, 2053, 58, 199, "Input"],
Cell[544258, 13036, 147, 2, 28, "Output"],
Cell[544408, 13040, 145, 2, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
